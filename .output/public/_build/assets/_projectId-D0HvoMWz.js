import{l as J,r as m,j as t,y as oe,N as Dt,u as Ye,aa as Qe,ab as Xe,B as D,aE as et,ah as X,g as be,ai as Rt,k as z,ae as Z,a_ as ve,a$ as ce,X as we,b0 as Fe,W as Tt,a3 as St,L as ee,ad as Pe,C as V,a as B,b as W,c as te,d as G,aQ as kt,aR as Ot,aS as Ut,T as me,O as ue,Q as fe,V as pe,U as Ce,h as At,b1 as Ee,ag as Ie,Z as De,Y as Re}from"./client-CMvCw2jp.js";import{S as $,H as Mt,M as Lt,C as zt,a as $t,b as _t}from"./collapsible-fEEhjg5O.js";import{D as Vt,a as Bt,b as Wt,c as Te,d as Se,e as ke,f as qt,g as Zt}from"./dialog-idyyqogp.js";import{C as Gt}from"./checkbox-DmFmSC3J.js";import{L as re}from"./lock-CxUcGwOm.js";import{T as Oe}from"./trash-2-P1aG3-jx.js";import{B as Ue,A as Ae}from"./avatar-DxhaIZ2w.js";import{F as Me}from"./folder-open-mEKpUj5E.js";import"./plus-sBaVN3vY.js";/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ht=J("CircleAlert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Kt=J("CircleCheckBig",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ne=J("File",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jt=J("MessageCircle",[["path",{d:"M7.9 20A9 9 0 1 0 4 16.1L2 22Z",key:"vv11sd"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Le=J("MessageSquarePlus",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}],["path",{d:"M12 7v6",key:"lw1j43"}],["path",{d:"M9 10h6",key:"9gxzsh"}]]),Yt=Dt("relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive",warning:"border-amber-500/50 text-amber-700 [&>svg]:text-amber-700"}},defaultVariants:{variant:"default"}}),tt=m.forwardRef(({className:e,variant:r,...a},s)=>t.jsx("div",{ref:s,role:"alert",className:oe(Yt({variant:r}),e),...a}));tt.displayName="Alert";const Qt=m.forwardRef(({className:e,...r},a)=>t.jsx("h5",{ref:a,className:oe("mb-1 font-medium leading-none tracking-tight",e),...r}));Qt.displayName="AlertTitle";const rt=m.forwardRef(({className:e,...r},a)=>t.jsx("div",{ref:a,className:oe("text-sm [&_p]:leading-relaxed",e),...r}));rt.displayName="AlertDescription";function Xt({project:e,onProjectUpdated:r,trigger:a,userId:s}){const n=Ye(),o=Qe(Xe),[d,l]=m.useState(!1),[c,v]=m.useState(!1),[b,y]=m.useState(!1),[w,u]=m.useState(!1),[i,F]=m.useState(""),[g,j]=m.useState({name:"",description:"",isPrivate:!1}),[N,h]=m.useState(!0);m.useEffect(()=>{if(d){j({name:e.name||"",description:e.description||"",isPrivate:e.isPrivate||!1});const E=e.members?.length||0;h(E<=1),u(!1),F("")}},[d,e]);const P=E=>{j({...g,[E.target.name]:E.target.value})},S=E=>{j({...g,isPrivate:E})},C=async E=>{if(E.preventDefault(),!e.id){z.error("Project not found");return}if(!g.name.trim()){z.error("Project name is required");return}if(g.isPrivate&&!N&&!e.isPrivate){z.error("Cannot make a project private when it has multiple members");return}v(!0);try{const{data:x}=await Z().chatrooms.updateProject(e.id,{teamspaceId:e.teamspaceId,context:e.context,creatorId:s,name:g.name,description:g.description,isPrivate:g.isPrivate,members:g.isPrivate?[]:e.members?.map(f=>({projectId:e.id,userId:f.user.id,role:f.role,invitedByUserId:s}))});r(x),z.success("Project settings updated successfully"),l(!1)}catch(x){console.error("Error updating project:",x),z.error("Failed to update project")}finally{v(!1)}},_=async()=>{if(i!==e.name){z.error("Project name does not match");return}y(!0);try{await Z().chatrooms.deleteProject(e.id),z.success("Project deleted successfully"),l(!1),e.teamspaceId?(o(E=>E.map(f=>({...f,projects:f.projects.filter(p=>p.id!==e.id)}))),n({to:"/teamspace/$teamspaceId",params:{teamspaceId:e.teamspaceId}})):n({to:"/chat"})}catch(E){console.error("Error deleting project:",E),z.error("Failed to delete project")}finally{y(!1)}};return t.jsxs(Vt,{open:d,onOpenChange:l,children:[t.jsx(Bt,{asChild:!0,children:a||t.jsxs(D,{size:"sm",variant:"outline",className:"hover:cursor-pointer",children:[t.jsx(et,{className:"h-4 w-4 mr-2"})," Project Settings"]})}),t.jsx(Wt,{className:"sm:max-w-[500px]",children:w?t.jsxs("div",{children:[t.jsxs(Te,{children:[t.jsx("div",{className:"h-1.5 bg-red-500 w-full absolute top-0 left-0 rounded-t-lg"}),t.jsxs(Se,{className:"text-xl mt-2 text-red-600 flex items-center",children:[t.jsx(Oe,{className:"h-5 w-5 mr-2"})," Delete Project"]}),t.jsx(ke,{children:"This action cannot be undone. This will permanently delete the project and remove all associated chats and data."})]}),t.jsxs("div",{className:"py-4",children:[t.jsx("div",{className:"bg-red-50 border border-red-200 rounded-md p-4 mb-4",children:t.jsxs("div",{className:"flex items-center",children:[t.jsx("span",{className:"text-xl mr-2",children:"ðŸ’©"}),t.jsxs("p",{className:"text-sm text-red-800",children:["Are you absolutely sure you want to delete ",t.jsx("strong",{children:e.name}),"? This action is irreversible!"]})]})}),t.jsxs("div",{className:"grid gap-2",children:[t.jsxs(X,{htmlFor:"confirmName",className:"text-sm font-medium",children:["To confirm, type ",t.jsx("span",{className:"font-bold",children:e.name})," below:"]}),t.jsx(be,{id:"confirmName",value:i,onChange:E=>F(E.target.value),placeholder:`Type "${e.name}" to confirm`})]}),t.jsxs("div",{className:"flex justify-between mt-6",children:[t.jsx(D,{type:"button",variant:"outline",onClick:()=>u(!1),disabled:b,children:"Cancel"}),t.jsx(D,{type:"button",variant:"destructive",className:"bg-red-600 hover:bg-red-700",onClick:_,disabled:i!==e.name||b,children:b?"Deleting...":"Permanently Delete Project"})]})]})]}):t.jsxs("form",{onSubmit:C,children:[t.jsxs(Te,{children:[t.jsx("div",{className:"h-1.5 bg-emerald-500 w-full absolute top-0 left-0 rounded-t-lg"}),t.jsx(Se,{className:"text-xl mt-2",children:"Project Settings"}),t.jsx(ke,{children:"Update the details and settings of your project"})]}),t.jsxs("div",{className:"grid gap-4 py-4",children:[t.jsxs("div",{className:"grid gap-2",children:[t.jsxs(X,{htmlFor:"name",children:["Project Name ",t.jsx("span",{className:"text-red-500",children:"*"})]}),t.jsx(be,{id:"name",name:"name",value:g.name,onChange:P,placeholder:"e.g. Marketing Campaign",required:!0})]}),t.jsxs("div",{className:"grid gap-2",children:[t.jsx(X,{htmlFor:"description",children:"Description"}),t.jsx(Rt,{id:"description",name:"description",value:g.description,onChange:P,placeholder:"What is this project about?",rows:3})]}),t.jsxs("div",{className:"flex items-center space-x-2",children:[t.jsx(Gt,{id:"isPrivate",checked:g.isPrivate,onCheckedChange:S,disabled:!N&&!e.isPrivate}),t.jsxs("div",{className:"grid gap-1.5 leading-none",children:[t.jsxs(X,{htmlFor:"isPrivate",className:`text-sm font-medium leading-none flex items-center ${!N&&!e.isPrivate?"text-muted-foreground":""}`,children:[t.jsx(re,{className:"h-3.5 w-3.5 mr-1.5 text-muted-foreground"}),"Make project private"]}),t.jsx("p",{className:"text-xs text-muted-foreground",children:"Private projects are only visible to invited members"})]})]}),!N&&!e.isPrivate&&t.jsxs(tt,{variant:"warning",className:"bg-amber-50 text-amber-800 border-amber-200",children:[t.jsx(Ht,{className:"h-4 w-4"}),t.jsx(rt,{children:"Projects with multiple members cannot be made private"})]}),t.jsx("div",{className:"border-t pt-4 mt-2",children:t.jsxs("div",{className:"flex flex-col space-y-2",children:[t.jsx("h3",{className:"text-sm font-medium text-red-600",children:"Danger Zone"}),t.jsx("p",{className:"text-xs text-muted-foreground",children:"Once you delete a project, there is no going back. This action cannot be undone."}),t.jsxs(D,{type:"button",variant:"destructive",className:"mt-2 bg-red-600 hover:bg-red-700",onClick:()=>u(!0),children:[t.jsx(Oe,{className:"h-4 w-4 mr-2"})," Delete Project"]})]})})]}),t.jsxs(qt,{children:[t.jsx(Zt,{asChild:!0,children:t.jsx(D,{variant:"outline",type:"button",disabled:c,children:"Cancel"})}),t.jsx(D,{type:"submit",className:"bg-emerald-600 hover:bg-emerald-700",disabled:c,children:c?"Saving...":"Save Changes"})]})]})})]})}function er(e,r){return`${e} returned \`undefined\`. Seems you forgot to wrap component within ${r}`}function Y(e={}){const{name:r,strict:a=!0,hookName:s="useContext",providerName:n="Provider",errorMessage:o,defaultValue:d}=e,l=m.createContext(d);l.displayName=r;function c(){const v=m.useContext(l);if(!v&&a){const b=new Error(o??er(s,n));throw b.name="ContextError",Error.captureStackTrace?.(b,c),b}return v}return[l.Provider,c,l]}function tr(e){return e?Array.isArray(e)?e:[e]:[]}function st(e){return e.reduce((r,a)=>Array.isArray(a)?r.concat(st(a)):r.concat(a),[])}var se=e=>typeof e=="string",K=e=>typeof e=="function",rr=Function.prototype.toString;rr.call(Object);var sr=e=>e(),at=(...e)=>(...r)=>{e.forEach(function(a){a?.(...r)})};function nt(e){if(!ar(e)||e===void 0)return e;const r=Reflect.ownKeys(e).filter(s=>typeof s=="string"),a={};for(const s of r){const n=e[s];n!==void 0&&(a[s]=nt(n))}return a}var ar=e=>e&&typeof e=="object"&&e.constructor===Object;function ze(...e){e.length===1?e[0]:e[1],e.length===2&&e[0]}function nr(e,r){if(e==null)throw new Error(r)}var le=e=>typeof e=="object"&&e!==null,T=e=>e?"":void 0,ir=1,or=9,lr=11,he=e=>le(e)&&e.nodeType===ir&&typeof e.nodeName=="string",it=e=>le(e)&&e.nodeType===or,cr=e=>le(e)&&e===e.window,dr=e=>le(e)&&e.nodeType!==void 0,ot=e=>dr(e)&&e.nodeType===lr&&"host"in e;function ie(e,r){if(!e||!r||!he(e)||!he(r))return!1;const a=r.getRootNode?.();if(e===r||e.contains(r))return!0;if(a&&ot(a)){let s=r;for(;s;){if(e===s)return!0;s=s.parentNode||s.host}}return!1}function mr(e){return it(e)?e:cr(e)?e.document:e?.ownerDocument??document}function lt(e){return ot(e)?lt(e.host):it(e)?e.defaultView??window:he(e)?e.ownerDocument?.defaultView??window:window}function ur(e){let r=e.activeElement;for(;r?.shadowRoot;){const a=r.shadowRoot.activeElement;if(a===r)break;r=a}return r}function fr(e){return e.composedPath?.()??e.nativeEvent?.composedPath?.()}function Ne(e){return fr(e)?.[0]??e.target}var $e=e=>ie(e.currentTarget,Ne(e)),_e=(e,r,a,s)=>{const n=typeof e=="function"?e():e;return n?.addEventListener(r,a,s),()=>{n?.removeEventListener(r,a,s)}};function pr(e){let r;const a=globalThis.requestAnimationFrame(()=>{r=e()});return()=>{globalThis.cancelAnimationFrame(a),r?.()}}var hr={border:"0",clip:"rect(0 0 0 0)",height:"1px",margin:"-1px",overflow:"hidden",padding:"0",position:"absolute",width:"1px",whiteSpace:"nowrap",wordWrap:"normal"},xr=(...e)=>e.map(r=>r?.trim?.()).filter(Boolean).join(" "),gr=/((?:--)?(?:\w+-?)+)\s*:\s*([^;]*)/g,Ve=e=>{const r={};let a;for(;a=gr.exec(e);)r[a[1]]=a[2];return r},jr=(e,r)=>{if(se(e)){if(se(r))return`${e};${r}`;e=Ve(e)}else se(r)&&(r=Ve(r));return Object.assign({},e??{},r??{})};function k(...e){let r={};for(let a of e){for(let s in r){if(s.startsWith("on")&&typeof r[s]=="function"&&typeof a[s]=="function"){r[s]=at(a[s],r[s]);continue}if(s==="className"||s==="class"){r[s]=xr(r[s],a[s]);continue}if(s==="style"){r[s]=jr(r[s],a[s]);continue}r[s]=a[s]!==void 0?a[s]:r[s]}for(let s in a)r[s]===void 0&&(r[s]=a[s])}return r}function vr(e){const r=()=>e.getRootNode?.()??document,a=()=>mr(r()),s=()=>a().defaultView??window,n=()=>ur(r());return{...e,getRootNode:r,getDoc:a,getWin:s,getActiveElement:n,isActiveElement:l=>l===n(),getById:l=>r().getElementById(l)}}function Nr(e){return new Proxy({},{get(r,a){return a==="style"?s=>e({style:s}).style:e}})}var ct=()=>e=>Array.from(new Set(e)),dt=typeof globalThis.document<"u"?m.useLayoutEffect:m.useEffect;function Be(e){const r=e().value??e().defaultValue,a=e().isEqual??Object.is,[s]=m.useState(r),[n,o]=m.useState(s),d=e().value!==void 0,l=m.useRef(n);l.current=d?e().value:n;const c=m.useRef(l.current);dt(()=>{c.current=l.current},[n,e().value]);const v=y=>{const w=c.current,u=K(y)?y(w):y;e().debug&&console.log(`[bindable > ${e().debug}] setValue`,{next:u,prev:w}),d||o(u),a(u,w)||e().onChange?.(u,w)};function b(){return d?e().value:n}return{initial:s,ref:l,get:b,set(y){(e().sync?ve.flushSync:sr)(()=>v(y))},invoke(y,w){e().onChange?.(y,w)},hash(y){return e().hash?.(y)??String(y)}}}function yr(e){const r=m.useRef(e);return{get(a){return r.current[a]},set(a,s){r.current[a]=s}}}var br=(e,r)=>{const a=m.useRef(!1),s=m.useRef(!1);m.useEffect(()=>{if(a.current&&s.current)return r();s.current=!0},[...(e??[]).map(n=>typeof n=="function"?n():n)]),m.useEffect(()=>(a.current=!0,()=>{a.current=!1}),[])};function wr(e,r={}){const a=m.useMemo(()=>{const{id:f,ids:p,getRootNode:R}=r;return vr({id:f,ids:p,getRootNode:R})},[r]),s=(...f)=>{e.debug&&console.log(...f)},n=e.props?.({props:nt(r),scope:a})??r,o=Fr(n),d=e.context?.({prop:o,bindable:Be,scope:a,flush:We,getContext(){return c},getComputed(){return S}}),l=mt(d),c={get(f){return l.current?.[f].ref.current},set(f,p){l.current?.[f].set(p)},initial(f){return l.current?.[f].initial},hash(f){const p=l.current?.[f].get();return l.current?.[f].hash(p)}},v=m.useRef(new Map),b=m.useRef(null),y=m.useRef(null),w=m.useRef({type:""}),u=()=>({...w.current,current(){return w.current},previous(){return y.current}}),i=()=>({...C,matches(...f){return f.includes(C.ref.current)},hasTag(f){return!!e.states[C.ref.current]?.tags?.includes(f)}}),F=yr(e.refs?.({prop:o,context:c})??{}),g=()=>({state:i(),context:c,event:u(),prop:o,send:x,action:j,guard:N,track:br,refs:F,computed:S,flush:We,scope:a,choose:P}),j=f=>{const p=K(f)?f(g()):f;if(!p)return;const R=p.map(I=>{const O=e.implementations?.actions?.[I];return O||ze(`[zag-js] No implementation found for action "${JSON.stringify(I)}"`),O});for(const I of R)I?.(g())},N=f=>K(f)?f(g()):e.implementations?.guards?.[f](g()),h=f=>{const p=K(f)?f(g()):f;if(!p)return;const R=p.map(O=>{const L=e.implementations?.effects?.[O];return L||ze(`[zag-js] No implementation found for effect "${JSON.stringify(O)}"`),L}),I=[];for(const O of R){const L=O?.(g());L&&I.push(L)}return()=>I.forEach(O=>O?.())},P=f=>tr(f).find(p=>{let R=!p.guard;return se(p.guard)?R=!!N(p.guard):K(p.guard)&&(R=p.guard(g())),R}),S=f=>{nr(e.computed,"[zag-js] No computed object found on machine");const p=e.computed[f];return p({context:c,event:u(),prop:o,refs:F,scope:a,computed:S})},C=Be(()=>({defaultValue:e.initialState({prop:o}),onChange(f,p){p&&(v.current.get(p)?.(),v.current.delete(p)),p&&j(e.states[p]?.exit),j(b.current?.actions);const R=h(e.states[f]?.effects);if(R&&v.current.set(f,R),p==="__init__"){j(e.entry);const I=h(e.effects);I&&v.current.set("__init__",I)}j(e.states[f]?.entry)}})),_=m.useRef(void 0);dt(()=>{queueMicrotask(()=>{const p=_.current??C.initial;C.invoke(p,"__init__")});const f=v.current;return()=>{_.current=C.ref.current,f.forEach(p=>p?.()),v.current=new Map,b.current=null,queueMicrotask(()=>{j(e.exit)})}},[]);const E=()=>"ref"in C?C.ref.current:C.get(),x=f=>{queueMicrotask(()=>{y.current=w.current,w.current=f,s("send",f);let p=E();const R=e.states[p].on?.[f.type]??e.on?.[f.type],I=P(R);if(!I)return;b.current=I;const O=I.target??p;s("transition",I);const L=O!==p;L?ve.flushSync(()=>C.set(O)):I.reenter&&!L?C.invoke(p,p):j(I.actions??[])})};return e.watch?.(g()),{state:i(),send:x,context:c,prop:o,scope:a,refs:F,computed:S,event:u()}}function mt(e){const r=m.useRef(e);return r.current=e,r}function Fr(e){const r=mt(e);return function(s){return r.current[s]}}function We(e){queueMicrotask(()=>{ve.flushSync(()=>e())})}var Pr=Nr(e=>e);function Cr(...e){return r=>{const a=[];for(const s of e)if(typeof s=="function"){const n=s(r);typeof n=="function"&&a.push(n)}else s&&(s.current=r);if(a.length)return()=>{for(const s of a)s()}}}function Er(e){let r=Object.getOwnPropertyDescriptor(e.props,"ref")?.get,a=r&&"isReactWarning"in r&&r.isReactWarning;return a?e.ref:(r=Object.getOwnPropertyDescriptor(e,"ref")?.get,a=r&&"isReactWarning"in r&&r.isReactWarning,a?e.props.ref:e.props.ref||e.ref)}const de=e=>{const r=m.memo(m.forwardRef((a,s)=>{const{asChild:n,children:o,...d}=a;if(!n)return m.createElement(e,{...d,ref:s},o);const l=m.Children.only(o);if(!m.isValidElement(l))return null;const c=Er(l);return m.cloneElement(l,{...k(d,l.props),ref:s?Cr(s,c):c})}));return r.displayName=e.displayName||e.name,r},Ir=()=>{const e=new Map;return new Proxy(de,{apply(r,a,s){return de(s[0])},get(r,a){const s=a;return e.has(s)||e.set(s,de(s)),e.get(s)}})},A=Ir(),ye=()=>(e,r)=>r.reduce((a,s)=>{const[n,o]=a,d=s;return o[d]!==void 0&&(n[d]=o[d]),delete o[d],[n,o]},[{},{...e}]);var ae=(e,r=[])=>({parts:(...a)=>{if(Dr(r))return ae(e,a);throw new Error("createAnatomy().parts(...) should only be called once. Did you mean to use .extendWith(...) ?")},extendWith:(...a)=>ae(e,[...r,...a]),rename:a=>ae(a,r),keys:()=>r,build:()=>[...new Set(r)].reduce((a,s)=>Object.assign(a,{[s]:{selector:[`&[data-scope="${q(e)}"][data-part="${q(s)}"]`,`& [data-scope="${q(e)}"][data-part="${q(s)}"]`].join(", "),attrs:{"data-scope":q(e),"data-part":q(s)}}}),{})}),q=e=>e.replace(/([A-Z])([A-Z])/g,"$1-$2").replace(/([a-z])([A-Z])/g,"$1-$2").replace(/[\s_]+/g,"-").toLowerCase(),Dr=e=>e.length===0;const[Ns,Rr]=Y({name:"EnvironmentContext",hookName:"useEnvironmentContext",providerName:"<EnvironmentProvider />",strict:!1,defaultValue:{getRootNode:()=>document,getDocument:()=>document,getWindow:()=>window}}),[ys,Tr]=Y({name:"LocaleContext",hookName:"useLocaleContext",providerName:"<LocaleProvider />",strict:!1,defaultValue:{dir:"ltr",locale:"en-US"}}),[bs,ut]=Y({name:"FieldContext",hookName:"useFieldContext",providerName:"<FieldProvider />",strict:!1}),[Sr,M]=Y({name:"FileUploadContext",hookName:"useFileUploadContext",providerName:"<FileUploadProvider />"}),kr=e=>e.children(M()),ft=m.forwardRef((e,r)=>{const[a,s]=ye()(e,["disableClick"]),n=M(),o=k(n.getDropzoneProps(a),s);return t.jsx(A.div,{...o,ref:r})});ft.displayName="FileUploadDropzone";const pt=m.forwardRef((e,r)=>{const a=M(),s=k(a.getHiddenInputProps(),e),n=ut();return t.jsx(A.input,{"aria-describedby":n?.ariaDescribedby,...s,ref:r})});pt.displayName="FileUploadHiddenInput";const[Or,Q]=Y({name:"FileUploadItemPropsContext",hookName:"useFileUploadItemPropsContext",providerName:"<FileUploadItemPropsProvider />"}),ht=m.forwardRef((e,r)=>{const[a,s]=ye()(e,["file"]),n=M(),o=k(n.getItemProps(a),s);return t.jsx(Or,{value:a,children:t.jsx(A.li,{...o,ref:r})})});ht.displayName="FileUploadItem";const xt=m.forwardRef((e,r)=>{const a=M(),s=Q(),n=k(a.getItemDeleteTriggerProps(s),e);return t.jsx(A.button,{...n,ref:r})});xt.displayName="FileUploadItemDeleteTrigger";const gt=m.forwardRef((e,r)=>{const a=M(),s=k(a.getItemGroupProps(),e);return t.jsx(A.ul,{...s,ref:r})});gt.displayName="FileUploadItemGroup";const jt=m.forwardRef((e,r)=>{const{children:a,...s}=e,n=M(),o=Q(),d=k(n.getItemNameProps(o),s);return t.jsx(A.div,{...d,ref:r,children:a||o.file.name})});jt.displayName="FileUploadItemName";const xe=m.forwardRef((e,r)=>{const a=M(),s=Q(),n=k(a.getItemPreviewProps(s),e);return s.file.type.match(e.type??".*")?t.jsx(A.div,{...n,ref:r}):null});xe.displayName="FileUploadItemPreview";const vt=m.forwardRef((e,r)=>{const[a,s]=m.useState(""),n=M(),o=Q(),d=k(n.getItemPreviewImageProps({...o,url:a}),e);return m.useEffect(()=>n.createFileUrl(o.file,l=>s(l)),[o,n]),a?t.jsx(A.img,{...d,ref:r}):null});vt.displayName="FileUploadItemPreviewImage";const Nt=m.forwardRef((e,r)=>{const{children:a,...s}=e,n=M(),o=Q(),d=k(n.getItemSizeTextProps(o),s);return t.jsx(A.div,{...d,ref:r,children:a||n.getFileSize(o.file)})});Nt.displayName="FileUploadItemSizeText";const yt=m.forwardRef((e,r)=>{const a=M(),s=k(a.getLabelProps(),e);return t.jsx(A.label,{...s,ref:r})});yt.displayName="FileUploadLabel";var Ur=e=>typeof e.getAsEntry=="function"?e.getAsEntry():typeof e.webkitGetAsEntry=="function"?e.webkitGetAsEntry():null,bt=e=>e.isDirectory,wt=e=>e.isFile,Ft=(e,r)=>(Object.defineProperty(e,"relativePath",{value:r?`${r}/${e.name}`:e.name}),e),Ar=(e,r)=>Promise.all(Array.from(e).filter(a=>a.kind==="file").map(a=>{const s=Ur(a);if(!s)return null;if(bt(s)&&r)return Pt(s.createReader(),`${s.name}`);if(wt(s))return new Promise(n=>{s.file(o=>{n(Ft(o,""))})})}).filter(a=>a)),Pt=(e,r="")=>new Promise(a=>{const s=[],n=()=>{e.readEntries(o=>{if(o.length===0){a(Promise.all(s).then(l=>l.flat()));return}const d=o.map(l=>{if(!l)return null;if(bt(l))return Pt(l.createReader(),`${r}${l.name}`);if(wt(l))return new Promise(c=>{l.file(v=>{c(Ft(v,r))})})}).filter(l=>l);s.push(Promise.all(d)),n()})};n()});function Mr(e){return e==="audio/*"||e==="video/*"||e==="image/*"||e==="text/*"||/\w+\/[-+.\w]+/g.test(e)}function Lr(e){return/^.*\.[\w]+$/.test(e)}var qe=e=>Mr(e)||Lr(e);function zr(e){if(e!=null)return typeof e=="string"?e:Array.isArray(e)?e.filter(qe).join(","):Object.entries(e).reduce((r,[a,s])=>[...r,a,...s],[]).filter(qe).join(",")}var Ze=(e,r)=>e.name===r.name&&e.size===r.size&&e.type===r.type,H=e=>e!=null;function $r(e,r,a){if(H(e.size))if(H(r)&&H(a)){if(e.size>a)return[!1,"FILE_TOO_LARGE"];if(e.size<r)return[!1,"FILE_TOO_SMALL"]}else{if(H(r)&&e.size<r)return[!1,"FILE_TOO_SMALL"];if(H(a)&&e.size>a)return[!1,"FILE_TOO_LARGE"]}return[!0,null]}function _r(e,r){if(e&&r){const a=Array.isArray(r)?r:typeof r=="string"?r.split(","):[];if(a.length===0)return!0;const s=e.name||"",n=(e.type||"").toLowerCase(),o=n.replace(/\/.*$/,"");return a.some(d=>{const l=d.trim().toLowerCase();return l.charAt(0)==="."?s.toLowerCase().endsWith(l):l.endsWith("/*")?o===l.replace(/\/.*$/,""):n===l})}return!0}function Vr(e,r){const a=e.type==="application/x-moz-file"||_r(e,r);return[a,a?null:"FILE_INVALID_TYPE"]}function Br(e){const r=new Map;return function(s,n){const o=s+(n?Object.entries(n).sort((l,c)=>l[0]<c[0]?-1:1).join():"");if(r.has(o))return r.get(o);let d=new e(s,n);return r.set(o,d),d}}var Wr=Br(Intl.NumberFormat);function qr(e,r,a={}){return Wr(r,a).format(e)}var Zr=["","kilo","mega","giga","tera"],Gr=["","kilo","mega","giga","tera","peta"],Hr=(e,r="en-US",a={})=>{if(isNaN(e))return"";if(e===0)return"0 B";const{unit:s="byte",unitDisplay:n="short"}=a,o=s==="bit"?Zr:Gr,d=Math.max(0,Math.min(Math.floor(Math.log10(e)/3),o.length-1)),l=o[d]+s,c=n||"short",v=parseFloat((e/Math.pow(1e3,d)).toPrecision(3));return qr(v,r,{style:"unit",unit:l,unitDisplay:c})},Kr=ae("file-upload").parts("root","dropzone","item","itemDeleteTrigger","itemGroup","itemName","itemPreview","itemPreviewImage","itemSizeText","label","trigger","clearTrigger"),U=Kr.build(),Ct=e=>e.ids?.root??`file:${e.id}`,Et=e=>e.ids?.dropzone??`file:${e.id}:dropzone`,ge=e=>e.ids?.hiddenInput??`file:${e.id}:input`,Jr=e=>e.ids?.trigger??`file:${e.id}:trigger`,Yr=e=>e.ids?.label??`file:${e.id}:label`,Qr=(e,r)=>e.ids?.item?.(r)??`file:${e.id}:item:${r}`,Xr=(e,r)=>e.ids?.itemName?.(r)??`file:${e.id}:item-name:${r}`,es=(e,r)=>e.ids?.itemSizeText?.(r)??`file:${e.id}:item-size:${r}`,ts=(e,r)=>e.ids?.itemPreview?.(r)??`file:${e.id}:item-preview:${r}`,rs=e=>e.getById(Ct(e)),Ge=e=>e.getById(ge(e)),ss=e=>e.getById(Et(e));function He(e){const r=Ne(e);return e.dataTransfer?e.dataTransfer.types.some(a=>a==="Files"||a==="application/x-moz-file"):!!r&&"files"in r}function as(e,r){const{context:a,prop:s,computed:n}=e;return!n("multiple")&&r>1?!1:!n("multiple")&&r+a.get("acceptedFiles").length===2?!0:!(r+a.get("acceptedFiles").length>s("maxFiles"))}function ns(e,r){const{context:a,prop:s,computed:n}=e,o=[],d=[];return r.forEach(l=>{const[c,v]=Vr(l,n("acceptAttr")),[b,y]=$r(l,s("minFileSize"),s("maxFileSize")),w=s("validate")?.(l,{acceptedFiles:a.get("acceptedFiles"),rejectedFiles:a.get("rejectedFiles")}),u=w?w.length===0:!0;if(c&&b&&u)o.push(l);else{const i=[v,y];u||i.push(...w??[]),d.push({file:l,errors:i.filter(Boolean)})}}),as(e,o.length)||(o.forEach(l=>{d.push({file:l,errors:["TOO_MANY_FILES"]})}),o.splice(0)),{acceptedFiles:o,rejectedFiles:d}}function is(e,r){const a=lt(e);try{if("DataTransfer"in a){const s=new a.DataTransfer;r.forEach(n=>{s.items.add(n)}),e.files=s.files}}catch{}}function os(e,r){const{state:a,send:s,prop:n,computed:o,scope:d,context:l}=e,c=n("disabled"),v=n("allowDrop"),b=n("translations"),y=a.matches("dragging"),w=a.matches("focused")&&!c;return{dragging:y,focused:w,disabled:!!c,openFilePicker(){c||s({type:"OPEN"})},deleteFile(u){s({type:"FILE.DELETE",file:u})},acceptedFiles:l.get("acceptedFiles"),rejectedFiles:l.get("rejectedFiles"),setFiles(u){const i=u.length;s({type:"FILES.SET",files:u,count:i})},clearRejectedFiles(){s({type:"REJECTED_FILES.CLEAR"})},clearFiles(){s({type:"FILES.CLEAR"})},getFileSize(u){return Hr(u.size,n("locale"))},createFileUrl(u,i){const F=d.getWin(),g=F.URL.createObjectURL(u);return i(g),()=>F.URL.revokeObjectURL(g)},setClipboardFiles(u){if(c)return!1;const F=Array.from(u?.items??[]).reduce((g,j)=>{if(j.kind!=="file")return g;const N=j.getAsFile();return N?[...g,N]:g},[]);return F.length?(s({type:"FILES.SET",files:F}),!0):!1},getRootProps(){return r.element({...U.root.attrs,dir:n("dir"),id:Ct(d),"data-disabled":T(c),"data-dragging":T(y)})},getDropzoneProps(u={}){return r.element({...U.dropzone.attrs,dir:n("dir"),id:Et(d),tabIndex:c||u.disableClick?void 0:0,role:u.disableClick?"application":"button","aria-label":b.dropzone,"aria-disabled":c,"data-invalid":T(n("invalid")),"data-disabled":T(c),"data-dragging":T(y),onKeyDown(i){c||i.defaultPrevented||$e(i)&&(u.disableClick||i.key!=="Enter"&&i.key!==" "||s({type:"DROPZONE.CLICK",src:"keydown"}))},onClick(i){c||i.defaultPrevented||u.disableClick||$e(i)&&(i.currentTarget.localName==="label"&&i.preventDefault(),s({type:"DROPZONE.CLICK"}))},onDragOver(i){if(c||!v)return;i.preventDefault(),i.stopPropagation();try{i.dataTransfer.dropEffect="copy"}catch{}if(!He(i))return;const g=i.dataTransfer.items.length;s({type:"DROPZONE.DRAG_OVER",count:g})},onDragLeave(i){c||v&&(ie(i.currentTarget,i.relatedTarget)||s({type:"DROPZONE.DRAG_LEAVE"}))},onDrop(i){if(c)return;v&&(i.preventDefault(),i.stopPropagation());const F=He(i);c||!F||Ar(i.dataTransfer.items,n("directory")).then(g=>{s({type:"DROPZONE.DROP",files:st(g)})})},onFocus(){c||s({type:"DROPZONE.FOCUS"})},onBlur(){c||s({type:"DROPZONE.BLUR"})}})},getTriggerProps(){return r.button({...U.trigger.attrs,dir:n("dir"),id:Jr(d),disabled:c,"data-disabled":T(c),"data-invalid":T(n("invalid")),type:"button",onClick(u){c||(ie(ss(d),u.currentTarget)&&u.stopPropagation(),s({type:"OPEN"}))}})},getHiddenInputProps(){return r.input({id:ge(d),tabIndex:-1,disabled:c,type:"file",required:n("required"),capture:n("capture"),name:n("name"),accept:o("acceptAttr"),webkitdirectory:n("directory")?"":void 0,multiple:o("multiple")||n("maxFiles")>1,onClick(u){u.stopPropagation(),u.currentTarget.value=""},onInput(u){if(c)return;const{files:i}=u.currentTarget;s({type:"FILES.SET",files:i?Array.from(i):[]})},style:hr})},getItemGroupProps(){return r.element({...U.itemGroup.attrs,dir:n("dir"),"data-disabled":T(c)})},getItemProps(u){const{file:i}=u;return r.element({...U.item.attrs,dir:n("dir"),id:Qr(d,i.name),"data-disabled":T(c)})},getItemNameProps(u){const{file:i}=u;return r.element({...U.itemName.attrs,dir:n("dir"),id:Xr(d,i.name),"data-disabled":T(c)})},getItemSizeTextProps(u){const{file:i}=u;return r.element({...U.itemSizeText.attrs,dir:n("dir"),id:es(d,i.name),"data-disabled":T(c)})},getItemPreviewProps(u){const{file:i}=u;return r.element({...U.itemPreview.attrs,dir:n("dir"),id:ts(d,i.name),"data-disabled":T(c)})},getItemPreviewImageProps(u){const{file:i,url:F}=u;if(!i.type.startsWith("image/"))throw new Error("Preview Image is only supported for image files");return r.img({...U.itemPreviewImage.attrs,alt:b.itemPreview?.(i),src:F,"data-disabled":T(c)})},getItemDeleteTriggerProps(u){const{file:i}=u;return r.button({...U.itemDeleteTrigger.attrs,dir:n("dir"),type:"button",disabled:c,"data-disabled":T(c),"aria-label":b.deleteFile?.(i),onClick(){c||s({type:"FILE.DELETE",file:i})}})},getLabelProps(){return r.label({...U.label.attrs,dir:n("dir"),id:Yr(d),htmlFor:ge(d),"data-disabled":T(c)})},getClearTriggerProps(){return r.button({...U.clearTrigger.attrs,dir:n("dir"),type:"button",disabled:c,hidden:l.get("acceptedFiles").length===0,"data-disabled":T(c),onClick(u){u.defaultPrevented||c||s({type:"FILES.CLEAR"})}})}}}var ls={props({props:e}){return{minFileSize:0,maxFileSize:Number.POSITIVE_INFINITY,maxFiles:1,allowDrop:!0,preventDocumentDrop:!0,...e,translations:{dropzone:"dropzone",itemPreview:r=>`preview of ${r.name}`,deleteFile:r=>`delete file ${r.name}`,...e.translations}}},initialState(){return"idle"},context({prop:e,bindable:r,getContext:a}){return{acceptedFiles:r(()=>({defaultValue:[],isEqual:(s,n)=>s.length===n?.length&&s.every((o,d)=>Ze(o,n[d])),hash(s){return s.map(n=>`${n.name}-${n.size}`).join(",")},onChange(s){const n=a();e("onFileAccept")?.({files:s}),e("onFileChange")?.({acceptedFiles:s,rejectedFiles:n.get("rejectedFiles")})}})),rejectedFiles:r(()=>({defaultValue:[],isEqual:(s,n)=>s.length===n?.length&&s.every((o,d)=>Ze(o.file,n[d].file)),onChange(s){const n=a();e("onFileReject")?.({files:s}),e("onFileChange")?.({acceptedFiles:n.get("acceptedFiles"),rejectedFiles:s})}}))}},computed:{acceptAttr:({prop:e})=>zr(e("accept")),multiple:({prop:e})=>e("maxFiles")>1},watch({track:e,context:r,action:a}){e([()=>r.hash("acceptedFiles")],()=>{a(["syncInputElement"])})},on:{"FILES.SET":{actions:["setFilesFromEvent"]},"FILE.DELETE":{actions:["removeFile"]},"FILES.CLEAR":{actions:["clearFiles"]},"REJECTED_FILES.CLEAR":{actions:["clearRejectedFiles"]}},effects:["preventDocumentDrop"],states:{idle:{on:{OPEN:{actions:["openFilePicker"]},"DROPZONE.CLICK":{actions:["openFilePicker"]},"DROPZONE.FOCUS":{target:"focused"},"DROPZONE.DRAG_OVER":{target:"dragging"}}},focused:{on:{"DROPZONE.BLUR":{target:"idle"},OPEN:{actions:["openFilePicker"]},"DROPZONE.CLICK":{actions:["openFilePicker"]},"DROPZONE.DRAG_OVER":{target:"dragging"}}},dragging:{on:{"DROPZONE.DROP":{target:"idle",actions:["setFilesFromEvent"]},"DROPZONE.DRAG_LEAVE":{target:"idle"}}}},implementations:{effects:{preventDocumentDrop({prop:e,scope:r}){if(!e("preventDocumentDrop")||!e("allowDrop")||e("disabled"))return;const a=r.getDoc(),s=o=>{o?.preventDefault()},n=o=>{ie(rs(r),Ne(o))||o.preventDefault()};return at(_e(a,"dragover",s,!1),_e(a,"drop",n,!1))}},actions:{syncInputElement({scope:e,context:r}){queueMicrotask(()=>{const a=Ge(e);if(!a)return;is(a,r.get("acceptedFiles"));const s=e.getWin();a.dispatchEvent(new s.Event("change",{bubbles:!0}))})},openFilePicker({scope:e}){pr(()=>{Ge(e)?.click()})},setFilesFromEvent(e){const{computed:r,context:a,event:s}=e,n=ns(e,s.files),{acceptedFiles:o,rejectedFiles:d}=n;if(r("multiple")){a.set("acceptedFiles",l=>[...l,...o]),a.set("rejectedFiles",d);return}if(o.length){const l=[o[0]];a.set("acceptedFiles",l),a.set("rejectedFiles",d)}else d.length&&(a.set("acceptedFiles",a.get("acceptedFiles")),a.set("rejectedFiles",d))},removeFile({context:e,event:r}){const a=e.get("acceptedFiles").filter(n=>n!==r.file),s=e.get("rejectedFiles").filter(n=>n.file!==r.file);e.set("acceptedFiles",a),e.set("rejectedFiles",s)},clearRejectedFiles({context:e}){e.set("acceptedFiles",e.get("acceptedFiles")),e.set("rejectedFiles",[])},clearFiles({context:e}){e.set("acceptedFiles",[]),e.set("rejectedFiles",[])}}}};ct()(["accept","allowDrop","capture","dir","directory","disabled","getRootNode","id","ids","locale","maxFiles","maxFileSize","minFileSize","name","invalid","onFileAccept","onFileReject","onFileChange","preventDocumentDrop","required","translations","validate"]);ct()(["file"]);const cs=e=>{const r=m.useId(),{getRootNode:a}=Rr(),{dir:s,locale:n}=Tr(),o=ut(),d={id:r,ids:{label:o?.ids.label,hiddenInput:o?.ids.control},dir:s,disabled:o?.disabled,locale:n,required:o?.required,invalid:o?.invalid,getRootNode:a,...e},l=wr(ls,d);return os(l,Pr)},It=m.forwardRef((e,r)=>{const[{value:a},s]=ye()(e,["value"]),n=k(a.getRootProps(),s);return t.jsx(Sr,{value:a,children:t.jsx(A.div,{...n,ref:r})})});It.displayName="FileUploadRootProvider";const je=m.forwardRef((e,r)=>{const a=M(),s=k(a.getTriggerProps(),e);return t.jsx(A.button,{...s,ref:r})});je.displayName="FileUploadTrigger";const Ke=({teamspaceId:e=null,projectId:r=null,chatroomId:a=null,organizationId:s,uploadType:n="DOCUMENT",receiverIds:o=[],onUploadComplete:d,compact:l=!1,files:c=[],className:v=""})=>{const b=cs({maxFiles:10,maxFileSize:52428800}),[y,w]=m.useState(!1),[u,i]=m.useState(!1),F=async j=>{if(j.length){w(!0);try{const N=new FormData,h={teamspaceId:e||null,projectId:r||null,chatroomId:a||null,organizationId:s,uploadType:n};N.append("metadata",JSON.stringify(h)),o.length>0&&N.append("receiverIds",JSON.stringify(o)),j.forEach(C=>{N.append("file",C)});const P=await Z().file_management.uploadFilesWithMetadata("POST",N);if(!P.ok)throw new Error(`Upload failed: ${P.statusText}`);const S=await P.json();console.log("Upload successful:",S),d&&d(S),l&&i(!1)}catch(N){console.error("Error uploading files:",N instanceof Error?N.message:String(N))}finally{w(!1)}}},g=j=>{if(j===0)return"0 Bytes";const N=1024,h=["Bytes","KB","MB","GB"],P=Math.floor(Math.log(j)/Math.log(N));return parseFloat((j/Math.pow(N,P)).toFixed(1))+" "+h[P]};return l&&!u?t.jsxs("div",{className:`flex items-center gap-2 ${v}`,children:[t.jsxs("button",{onClick:()=>i(!0),className:"inline-flex items-center gap-1 text-xs px-2 py-1 rounded-md bg-emerald-50 text-emerald-700 hover:bg-emerald-100 transition-colors",children:[t.jsx(ce,{size:12}),t.jsx("span",{children:"Upload"})]}),c&&c.length>0&&t.jsxs("div",{className:"text-xs text-muted-foreground",children:[c.length," file",c.length!==1?"s":""]})]}):t.jsx(It,{value:b,children:t.jsxs("div",{className:`relative ${v}`,children:[l&&t.jsx("button",{onClick:()=>i(!1),className:"absolute right-0 top-0 p-1 text-gray-400 hover:text-gray-600 z-10",children:t.jsx(we,{size:16})}),t.jsxs("div",{className:"space-y-2",children:[!l&&t.jsx(yt,{className:"block text-sm font-medium text-gray-700",children:"Upload Files"}),t.jsx(ft,{className:`border-2 border-dashed border-gray-300 rounded-lg text-center
            ${l?"p-3":"p-6"} bg-gray-50 hover:bg-gray-100 transition-colors`,children:l?t.jsxs("div",{className:"flex flex-col items-center",children:[t.jsx(ce,{className:"h-5 w-5 text-gray-500 mb-1"}),t.jsx(je,{className:"text-xs text-emerald-600 font-medium hover:underline",children:"Choose Files"})]}):t.jsxs(t.Fragment,{children:[t.jsx("p",{className:"text-gray-600 mb-2",children:"Drag your files here"}),t.jsx(je,{className:"py-2 px-4 bg-emerald-600 text-white rounded hover:bg-emerald-700 transition-colors",children:"Choose Files"})]})}),t.jsx(gt,{children:t.jsx(kr,{children:j=>t.jsxs(t.Fragment,{children:[j.acceptedFiles.length>0&&t.jsx("div",{className:`space-y-2 mt-2 ${l?"max-h-32 overflow-y-auto":""}`,children:j.acceptedFiles.map(N=>t.jsxs(ht,{file:N,className:"flex items-center p-2 border rounded bg-white",children:[t.jsx(xe,{type:"image/*",className:"w-8 h-8 mr-2 bg-gray-100 flex items-center justify-center rounded overflow-hidden",children:t.jsx(vt,{className:"max-w-full max-h-full object-cover"})}),t.jsx(xe,{type:".*",className:"w-8 h-8 mr-2 bg-gray-100 flex items-center justify-center rounded",children:t.jsx(ne,{className:"h-4 w-4 text-gray-500"})}),t.jsxs("div",{className:"flex-1 truncate",children:[t.jsx(jt,{className:"font-medium text-sm truncate"}),t.jsx(Nt,{className:"text-xs text-gray-500"})]}),y?t.jsx("div",{className:"animate-pulse text-emerald-500",children:t.jsxs("svg",{className:"animate-spin h-4 w-4",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[t.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),t.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]})}):t.jsx(xt,{className:"text-red-500 hover:text-red-700 p-1",children:t.jsx(we,{className:"h-4 w-4"})})]},N.name))}),j.acceptedFiles.length>0&&!y&&t.jsxs("button",{onClick:()=>F(j.acceptedFiles),className:`mt-2 py-1.5 px-3 bg-emerald-600 text-white rounded hover:bg-emerald-700 transition-colors
                        flex items-center justify-center gap-1.5 ${l?"text-xs w-full":"w-full"}`,children:[t.jsx(ce,{className:`${l?"h-3 w-3":"h-4 w-4"}`}),t.jsxs("span",{children:["Upload ",j.acceptedFiles.length," File",j.acceptedFiles.length!==1?"s":""]})]})]})})})]}),c&&c.length>0&&!l&&t.jsxs("div",{className:"mt-4",children:[t.jsx("h4",{className:"text-sm font-medium mb-2 text-gray-700",children:"Uploaded Files"}),t.jsx("div",{className:"space-y-2 max-h-40 overflow-y-auto pr-1",children:c.map((j,N)=>t.jsxs("div",{className:"flex items-center p-2 border rounded bg-white",children:[t.jsx("div",{className:"w-8 h-8 mr-2 bg-gray-100 flex items-center justify-center rounded",children:t.jsx(ne,{className:"h-4 w-4 text-gray-500"})}),t.jsxs("div",{className:"flex-1 truncate",children:[t.jsx("p",{className:"font-medium text-sm truncate",children:j.name||`File ${N+1}`}),t.jsx("p",{className:"text-xs text-gray-500",children:j.size?g(j.size):"Unknown size"})]}),t.jsx(Kt,{className:"h-4 w-4 text-emerald-500"})]},N))})]}),t.jsx(pt,{})]})})},Je=e=>{switch(e){case"OWNER":return"bg-green-100 text-green-800 border-green-200";case"ADMIN":return"bg-red-100 text-red-800 border-red-200";case"CONTRIBUTOR":return"bg-blue-100 text-blue-800 border-blue-200";case"VIEWER":return"bg-gray-100 text-gray-800 border-gray-200";default:return"bg-gray-100 text-gray-800 border-gray-200"}};function ds({members:e}){const[r,a]=m.useState(!1),[s,n]=m.useState(!1),o=5,d=e.filter((i,F,g)=>F===g.findIndex(j=>j.user?.id===i.user?.id)),l=d.filter(i=>!i.hasLeft),c=d.filter(i=>i.hasLeft),v=(i,F)=>{const g={OWNER:0,ADMIN:1,CONTRIBUTOR:2,VIEWER:3};return(g[i.role]||4)-(g[F.role]||4)},b=[...l].sort(v),y=[...c].sort(v),w=r?b:b.slice(0,l.length>=o?o:l.length),u=l.length>o&&!r;return t.jsxs("div",{className:"space-y-3",children:[t.jsx("div",{children:w.map(i=>t.jsx("div",{className:"py-1.5",children:t.jsxs("div",{className:"relative flex items-center justify-between group",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(Ae,{className:"h-7 w-7",children:i.user?.image?t.jsx("img",{src:i.user.image,alt:i.user?.name||"User"}):t.jsx("div",{className:"bg-gray-200 h-full w-full flex items-center justify-center text-gray-700 text-xs",children:(i.user?.name||"U").charAt(0)})}),t.jsx(me,{children:t.jsxs(ue,{children:[t.jsx(fe,{asChild:!0,children:t.jsx("span",{className:"text-sm font-medium truncate max-w-[120px]",children:i.user?.name||"Unknown User"})}),t.jsxs(pe,{children:[t.jsx("p",{children:i.user?.name||"Unknown User"}),t.jsx("p",{className:"text-xs text-muted-foreground",children:i.user?.email})]})]})})]}),t.jsx(Ie,{className:Je(i.role),children:i.role})]})},i.id))}),u&&t.jsx(D,{variant:"ghost",size:"sm",className:"w-full text-xs h-7",onClick:()=>a(!0),children:t.jsxs("span",{className:"flex items-center",children:["Show ",l.length-o," More ",t.jsx(De,{className:"ml-1 h-3 w-3"})]})}),r&&l.length>o&&t.jsx(D,{variant:"ghost",size:"sm",className:"w-full text-xs h-7",onClick:()=>a(!1),children:t.jsxs("span",{className:"flex items-center",children:["Show Less ",t.jsx(Re,{className:"ml-1 h-3 w-3"})]})}),c.length>0&&t.jsxs(zt,{open:s,onOpenChange:n,className:"mt-3",children:[t.jsxs("div",{className:"flex items-center text-xs text-muted-foreground",children:[t.jsx("div",{className:"h-px bg-border flex-grow mr-2"}),t.jsx($t,{asChild:!0,children:t.jsxs("button",{className:"flex items-center gap-1 px-2 py-1 rounded-sm hover:bg-muted/50 transition-colors",children:[t.jsxs("span",{children:["Former Members (",c.length,")"]}),s?t.jsx(Re,{className:"h-3 w-3"}):t.jsx(De,{className:"h-3 w-3"})]})}),t.jsx("div",{className:"h-px bg-border flex-grow ml-2"})]}),t.jsx(_t,{className:"pt-2",children:t.jsx("div",{className:"space-y-1.5",children:y.map(i=>t.jsx("div",{children:t.jsxs("div",{className:"relative flex items-center justify-between group py-1.5",children:[t.jsx("div",{className:"absolute inset-0 rounded-md bg-muted/30 pointer-events-none"}),t.jsxs("div",{className:"flex items-center gap-2 z-10",children:[t.jsxs("div",{className:"relative",children:[t.jsx(Ae,{className:"h-7 w-7",children:i.user?.image?t.jsx("img",{src:i.user.image,alt:i.user?.name||"User",className:"filter grayscale"}):t.jsx("div",{className:"bg-gray-200 h-full w-full flex items-center justify-center text-gray-700 text-xs",children:(i.user?.name||"U").charAt(0)})}),t.jsx("div",{className:"absolute -bottom-1 -right-1 rounded-full w-3 h-3 bg-muted border border-background flex items-center justify-center",children:t.jsx("span",{className:"text-[8px]",children:"Ã—"})})]}),t.jsx(me,{children:t.jsxs(ue,{children:[t.jsx(fe,{asChild:!0,children:t.jsx("span",{className:"text-sm font-medium truncate max-w-[120px] text-muted-foreground",children:i.user?.name||"Unknown User"})}),t.jsxs(pe,{children:[t.jsx("p",{children:i.user?.name||"Unknown User"}),t.jsx("p",{className:"text-xs text-muted-foreground",children:i.user?.email}),t.jsx("p",{className:"text-xs text-red-500 mt-1",children:"No longer a member"})]})]})})]}),t.jsx(Ie,{className:`${Je(i.role)} opacity-70`,children:i.role})]})},i.id))})})]})]})}const ws=function(){const{projectId:r}=Fe.useParams(),[a,s]=m.useState(!1),[n,o]=m.useState(!0),[d,l]=m.useState(""),[c,v]=m.useState(""),[b,y]=m.useState(!1),[w,u]=m.useState(!1),[i,F]=Tt(Xe),g=Qe(St),j=Fe.useRouteContext(),[N]=m.useState(j.userId),h=i.flatMap(x=>x.projects||[]).find(x=>x.id===r),P=i.find(x=>x.id===h?.teamspaceId);m.useEffect(()=>{h&&o(!1)},[h]);const S=Ye();if(n)return t.jsxs("div",{className:"flex-1 flex flex-col h-full",children:[t.jsx("div",{className:"h-1.5 bg-gray-200 w-full"}),t.jsxs("div",{className:"p-6 max-w-5xl mx-auto w-full flex-1",children:[t.jsxs("div",{className:"mb-8 relative",children:[t.jsx($,{className:"h-10 w-60 mb-2"}),t.jsx($,{className:"h-4 w-full max-w-md mb-4"})]}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[t.jsxs("div",{className:"md:col-span-2 space-y-6",children:[t.jsx("div",{children:t.jsx($,{className:"h-32 w-full mb-6"})}),t.jsxs("div",{children:[t.jsx("div",{className:"flex justify-between items-center mb-4",children:t.jsx($,{className:"h-8 w-40"})}),t.jsxs("div",{className:"space-y-3",children:[t.jsx($,{className:"h-16 w-full"}),t.jsx($,{className:"h-16 w-full"})]})]})]}),t.jsxs("div",{className:"space-y-6",children:[t.jsx($,{className:"h-60 w-full"}),t.jsx($,{className:"h-60 w-full"})]})]})]})]});if(!h)return t.jsxs("div",{className:"flex-1 flex flex-col items-center justify-center p-8 text-center",children:[t.jsx("h2",{className:"text-2xl font-bold mb-4",children:"Project not found"}),t.jsx("p",{className:"text-muted-foreground mb-6",children:"The project you're looking for doesn't exist or you don't have access to it."}),P?t.jsx(D,{variant:"outline",asChild:!0,children:t.jsx(ee,{to:"/teamspace/$teamspaceId",params:{teamspaceId:P.id},children:"Back to Teamspace"})}):t.jsx(D,{variant:"outline",asChild:!0,children:t.jsx(ee,{to:"/chat",children:"Go to Chat"})})]});const C=async(x="")=>{if(a)return;s(!0);const f=Ee({currentUserId:N,project:h,teamspace:P});try{const{data:p}=await Z().chatrooms.createChatroom({chatroomCreatorId:N,chatroomMembers:f,isPrivate:!1,projectId:h.id,name:x.trim()||"New Chat Conversation",teamIds:[],type:"PROJECT_CHATROOM"});h.chatrooms?.push(p),g(p),S({to:"/chat/$chatroomId",params:{chatroomId:p.id}})}catch(p){console.error("Error creating chatroom:",p)}finally{s(!1),u(!1),v("")}},_=async()=>{if(!(!d.trim()||a))try{s(!0);const x=Ee({currentUserId:N,project:h,teamspace:P}),{data:f}=await Z().chatrooms.createChatroom({chatroomCreatorId:N,chatroomMembers:x,isPrivate:!1,projectId:h.id,name:"New Chat Conversation",teamIds:[],type:"PROJECT_CHATROOM"});h.chatrooms?.push(f),localStorage.setItem("pendingMessage",d),g(f),S({to:"/chat/$chatroomId",params:{chatroomId:f.id}})}catch(x){console.error("Error starting quick chat:",x),s(!1)}},E=x=>{const f=i.map(p=>p.id===P?.id?{...p,projects:p.projects?.map(R=>R.id===h?.id?x:R)}:p);F(f)};return t.jsxs("div",{className:"flex-1 flex flex-col h-full",children:[t.jsx("div",{className:"h-1.5 bg-emerald-500 w-full flex-shrink-0"}),t.jsxs("div",{className:"p-6 max-w-5xl mx-auto w-full flex-1 overflow-y-auto",children:[t.jsxs("div",{className:"flex items-center text-sm text-muted-foreground mb-4",children:[t.jsxs(ee,{to:"/chat",className:"flex items-center hover:text-foreground transition-colors",children:[t.jsx(Mt,{className:"h-3.5 w-3.5 mr-1"}),"Home"]}),P&&t.jsxs(t.Fragment,{children:[t.jsx(Pe,{className:"h-3.5 w-3.5 mx-1.5"}),t.jsxs(ee,{to:"/teamspace/$teamspaceId",params:{teamspaceId:P.id},className:"flex items-center hover:text-foreground transition-colors",children:[t.jsx(Ue,{className:"h-3.5 w-3.5 mr-1.5"}),P.name]})]}),t.jsx(Pe,{className:"h-3.5 w-3.5 mx-1.5"}),t.jsxs("span",{className:"font-medium text-foreground flex items-center",children:[t.jsx(Me,{className:"h-3.5 w-3.5 mr-1.5"}),"Project"]})]}),t.jsxs("div",{className:"mb-8 relative",children:[t.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[t.jsx("div",{className:"flex h-10 w-10 items-center justify-center rounded-lg bg-emerald-100 text-emerald-700",children:t.jsx(Me,{className:"h-5 w-5"})}),t.jsxs("div",{children:[t.jsx("h1",{className:"text-3xl font-bold",children:h.name}),t.jsxs("div",{className:"flex items-center mt-1",children:[t.jsx("span",{className:"inline-flex items-center rounded-md bg-emerald-50 px-2 py-1 text-xs font-medium text-emerald-700 ring-1 ring-inset ring-emerald-600/20",children:"Project"}),h.isPrivate&&t.jsxs("span",{className:"ml-2 inline-flex items-center rounded-md bg-gray-50 px-2 py-1 text-xs font-medium text-gray-700 ring-1 ring-inset ring-gray-600/20",children:[t.jsx(re,{className:"h-3 w-3 mr-1"}),"Private"]}),P&&t.jsxs("span",{className:"ml-2 text-sm text-muted-foreground flex items-center",children:[t.jsx(Ue,{className:"h-3 w-3 mr-1"}),P.name]})]})]})]}),t.jsx("div",{className:"mt-2",children:t.jsx("p",{className:"text-muted-foreground",children:h.description||"No description provided"})}),t.jsx("div",{className:"absolute top-0 right-0",children:t.jsx(Xt,{project:h,userId:N,onProjectUpdated:E})})]}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[t.jsxs("div",{className:"md:col-span-2 space-y-6",children:[t.jsxs(V,{className:"border-b-4 border-b-emerald-500",children:[t.jsxs(B,{className:"pb-3",children:[t.jsx(W,{children:"New chat in this project"}),t.jsx(te,{children:"Start a new conversation in the context of this project"})]}),t.jsx(G,{children:t.jsxs(kt,{value:d,onChange:x=>l(x.target.value),onSubmit:_,hasMessages:!1,children:[t.jsx(Ot,{placeholder:a?"Creating chat...":"Type a message to start a new chat...",disabled:a,onKeyDown:x=>{x.key==="Enter"&&!x.shiftKey&&(x.preventDefault(),_())}}),t.jsx(Ut,{disabled:a||!d.trim()})]})})]}),t.jsxs("div",{children:[t.jsxs("div",{className:"flex justify-between items-center mb-4",children:[t.jsx("h2",{className:"text-xl font-semibold",children:"Chats in this project"}),w?t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("input",{type:"text",className:"px-3 py-1 border rounded-md text-sm",placeholder:"Chatroom name...",value:c,onChange:x=>v(x.target.value),onKeyDown:x=>{x.key==="Enter"?C(c):x.key==="Escape"&&(u(!1),v(""))},autoFocus:!0}),t.jsx(D,{size:"sm",onClick:()=>C(c),disabled:a,className:"bg-emerald-600 hover:bg-emerald-700 text-white hover:cursor-pointer",children:"Create"}),t.jsx(D,{size:"sm",variant:"ghost",onClick:()=>{u(!1),v("")},className:"hover:cursor-pointer",children:"Cancel"})]}):t.jsxs(D,{size:"sm",onClick:()=>u(!0),disabled:a,className:"bg-emerald-600 hover:bg-emerald-700 text-white hover:cursor-pointer",children:[t.jsx(Le,{className:"h-4 w-4 mr-2"})," New Chat"]})]}),h.chatrooms&&h.chatrooms.length>0?t.jsx("div",{className:"space-y-3",children:h.chatrooms.map(x=>t.jsx(V,{className:oe("cursor-pointer transition-all border-l-4 border-l-transparent","hover:shadow-md hover:border-l-emerald-500 hover:bg-muted/30"),onClick:()=>{g(x),S({to:"/chat"})},children:t.jsx(B,{className:"py-3",children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs(W,{className:"text-base flex items-center",children:[t.jsx(Jt,{className:"h-4 w-4 mr-2"}),x.name,x.isPrivate&&t.jsx(me,{children:t.jsxs(ue,{children:[t.jsx(fe,{asChild:!0,children:t.jsx("span",{children:t.jsx(re,{className:"h-3 w-3 ml-2 text-red-500"})})}),t.jsx(pe,{children:t.jsx("p",{children:"Private"})})]})})]}),t.jsx("div",{className:"flex items-center gap-3 text-muted-foreground text-xs",children:t.jsxs("div",{className:"flex items-center",children:[t.jsx(Ce,{className:"h-3 w-3 mr-1"}),x.members?.length||1]})})]})})},x.id))}):t.jsxs("div",{className:"border rounded-lg p-8 text-center bg-muted/20",children:[t.jsx("h3",{className:"font-medium mb-2",children:"No chats yet"}),t.jsx("p",{className:"text-muted-foreground mb-4",children:"Start by creating your first chat in this project"}),t.jsxs(D,{variant:"outline",onClick:()=>u(!0),className:"border-emerald-600/20 text-emerald-700 hover:bg-emerald-50",children:[t.jsx(Le,{className:"h-4 w-4 mr-2"})," Create Chat"]})]})]})]}),t.jsxs("div",{className:"space-y-6",children:[t.jsxs(V,{className:"border-t-4 border-t-emerald-500",children:[t.jsxs(B,{children:[t.jsxs(W,{className:"flex items-center justify-between",children:[t.jsx("span",{children:"Project Context"}),t.jsx(D,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0 hover:cursor-pointer",onClick:()=>y(!b),children:t.jsx(et,{className:"h-4 w-4"})})]}),t.jsx(te,{children:"Information about this project's purpose"})]}),t.jsx(G,{children:b?t.jsxs("div",{className:"space-y-4",children:[t.jsx("textarea",{className:"w-full min-h-[150px] p-3 border rounded-md",placeholder:"Describe what this teamspace is used for...",value:h.context}),t.jsxs("div",{className:"flex justify-end space-x-2",children:[t.jsx(D,{variant:"outline",size:"sm",onClick:()=>y(!1),children:"Cancel"}),t.jsx(D,{size:"sm",onClick:()=>y(!1),children:"Save"})]})]}):t.jsx("div",{className:"text-sm",children:t.jsx("p",{children:h.context})})})]}),t.jsxs(V,{className:"border-t-4 border-t-emerald-500",children:[t.jsxs(B,{children:[t.jsx(W,{children:"Members"}),t.jsx(te,{children:"People with access to this project"})]}),t.jsx(G,{children:h.members&&h.members.length>0?t.jsx(ds,{members:h.members}):t.jsx("div",{className:"text-sm text-muted-foreground",children:"Only you have access to this project"})}),t.jsx(At,{children:t.jsx(Lt,{type:"project",projectId:h.id,teamspaceId:h.teamspaceId,members:h.members||[],userId:N,onMembersChanged:()=>{Z().chatrooms.getTeamspaces().then(({data:x})=>{x&&F(x)})},children:t.jsxs(D,{size:"sm",variant:"outline",className:"w-full border-emerald-600/20 text-emerald-700 hover:bg-emerald-50 hover:cursor-pointer",children:[t.jsx(Ce,{className:"h-4 w-4 mr-2"})," Manage Members"]})})})]}),t.jsxs(V,{className:"border-t-4 border-t-emerald-500",children:[t.jsx(B,{children:t.jsx(W,{children:"Project Stats"})}),t.jsx(G,{children:t.jsxs("div",{className:"space-y-2",children:[t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{className:"text-muted-foreground",children:"Chats"}),t.jsx("span",{className:"font-medium",children:h.chatrooms?.length||0})]}),t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{className:"text-muted-foreground",children:"Members"}),t.jsx("span",{className:"font-medium",children:h.members?.length||1})]}),t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{className:"text-muted-foreground",children:"Files"}),t.jsx("span",{className:"font-medium",children:h.files?.length||0})]}),t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{className:"text-muted-foreground",children:"Created"}),t.jsx("span",{className:"font-medium",children:new Date(h.createdAt).toLocaleDateString()})]}),h.isPrivate&&t.jsxs("div",{className:"flex justify-between items-center pt-2 mt-2 border-t",children:[t.jsxs("span",{className:"text-muted-foreground flex items-center",children:[t.jsx(re,{className:"h-3.5 w-3.5 mr-1.5 text-red-500"}),"Visibility"]}),t.jsx("span",{className:"font-medium text-sm bg-gray-100 px-2 py-0.5 rounded",children:"Private"})]})]})})]}),t.jsxs(V,{className:"border-t-4 border-t-emerald-500",children:[t.jsxs(B,{className:"pb-2",children:[t.jsxs(W,{className:"flex items-center justify-between",children:[t.jsx("span",{children:"Project Files"}),t.jsx(Ke,{teamspaceId:P?.id,projectId:h.id,organizationId:j.session?.activeOrganizationId||void 0,compact:!0,files:h.files||[],className:"ml-auto"})]}),t.jsx(te,{children:"Upload and manage files for this project"})]}),t.jsx(G,{children:h.files&&h.files.length>0?t.jsx("div",{className:"space-y-2 max-h-64 overflow-y-auto pr-1",children:h.files.map((x,f)=>t.jsxs("div",{className:"flex items-center p-2 border rounded bg-white hover:bg-gray-50 transition-colors",children:[t.jsx("div",{className:"w-8 h-8 mr-2 bg-gray-100 flex items-center justify-center rounded",children:t.jsx(ne,{className:"h-4 w-4 text-gray-500"})}),t.jsxs("div",{className:"flex-1 truncate",children:[t.jsx("p",{className:"font-medium text-sm truncate",children:x.fileName||`File ${f+1}`}),t.jsx("p",{className:"text-xs text-muted-foreground",children:new Date(x.createdAt).toLocaleDateString()})]})]},f))}):t.jsxs("div",{className:"text-center py-6 bg-muted/20 rounded-lg border border-dashed",children:[t.jsx(ne,{className:"h-8 w-8 mx-auto text-muted-foreground mb-2"}),t.jsx("p",{className:"text-sm text-muted-foreground mb-3",children:"No files uploaded yet"}),t.jsx(Ke,{projectId:h.id,organizationId:j.session?.activeOrganizationId||void 0,compact:!0})]})})]})]})]})]})]})};export{ws as component};
