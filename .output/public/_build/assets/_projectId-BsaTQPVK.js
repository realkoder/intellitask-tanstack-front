import{l as X,r as u,j as t,a2 as de,aA as Tt,u as et,ah as tt,ai as rt,Y as kt,a3 as Ot,B as S,af as st,Z as Ut,a6 as Ce,_ as Ee,a7 as Ie,a0 as te,g as De,a1 as At,a8 as Lt,$ as Mt,ak as zt,k as $,al as H,aB as we,aC as me,X as Re,aD as Se,an as $t,aE as _t,L as re,ap as Te,aq as ke,aF as Oe,C as V,a as W,b as q,c as se,d as K,J as Bt,K as Vt,N as Wt,ar as he,as as xe,at as ge,au as je,U as Ue,h as qt,aG as Ae,aw as Le,ax as Me,ay as ze,az as $e}from"./client-LSARlrfQ.js";import{S as _,H as Zt,M as Gt,C as Ht,a as Kt,b as Jt}from"./collapsible-DJ8QDLqz.js";import{L as ae}from"./lock-D3ifyutX.js";import{T as _e}from"./trash-2-SYuB1gpe.js";/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yt=X("CircleAlert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xt=X("CircleCheckBig",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oe=X("File",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qt=X("MessageCircle",[["path",{d:"M7.9 20A9 9 0 1 0 4 16.1L2 22Z",key:"vv11sd"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Be=X("MessageSquarePlus",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}],["path",{d:"M12 7v6",key:"lw1j43"}],["path",{d:"M9 10h6",key:"9gxzsh"}]]),er=Tt("relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive",warning:"border-amber-500/50 text-amber-700 [&>svg]:text-amber-700"}},defaultVariants:{variant:"default"}}),at=u.forwardRef(({className:e,variant:r,...a},s)=>t.jsx("div",{ref:s,role:"alert",className:de(er({variant:r}),e),...a}));at.displayName="Alert";const tr=u.forwardRef(({className:e,...r},a)=>t.jsx("h5",{ref:a,className:de("mb-1 font-medium leading-none tracking-tight",e),...r}));tr.displayName="AlertTitle";const nt=u.forwardRef(({className:e,...r},a)=>t.jsx("div",{ref:a,className:de("text-sm [&_p]:leading-relaxed",e),...r}));nt.displayName="AlertDescription";function rr({project:e,onProjectUpdated:r,trigger:a,userId:s}){const n=et(),o=tt(rt),[d,l]=u.useState(!1),[c,v]=u.useState(!1),[b,y]=u.useState(!1),[w,m]=u.useState(!1),[i,F]=u.useState(""),[h,g]=u.useState({name:"",description:"",isPrivate:!1}),[N,p]=u.useState(!0);u.useEffect(()=>{if(d){g({name:e.name||"",description:e.description||"",isPrivate:e.isPrivate||!1});const C=e.members?.length||0;p(C<=1),m(!1),F("")}},[d,e]);const P=C=>{g({...h,[C.target.name]:C.target.value})},k=C=>{g({...h,isPrivate:C})},I=async C=>{if(C.preventDefault(),!e.id){$.error("Project not found");return}if(!h.name.trim()){$.error("Project name is required");return}if(h.isPrivate&&!N&&!e.isPrivate){$.error("Cannot make a project private when it has multiple members");return}v(!0);try{const{data:x}=await H().chatrooms.updateProject(e.id,{teamspaceId:e.teamspaceId,context:e.context,creatorId:s,name:h.name,description:h.description,isPrivate:h.isPrivate,members:h.isPrivate?[]:e.members?.map(D=>({projectId:e.id,userId:D.user.id,role:D.role,invitedByUserId:s}))});r(x),$.success("Project settings updated successfully"),l(!1)}catch(x){console.error("Error updating project:",x),$.error("Failed to update project")}finally{v(!1)}},B=async()=>{if(i!==e.name){$.error("Project name does not match");return}y(!0);try{await H().chatrooms.deleteProject(e.id),$.success("Project deleted successfully"),l(!1),e.teamspaceId?(o(C=>C.map(D=>({...D,projects:D.projects.filter(f=>f.id!==e.id)}))),n({to:"/teamspace/$teamspaceId",params:{teamspaceId:e.teamspaceId}})):n({to:"/chat"})}catch(C){console.error("Error deleting project:",C),$.error("Failed to delete project")}finally{y(!1)}};return t.jsxs(kt,{open:d,onOpenChange:l,children:[t.jsx(Ot,{asChild:!0,children:a||t.jsxs(S,{size:"sm",variant:"outline",className:"hover:cursor-pointer",children:[t.jsx(st,{className:"h-4 w-4 mr-2"})," Project Settings"]})}),t.jsx(Ut,{className:"sm:max-w-[500px]",children:w?t.jsxs("div",{children:[t.jsxs(Ce,{children:[t.jsx("div",{className:"h-1.5 bg-red-500 w-full absolute top-0 left-0 rounded-t-lg"}),t.jsxs(Ee,{className:"text-xl mt-2 text-red-600 flex items-center",children:[t.jsx(_e,{className:"h-5 w-5 mr-2"})," Delete Project"]}),t.jsx(Ie,{children:"This action cannot be undone. This will permanently delete the project and remove all associated chats and data."})]}),t.jsxs("div",{className:"py-4",children:[t.jsx("div",{className:"bg-red-50 border border-red-200 rounded-md p-4 mb-4",children:t.jsxs("div",{className:"flex items-center",children:[t.jsx("span",{className:"text-xl mr-2",children:"ðŸ’©"}),t.jsxs("p",{className:"text-sm text-red-800",children:["Are you absolutely sure you want to delete ",t.jsx("strong",{children:e.name}),"? This action is irreversible!"]})]})}),t.jsxs("div",{className:"grid gap-2",children:[t.jsxs(te,{htmlFor:"confirmName",className:"text-sm font-medium",children:["To confirm, type ",t.jsx("span",{className:"font-bold",children:e.name})," below:"]}),t.jsx(De,{id:"confirmName",value:i,onChange:C=>F(C.target.value),placeholder:`Type "${e.name}" to confirm`})]}),t.jsxs("div",{className:"flex justify-between mt-6",children:[t.jsx(S,{type:"button",variant:"outline",onClick:()=>m(!1),disabled:b,children:"Cancel"}),t.jsx(S,{type:"button",variant:"destructive",className:"bg-red-600 hover:bg-red-700",onClick:B,disabled:i!==e.name||b,children:b?"Deleting...":"Permanently Delete Project"})]})]})]}):t.jsxs("form",{onSubmit:I,children:[t.jsxs(Ce,{children:[t.jsx("div",{className:"h-1.5 bg-emerald-500 w-full absolute top-0 left-0 rounded-t-lg"}),t.jsx(Ee,{className:"text-xl mt-2",children:"Project Settings"}),t.jsx(Ie,{children:"Update the details and settings of your project"})]}),t.jsxs("div",{className:"grid gap-4 py-4",children:[t.jsxs("div",{className:"grid gap-2",children:[t.jsxs(te,{htmlFor:"name",children:["Project Name ",t.jsx("span",{className:"text-red-500",children:"*"})]}),t.jsx(De,{id:"name",name:"name",value:h.name,onChange:P,placeholder:"e.g. Marketing Campaign",required:!0})]}),t.jsxs("div",{className:"grid gap-2",children:[t.jsx(te,{htmlFor:"description",children:"Description"}),t.jsx(At,{id:"description",name:"description",value:h.description,onChange:P,placeholder:"What is this project about?",rows:3})]}),t.jsxs("div",{className:"flex items-center space-x-2",children:[t.jsx(Lt,{id:"isPrivate",checked:h.isPrivate,onCheckedChange:k,disabled:!N&&!e.isPrivate}),t.jsxs("div",{className:"grid gap-1.5 leading-none",children:[t.jsxs(te,{htmlFor:"isPrivate",className:`text-sm font-medium leading-none flex items-center ${!N&&!e.isPrivate?"text-muted-foreground":""}`,children:[t.jsx(ae,{className:"h-3.5 w-3.5 mr-1.5 text-muted-foreground"}),"Make project private"]}),t.jsx("p",{className:"text-xs text-muted-foreground",children:"Private projects are only visible to invited members"})]})]}),!N&&!e.isPrivate&&t.jsxs(at,{variant:"warning",className:"bg-amber-50 text-amber-800 border-amber-200",children:[t.jsx(Yt,{className:"h-4 w-4"}),t.jsx(nt,{children:"Projects with multiple members cannot be made private"})]}),t.jsx("div",{className:"border-t pt-4 mt-2",children:t.jsxs("div",{className:"flex flex-col space-y-2",children:[t.jsx("h3",{className:"text-sm font-medium text-red-600",children:"Danger Zone"}),t.jsx("p",{className:"text-xs text-muted-foreground",children:"Once you delete a project, there is no going back. This action cannot be undone."}),t.jsxs(S,{type:"button",variant:"destructive",className:"mt-2 bg-red-600 hover:bg-red-700",onClick:()=>m(!0),children:[t.jsx(_e,{className:"h-4 w-4 mr-2"})," Delete Project"]})]})})]}),t.jsxs(Mt,{children:[t.jsx(zt,{asChild:!0,children:t.jsx(S,{variant:"outline",type:"button",disabled:c,children:"Cancel"})}),t.jsx(S,{type:"submit",className:"bg-emerald-600 hover:bg-emerald-700",disabled:c,children:c?"Saving...":"Save Changes"})]})]})})]})}function sr(e,r){return`${e} returned \`undefined\`. Seems you forgot to wrap component within ${r}`}function Q(e={}){const{name:r,strict:a=!0,hookName:s="useContext",providerName:n="Provider",errorMessage:o,defaultValue:d}=e,l=u.createContext(d);l.displayName=r;function c(){const v=u.useContext(l);if(!v&&a){const b=new Error(o??sr(s,n));throw b.name="ContextError",Error.captureStackTrace?.(b,c),b}return v}return[l.Provider,c,l]}function ar(e){return e?Array.isArray(e)?e:[e]:[]}function it(e){return e.reduce((r,a)=>Array.isArray(a)?r.concat(it(a)):r.concat(a),[])}var ne=e=>typeof e=="string",Y=e=>typeof e=="function",nr=Function.prototype.toString;nr.call(Object);var ir=e=>e(),ot=(...e)=>(...r)=>{e.forEach(function(a){a?.(...r)})};function lt(e){if(!or(e)||e===void 0)return e;const r=Reflect.ownKeys(e).filter(s=>typeof s=="string"),a={};for(const s of r){const n=e[s];n!==void 0&&(a[s]=lt(n))}return a}var or=e=>e&&typeof e=="object"&&e.constructor===Object;function Ve(...e){e.length===1?e[0]:e[1],e.length===2&&e[0]}function lr(e,r){if(e==null)throw new Error(r())}var ue=e=>typeof e=="object"&&e!==null,T=e=>e?"":void 0,cr=1,dr=9,ur=11,ve=e=>ue(e)&&e.nodeType===cr&&typeof e.nodeName=="string",ct=e=>ue(e)&&e.nodeType===dr,mr=e=>ue(e)&&e===e.window,fr=e=>ue(e)&&e.nodeType!==void 0,dt=e=>fr(e)&&e.nodeType===ur&&"host"in e;function le(e,r){if(!e||!r||!ve(e)||!ve(r))return!1;const a=r.getRootNode?.();if(e===r||e.contains(r))return!0;if(a&&dt(a)){let s=r;for(;s;){if(e===s)return!0;s=s.parentNode||s.host}}return!1}function pr(e){return ct(e)?e:mr(e)?e.document:e?.ownerDocument??document}function ut(e){return dt(e)?ut(e.host):ct(e)?e.defaultView??window:ve(e)?e.ownerDocument?.defaultView??window:window}function hr(e){let r=e.activeElement;for(;r?.shadowRoot;){const a=r.shadowRoot.activeElement;if(a===r)break;r=a}return r}function xr(e){return e.composedPath?.()??e.nativeEvent?.composedPath?.()}function Fe(e){return xr(e)?.[0]??e.target}var We=e=>le(e.currentTarget,Fe(e)),qe=(e,r,a,s)=>{const n=typeof e=="function"?e():e;return n?.addEventListener(r,a,s),()=>{n?.removeEventListener(r,a,s)}};function gr(e){let r;const a=globalThis.requestAnimationFrame(()=>{r=e()});return()=>{globalThis.cancelAnimationFrame(a),r?.()}}var jr={border:"0",clip:"rect(0 0 0 0)",height:"1px",margin:"-1px",overflow:"hidden",padding:"0",position:"absolute",width:"1px",whiteSpace:"nowrap",wordWrap:"normal"},vr=(...e)=>e.map(r=>r?.trim?.()).filter(Boolean).join(" "),Nr=/((?:--)?(?:\w+-?)+)\s*:\s*([^;]*)/g,Ze=e=>{const r={};let a;for(;a=Nr.exec(e);)r[a[1]]=a[2];return r},yr=(e,r)=>{if(ne(e)){if(ne(r))return`${e};${r}`;e=Ze(e)}else ne(r)&&(r=Ze(r));return Object.assign({},e??{},r??{})};function O(...e){let r={};for(let a of e){for(let s in r){if(s.startsWith("on")&&typeof r[s]=="function"&&typeof a[s]=="function"){r[s]=ot(a[s],r[s]);continue}if(s==="className"||s==="class"){r[s]=vr(r[s],a[s]);continue}if(s==="style"){r[s]=yr(r[s],a[s]);continue}r[s]=a[s]!==void 0?a[s]:r[s]}for(let s in a)r[s]===void 0&&(r[s]=a[s])}return r}var G=(e=>(e.NotStarted="Not Started",e.Started="Started",e.Stopped="Stopped",e))(G||{}),fe="__init__";function br(e){const r=()=>e.getRootNode?.()??document,a=()=>pr(r()),s=()=>a().defaultView??window,n=()=>hr(r());return{...e,getRootNode:r,getDoc:a,getWin:s,getActiveElement:n,isActiveElement:l=>l===n(),getById:l=>r().getElementById(l)}}function wr(e){return new Proxy({},{get(r,a){return a==="style"?s=>e({style:s}).style:e}})}var mt=()=>e=>Array.from(new Set(e)),ft=typeof globalThis.document<"u"?u.useLayoutEffect:u.useEffect;function ce(e){const r=e().value??e().defaultValue,a=e().isEqual??Object.is,[s]=u.useState(r),[n,o]=u.useState(s),d=e().value!==void 0,l=u.useRef(n);l.current=d?e().value:n;const c=u.useRef(l.current);ft(()=>{c.current=l.current},[n,e().value]);const v=y=>{const w=c.current,m=Y(y)?y(w):y;e().debug&&console.log(`[bindable > ${e().debug}] setValue`,{next:m,prev:w}),d||o(m),a(m,w)||e().onChange?.(m,w)};function b(){return d?e().value:n}return{initial:s,ref:l,get:b,set(y){(e().sync?we.flushSync:ir)(()=>v(y))},invoke(y,w){e().onChange?.(y,w)},hash(y){return e().hash?.(y)??String(y)}}}ce.cleanup=e=>{u.useEffect(()=>e,[])};ce.ref=e=>{const r=u.useRef(e);return{get:()=>r.current,set:a=>{r.current=a}}};function Fr(e){const r=u.useRef(e);return{get(a){return r.current[a]},set(a,s){r.current[a]=s}}}var Pr=(e,r)=>{const a=u.useRef(!1),s=u.useRef(!1);u.useEffect(()=>{if(a.current&&s.current)return r();s.current=!0},[...(e??[]).map(n=>typeof n=="function"?n():n)]),u.useEffect(()=>(a.current=!0,()=>{a.current=!1}),[])};function Cr(e,r={}){const a=u.useMemo(()=>{const{id:f,ids:j,getRootNode:R}=r;return br({id:f,ids:j,getRootNode:R})},[r]),s=(...f)=>{e.debug&&console.log(...f)},n=e.props?.({props:lt(r),scope:a})??r,o=Er(n),d=e.context?.({prop:o,bindable:ce,scope:a,flush:Ge,getContext(){return c},getComputed(){return k},getRefs(){return F}}),l=pt(d),c={get(f){return l.current?.[f].ref.current},set(f,j){l.current?.[f].set(j)},initial(f){return l.current?.[f].initial},hash(f){const j=l.current?.[f].get();return l.current?.[f].hash(j)}},v=u.useRef(new Map),b=u.useRef(null),y=u.useRef(null),w=u.useRef({type:""}),m=()=>({...w.current,current(){return w.current},previous(){return y.current}}),i=()=>({...I,matches(...f){return f.includes(I.ref.current)},hasTag(f){return!!e.states[I.ref.current]?.tags?.includes(f)}}),F=Fr(e.refs?.({prop:o,context:c})??{}),h=()=>({state:i(),context:c,event:m(),prop:o,send:D,action:g,guard:N,track:Pr,refs:F,computed:k,flush:Ge,scope:a,choose:P}),g=f=>{const j=Y(f)?f(h()):f;if(!j)return;const R=j.map(E=>{const U=e.implementations?.actions?.[E];return U||Ve(`[zag-js] No implementation found for action "${JSON.stringify(E)}"`),U});for(const E of R)E?.(h())},N=f=>Y(f)?f(h()):e.implementations?.guards?.[f](h()),p=f=>{const j=Y(f)?f(h()):f;if(!j)return;const R=j.map(U=>{const z=e.implementations?.effects?.[U];return z||Ve(`[zag-js] No implementation found for effect "${JSON.stringify(U)}"`),z}),E=[];for(const U of R){const z=U?.(h());z&&E.push(z)}return()=>E.forEach(U=>U?.())},P=f=>ar(f).find(j=>{let R=!j.guard;return ne(j.guard)?R=!!N(j.guard):Y(j.guard)&&(R=j.guard(h())),R}),k=f=>{lr(e.computed,()=>"[zag-js] No computed object found on machine");const j=e.computed[f];return j({context:c,event:m(),prop:o,refs:F,scope:a,computed:k})},I=ce(()=>({defaultValue:e.initialState({prop:o}),onChange(f,j){j&&(v.current.get(j)?.(),v.current.delete(j)),j&&g(e.states[j]?.exit),g(b.current?.actions);const R=p(e.states[f]?.effects);if(R&&v.current.set(f,R),j===fe){g(e.entry);const E=p(e.effects);E&&v.current.set(fe,E)}g(e.states[f]?.entry)}})),B=u.useRef(void 0),C=u.useRef(G.NotStarted);ft(()=>{queueMicrotask(()=>{const R=C.current===G.Started;C.current=G.Started,s(R?"rehydrating...":"initializing...");const E=B.current??I.initial;I.invoke(E,R?I.get():fe)});const f=v.current,j=I.ref.current;return()=>{s("unmounting..."),B.current=j,C.current=G.Stopped,f.forEach(R=>R?.()),v.current=new Map,b.current=null,queueMicrotask(()=>{g(e.exit)})}},[]);const x=()=>"ref"in I?I.ref.current:I.get(),D=f=>{queueMicrotask(()=>{if(C.current!==G.Started)return;y.current=w.current,w.current=f,s("send",f);let j=x();const R=e.states[j].on?.[f.type]??e.on?.[f.type],E=P(R);if(!E)return;b.current=E;const U=E.target??j;s("transition",E);const z=U!==j;z?we.flushSync(()=>I.set(U)):E.reenter&&!z?I.invoke(j,j):g(E.actions??[])})};return e.watch?.(h()),{state:i(),send:D,context:c,prop:o,scope:a,refs:F,computed:k,event:m(),getStatus:()=>C.current}}function pt(e){const r=u.useRef(e);return r.current=e,r}function Er(e){const r=pt(e);return function(s){return r.current[s]}}function Ge(e){queueMicrotask(()=>{we.flushSync(()=>e())})}var Ir=wr(e=>e);function Dr(...e){return r=>{const a=[];for(const s of e)if(typeof s=="function"){const n=s(r);typeof n=="function"&&a.push(n)}else s&&(s.current=r);if(a.length)return()=>{for(const s of a)s()}}}function Rr(e){let r=Object.getOwnPropertyDescriptor(e.props,"ref")?.get,a=r&&"isReactWarning"in r&&r.isReactWarning;return a?e.ref:(r=Object.getOwnPropertyDescriptor(e,"ref")?.get,a=r&&"isReactWarning"in r&&r.isReactWarning,a?e.props.ref:e.props.ref||e.ref)}const pe=e=>{const r=u.memo(u.forwardRef((a,s)=>{const{asChild:n,children:o,...d}=a;if(!n)return u.createElement(e,{...d,ref:s},o);const l=u.Children.only(o);if(!u.isValidElement(l))return null;const c=Rr(l);return u.cloneElement(l,{...O(d,l.props),ref:s?Dr(s,c):c})}));return r.displayName=e.displayName||e.name,r},Sr=()=>{const e=new Map;return new Proxy(pe,{apply(r,a,s){return pe(s[0])},get(r,a){const s=a;return e.has(s)||e.set(s,pe(s)),e.get(s)}})},L=Sr(),Pe=()=>(e,r)=>r.reduce((a,s)=>{const[n,o]=a,d=s;return o[d]!==void 0&&(n[d]=o[d]),delete o[d],[n,o]},[{},{...e}]);var ie=(e,r=[])=>({parts:(...a)=>{if(Tr(r))return ie(e,a);throw new Error("createAnatomy().parts(...) should only be called once. Did you mean to use .extendWith(...) ?")},extendWith:(...a)=>ie(e,[...r,...a]),rename:a=>ie(a,r),keys:()=>r,build:()=>[...new Set(r)].reduce((a,s)=>Object.assign(a,{[s]:{selector:[`&[data-scope="${Z(e)}"][data-part="${Z(s)}"]`,`& [data-scope="${Z(e)}"][data-part="${Z(s)}"]`].join(", "),attrs:{"data-scope":Z(e),"data-part":Z(s)}}}),{})}),Z=e=>e.replace(/([A-Z])([A-Z])/g,"$1-$2").replace(/([a-z])([A-Z])/g,"$1-$2").replace(/[\s_]+/g,"-").toLowerCase(),Tr=e=>e.length===0;const[js,kr]=Q({name:"EnvironmentContext",hookName:"useEnvironmentContext",providerName:"<EnvironmentProvider />",strict:!1,defaultValue:{getRootNode:()=>document,getDocument:()=>document,getWindow:()=>window}}),[vs,Or]=Q({name:"LocaleContext",hookName:"useLocaleContext",providerName:"<LocaleProvider />",strict:!1,defaultValue:{dir:"ltr",locale:"en-US"}}),[Ns,ht]=Q({name:"FieldContext",hookName:"useFieldContext",providerName:"<FieldProvider />",strict:!1}),[Ur,M]=Q({name:"FileUploadContext",hookName:"useFileUploadContext",providerName:"<FileUploadProvider />"}),Ar=e=>e.children(M()),xt=u.forwardRef((e,r)=>{const[a,s]=Pe()(e,["disableClick"]),n=M(),o=O(n.getDropzoneProps(a),s);return t.jsx(L.div,{...o,ref:r})});xt.displayName="FileUploadDropzone";const gt=u.forwardRef((e,r)=>{const a=M(),s=O(a.getHiddenInputProps(),e),n=ht();return t.jsx(L.input,{"aria-describedby":n?.ariaDescribedby,...s,ref:r})});gt.displayName="FileUploadHiddenInput";const[Lr,ee]=Q({name:"FileUploadItemPropsContext",hookName:"useFileUploadItemPropsContext",providerName:"<FileUploadItemPropsProvider />"}),jt=u.forwardRef((e,r)=>{const[a,s]=Pe()(e,["file"]),n=M(),o=O(n.getItemProps(a),s);return t.jsx(Lr,{value:a,children:t.jsx(L.li,{...o,ref:r})})});jt.displayName="FileUploadItem";const vt=u.forwardRef((e,r)=>{const a=M(),s=ee(),n=O(a.getItemDeleteTriggerProps(s),e);return t.jsx(L.button,{...n,ref:r})});vt.displayName="FileUploadItemDeleteTrigger";const Nt=u.forwardRef((e,r)=>{const a=M(),s=O(a.getItemGroupProps(),e);return t.jsx(L.ul,{...s,ref:r})});Nt.displayName="FileUploadItemGroup";const yt=u.forwardRef((e,r)=>{const{children:a,...s}=e,n=M(),o=ee(),d=O(n.getItemNameProps(o),s);return t.jsx(L.div,{...d,ref:r,children:a||o.file.name})});yt.displayName="FileUploadItemName";const Ne=u.forwardRef((e,r)=>{const a=M(),s=ee(),n=O(a.getItemPreviewProps(s),e);return s.file.type.match(e.type??".*")?t.jsx(L.div,{...n,ref:r}):null});Ne.displayName="FileUploadItemPreview";const bt=u.forwardRef((e,r)=>{const[a,s]=u.useState(""),n=M(),o=ee(),d=O(n.getItemPreviewImageProps({...o,url:a}),e);return u.useEffect(()=>n.createFileUrl(o.file,l=>s(l)),[o,n]),a?t.jsx(L.img,{...d,ref:r}):null});bt.displayName="FileUploadItemPreviewImage";const wt=u.forwardRef((e,r)=>{const{children:a,...s}=e,n=M(),o=ee(),d=O(n.getItemSizeTextProps(o),s);return t.jsx(L.div,{...d,ref:r,children:a||n.getFileSize(o.file)})});wt.displayName="FileUploadItemSizeText";const Ft=u.forwardRef((e,r)=>{const a=M(),s=O(a.getLabelProps(),e);return t.jsx(L.label,{...s,ref:r})});Ft.displayName="FileUploadLabel";var Mr=e=>typeof e.getAsEntry=="function"?e.getAsEntry():typeof e.webkitGetAsEntry=="function"?e.webkitGetAsEntry():null,Pt=e=>e.isDirectory,Ct=e=>e.isFile,Et=(e,r)=>(Object.defineProperty(e,"relativePath",{value:r?`${r}/${e.name}`:e.name}),e),zr=(e,r)=>Promise.all(Array.from(e).filter(a=>a.kind==="file").map(a=>{const s=Mr(a);if(!s)return null;if(Pt(s)&&r)return It(s.createReader(),`${s.name}`);if(Ct(s))return new Promise(n=>{s.file(o=>{n(Et(o,""))})})}).filter(a=>a)),It=(e,r="")=>new Promise(a=>{const s=[],n=()=>{e.readEntries(o=>{if(o.length===0){a(Promise.all(s).then(l=>l.flat()));return}const d=o.map(l=>{if(!l)return null;if(Pt(l))return It(l.createReader(),`${r}${l.name}`);if(Ct(l))return new Promise(c=>{l.file(v=>{c(Et(v,r))})})}).filter(l=>l);s.push(Promise.all(d)),n()})};n()});function $r(e){return e==="audio/*"||e==="video/*"||e==="image/*"||e==="text/*"||/\w+\/[-+.\w]+/g.test(e)}function _r(e){return/^.*\.[\w]+$/.test(e)}var He=e=>$r(e)||_r(e);function Br(e){if(e!=null)return typeof e=="string"?e:Array.isArray(e)?e.filter(He).join(","):Object.entries(e).reduce((r,[a,s])=>[...r,a,...s],[]).filter(He).join(",")}var Ke=(e,r)=>e.name===r.name&&e.size===r.size&&e.type===r.type,J=e=>e!=null;function Vr(e,r,a){if(J(e.size))if(J(r)&&J(a)){if(e.size>a)return[!1,"FILE_TOO_LARGE"];if(e.size<r)return[!1,"FILE_TOO_SMALL"]}else{if(J(r)&&e.size<r)return[!1,"FILE_TOO_SMALL"];if(J(a)&&e.size>a)return[!1,"FILE_TOO_LARGE"]}return[!0,null]}function Wr(e,r){if(e&&r){const a=Array.isArray(r)?r:typeof r=="string"?r.split(","):[];if(a.length===0)return!0;const s=e.name||"",n=(e.type||"").toLowerCase(),o=n.replace(/\/.*$/,"");return a.some(d=>{const l=d.trim().toLowerCase();return l.charAt(0)==="."?s.toLowerCase().endsWith(l):l.endsWith("/*")?o===l.replace(/\/.*$/,""):n===l})}return!0}function qr(e,r){const a=e.type==="application/x-moz-file"||Wr(e,r);return[a,a?null:"FILE_INVALID_TYPE"]}function Zr(e){const r=new Map;return function(s,n){const o=s+(n?Object.entries(n).sort((l,c)=>l[0]<c[0]?-1:1).join():"");if(r.has(o))return r.get(o);let d=new e(s,n);return r.set(o,d),d}}var Gr=Zr(Intl.NumberFormat);function Hr(e,r,a={}){return Gr(r,a).format(e)}var Kr=["","kilo","mega","giga","tera"],Jr=["","kilo","mega","giga","tera","peta"],Yr=(e,r="en-US",a={})=>{if(isNaN(e))return"";if(e===0)return"0 B";const{unit:s="byte",unitDisplay:n="short"}=a,o=s==="bit"?Kr:Jr,d=Math.max(0,Math.min(Math.floor(Math.log10(e)/3),o.length-1)),l=o[d]+s,c=n||"short",v=parseFloat((e/Math.pow(1e3,d)).toPrecision(3));return Hr(v,r,{style:"unit",unit:l,unitDisplay:c})},Xr=ie("file-upload").parts("root","dropzone","item","itemDeleteTrigger","itemGroup","itemName","itemPreview","itemPreviewImage","itemSizeText","label","trigger","clearTrigger"),A=Xr.build(),Dt=e=>e.ids?.root??`file:${e.id}`,Rt=e=>e.ids?.dropzone??`file:${e.id}:dropzone`,ye=e=>e.ids?.hiddenInput??`file:${e.id}:input`,Qr=e=>e.ids?.trigger??`file:${e.id}:trigger`,es=e=>e.ids?.label??`file:${e.id}:label`,ts=(e,r)=>e.ids?.item?.(r)??`file:${e.id}:item:${r}`,rs=(e,r)=>e.ids?.itemName?.(r)??`file:${e.id}:item-name:${r}`,ss=(e,r)=>e.ids?.itemSizeText?.(r)??`file:${e.id}:item-size:${r}`,as=(e,r)=>e.ids?.itemPreview?.(r)??`file:${e.id}:item-preview:${r}`,ns=e=>e.getById(Dt(e)),Je=e=>e.getById(ye(e)),is=e=>e.getById(Rt(e));function Ye(e){const r=Fe(e);return e.dataTransfer?e.dataTransfer.types.some(a=>a==="Files"||a==="application/x-moz-file"):!!r&&"files"in r}function os(e,r){const{context:a,prop:s,computed:n}=e;return!n("multiple")&&r>1?!1:!n("multiple")&&r+a.get("acceptedFiles").length===2?!0:!(r+a.get("acceptedFiles").length>s("maxFiles"))}function ls(e,r){const{context:a,prop:s,computed:n}=e,o=[],d=[];return r.forEach(l=>{const[c,v]=qr(l,n("acceptAttr")),[b,y]=Vr(l,s("minFileSize"),s("maxFileSize")),w=s("validate")?.(l,{acceptedFiles:a.get("acceptedFiles"),rejectedFiles:a.get("rejectedFiles")}),m=w?w.length===0:!0;if(c&&b&&m)o.push(l);else{const i=[v,y];m||i.push(...w??[]),d.push({file:l,errors:i.filter(Boolean)})}}),os(e,o.length)||(o.forEach(l=>{d.push({file:l,errors:["TOO_MANY_FILES"]})}),o.splice(0)),{acceptedFiles:o,rejectedFiles:d}}function cs(e,r){const a=ut(e);try{if("DataTransfer"in a){const s=new a.DataTransfer;r.forEach(n=>{s.items.add(n)}),e.files=s.files}}catch{}}function ds(e,r){const{state:a,send:s,prop:n,computed:o,scope:d,context:l}=e,c=n("disabled"),v=n("allowDrop"),b=n("translations"),y=a.matches("dragging"),w=a.matches("focused")&&!c;return{dragging:y,focused:w,disabled:!!c,openFilePicker(){c||s({type:"OPEN"})},deleteFile(m){s({type:"FILE.DELETE",file:m})},acceptedFiles:l.get("acceptedFiles"),rejectedFiles:l.get("rejectedFiles"),setFiles(m){const i=m.length;s({type:"FILES.SET",files:m,count:i})},clearRejectedFiles(){s({type:"REJECTED_FILES.CLEAR"})},clearFiles(){s({type:"FILES.CLEAR"})},getFileSize(m){return Yr(m.size,n("locale"))},createFileUrl(m,i){const F=d.getWin(),h=F.URL.createObjectURL(m);return i(h),()=>F.URL.revokeObjectURL(h)},setClipboardFiles(m){if(c)return!1;const F=Array.from(m?.items??[]).reduce((h,g)=>{if(g.kind!=="file")return h;const N=g.getAsFile();return N?[...h,N]:h},[]);return F.length?(s({type:"FILES.SET",files:F}),!0):!1},getRootProps(){return r.element({...A.root.attrs,dir:n("dir"),id:Dt(d),"data-disabled":T(c),"data-dragging":T(y)})},getDropzoneProps(m={}){return r.element({...A.dropzone.attrs,dir:n("dir"),id:Rt(d),tabIndex:c||m.disableClick?void 0:0,role:m.disableClick?"application":"button","aria-label":b.dropzone,"aria-disabled":c,"data-invalid":T(n("invalid")),"data-disabled":T(c),"data-dragging":T(y),onKeyDown(i){c||i.defaultPrevented||We(i)&&(m.disableClick||i.key!=="Enter"&&i.key!==" "||s({type:"DROPZONE.CLICK",src:"keydown"}))},onClick(i){c||i.defaultPrevented||m.disableClick||We(i)&&(i.currentTarget.localName==="label"&&i.preventDefault(),s({type:"DROPZONE.CLICK"}))},onDragOver(i){if(c||!v)return;i.preventDefault(),i.stopPropagation();try{i.dataTransfer.dropEffect="copy"}catch{}if(!Ye(i))return;const h=i.dataTransfer.items.length;s({type:"DROPZONE.DRAG_OVER",count:h})},onDragLeave(i){c||v&&(le(i.currentTarget,i.relatedTarget)||s({type:"DROPZONE.DRAG_LEAVE"}))},onDrop(i){if(c)return;v&&(i.preventDefault(),i.stopPropagation());const F=Ye(i);c||!F||zr(i.dataTransfer.items,n("directory")).then(h=>{s({type:"DROPZONE.DROP",files:it(h)})})},onFocus(){c||s({type:"DROPZONE.FOCUS"})},onBlur(){c||s({type:"DROPZONE.BLUR"})}})},getTriggerProps(){return r.button({...A.trigger.attrs,dir:n("dir"),id:Qr(d),disabled:c,"data-disabled":T(c),"data-invalid":T(n("invalid")),type:"button",onClick(m){c||(le(is(d),m.currentTarget)&&m.stopPropagation(),s({type:"OPEN"}))}})},getHiddenInputProps(){return r.input({id:ye(d),tabIndex:-1,disabled:c,type:"file",required:n("required"),capture:n("capture"),name:n("name"),accept:o("acceptAttr"),webkitdirectory:n("directory")?"":void 0,multiple:o("multiple")||n("maxFiles")>1,onClick(m){m.stopPropagation(),m.currentTarget.value=""},onInput(m){if(c)return;const{files:i}=m.currentTarget;s({type:"FILES.SET",files:i?Array.from(i):[]})},style:jr})},getItemGroupProps(){return r.element({...A.itemGroup.attrs,dir:n("dir"),"data-disabled":T(c)})},getItemProps(m){const{file:i}=m;return r.element({...A.item.attrs,dir:n("dir"),id:ts(d,i.name),"data-disabled":T(c)})},getItemNameProps(m){const{file:i}=m;return r.element({...A.itemName.attrs,dir:n("dir"),id:rs(d,i.name),"data-disabled":T(c)})},getItemSizeTextProps(m){const{file:i}=m;return r.element({...A.itemSizeText.attrs,dir:n("dir"),id:ss(d,i.name),"data-disabled":T(c)})},getItemPreviewProps(m){const{file:i}=m;return r.element({...A.itemPreview.attrs,dir:n("dir"),id:as(d,i.name),"data-disabled":T(c)})},getItemPreviewImageProps(m){const{file:i,url:F}=m;if(!i.type.startsWith("image/"))throw new Error("Preview Image is only supported for image files");return r.img({...A.itemPreviewImage.attrs,alt:b.itemPreview?.(i),src:F,"data-disabled":T(c)})},getItemDeleteTriggerProps(m){const{file:i}=m;return r.button({...A.itemDeleteTrigger.attrs,dir:n("dir"),type:"button",disabled:c,"data-disabled":T(c),"aria-label":b.deleteFile?.(i),onClick(){c||s({type:"FILE.DELETE",file:i})}})},getLabelProps(){return r.label({...A.label.attrs,dir:n("dir"),id:es(d),htmlFor:ye(d),"data-disabled":T(c)})},getClearTriggerProps(){return r.button({...A.clearTrigger.attrs,dir:n("dir"),type:"button",disabled:c,hidden:l.get("acceptedFiles").length===0,"data-disabled":T(c),onClick(m){m.defaultPrevented||c||s({type:"FILES.CLEAR"})}})}}}var us={props({props:e}){return{minFileSize:0,maxFileSize:Number.POSITIVE_INFINITY,maxFiles:1,allowDrop:!0,preventDocumentDrop:!0,...e,translations:{dropzone:"dropzone",itemPreview:r=>`preview of ${r.name}`,deleteFile:r=>`delete file ${r.name}`,...e.translations}}},initialState(){return"idle"},context({prop:e,bindable:r,getContext:a}){return{acceptedFiles:r(()=>({defaultValue:[],isEqual:(s,n)=>s.length===n?.length&&s.every((o,d)=>Ke(o,n[d])),hash(s){return s.map(n=>`${n.name}-${n.size}`).join(",")},onChange(s){const n=a();e("onFileAccept")?.({files:s}),e("onFileChange")?.({acceptedFiles:s,rejectedFiles:n.get("rejectedFiles")})}})),rejectedFiles:r(()=>({defaultValue:[],isEqual:(s,n)=>s.length===n?.length&&s.every((o,d)=>Ke(o.file,n[d].file)),onChange(s){const n=a();e("onFileReject")?.({files:s}),e("onFileChange")?.({acceptedFiles:n.get("acceptedFiles"),rejectedFiles:s})}}))}},computed:{acceptAttr:({prop:e})=>Br(e("accept")),multiple:({prop:e})=>e("maxFiles")>1},watch({track:e,context:r,action:a}){e([()=>r.hash("acceptedFiles")],()=>{a(["syncInputElement"])})},on:{"FILES.SET":{actions:["setFilesFromEvent"]},"FILE.DELETE":{actions:["removeFile"]},"FILES.CLEAR":{actions:["clearFiles"]},"REJECTED_FILES.CLEAR":{actions:["clearRejectedFiles"]}},effects:["preventDocumentDrop"],states:{idle:{on:{OPEN:{actions:["openFilePicker"]},"DROPZONE.CLICK":{actions:["openFilePicker"]},"DROPZONE.FOCUS":{target:"focused"},"DROPZONE.DRAG_OVER":{target:"dragging"}}},focused:{on:{"DROPZONE.BLUR":{target:"idle"},OPEN:{actions:["openFilePicker"]},"DROPZONE.CLICK":{actions:["openFilePicker"]},"DROPZONE.DRAG_OVER":{target:"dragging"}}},dragging:{on:{"DROPZONE.DROP":{target:"idle",actions:["setFilesFromEvent"]},"DROPZONE.DRAG_LEAVE":{target:"idle"}}}},implementations:{effects:{preventDocumentDrop({prop:e,scope:r}){if(!e("preventDocumentDrop")||!e("allowDrop")||e("disabled"))return;const a=r.getDoc(),s=o=>{o?.preventDefault()},n=o=>{le(ns(r),Fe(o))||o.preventDefault()};return ot(qe(a,"dragover",s,!1),qe(a,"drop",n,!1))}},actions:{syncInputElement({scope:e,context:r}){queueMicrotask(()=>{const a=Je(e);if(!a)return;cs(a,r.get("acceptedFiles"));const s=e.getWin();a.dispatchEvent(new s.Event("change",{bubbles:!0}))})},openFilePicker({scope:e}){gr(()=>{Je(e)?.click()})},setFilesFromEvent(e){const{computed:r,context:a,event:s}=e,n=ls(e,s.files),{acceptedFiles:o,rejectedFiles:d}=n;if(r("multiple")){a.set("acceptedFiles",l=>[...l,...o]),a.set("rejectedFiles",d);return}if(o.length){const l=[o[0]];a.set("acceptedFiles",l),a.set("rejectedFiles",d)}else d.length&&(a.set("acceptedFiles",a.get("acceptedFiles")),a.set("rejectedFiles",d))},removeFile({context:e,event:r}){const a=e.get("acceptedFiles").filter(n=>n!==r.file),s=e.get("rejectedFiles").filter(n=>n.file!==r.file);e.set("acceptedFiles",a),e.set("rejectedFiles",s)},clearRejectedFiles({context:e}){e.set("acceptedFiles",e.get("acceptedFiles")),e.set("rejectedFiles",[])},clearFiles({context:e}){e.set("acceptedFiles",[]),e.set("rejectedFiles",[])}}}};mt()(["accept","allowDrop","capture","dir","directory","disabled","getRootNode","id","ids","locale","maxFiles","maxFileSize","minFileSize","name","invalid","onFileAccept","onFileReject","onFileChange","preventDocumentDrop","required","translations","validate"]);mt()(["file"]);const ms=e=>{const r=u.useId(),{getRootNode:a}=kr(),{dir:s,locale:n}=Or(),o=ht(),d={id:r,ids:{label:o?.ids.label,hiddenInput:o?.ids.control},dir:s,disabled:o?.disabled,locale:n,required:o?.required,invalid:o?.invalid,getRootNode:a,...e},l=Cr(us,d);return ds(l,Ir)},St=u.forwardRef((e,r)=>{const[{value:a},s]=Pe()(e,["value"]),n=O(a.getRootProps(),s);return t.jsx(Ur,{value:a,children:t.jsx(L.div,{...n,ref:r})})});St.displayName="FileUploadRootProvider";const be=u.forwardRef((e,r)=>{const a=M(),s=O(a.getTriggerProps(),e);return t.jsx(L.button,{...s,ref:r})});be.displayName="FileUploadTrigger";const Xe=({teamspaceId:e=null,projectId:r=null,chatroomId:a=null,organizationId:s,uploadType:n="DOCUMENT",receiverIds:o=[],onUploadComplete:d,compact:l=!1,files:c=[],className:v=""})=>{const b=ms({maxFiles:10,maxFileSize:52428800}),[y,w]=u.useState(!1),[m,i]=u.useState(!1),F=async g=>{if(g.length){w(!0);try{const N=new FormData,p={teamspaceId:e||null,projectId:r||null,chatroomId:a||null,organizationId:s,uploadType:n};N.append("metadata",JSON.stringify(p)),o.length>0&&N.append("receiverIds",JSON.stringify(o)),g.forEach(I=>{N.append("file",I)});const P=await H().file_management.uploadFilesWithMetadata("POST",N);if(!P.ok)throw new Error(`Upload failed: ${P.statusText}`);const k=await P.json();console.log("Upload successful:",k),d&&d(k),l&&i(!1)}catch(N){console.error("Error uploading files:",N instanceof Error?N.message:String(N))}finally{w(!1)}}},h=g=>{if(g===0)return"0 Bytes";const N=1024,p=["Bytes","KB","MB","GB"],P=Math.floor(Math.log(g)/Math.log(N));return parseFloat((g/Math.pow(N,P)).toFixed(1))+" "+p[P]};return l&&!m?t.jsxs("div",{className:`flex items-center gap-2 ${v}`,children:[t.jsxs("button",{onClick:()=>i(!0),className:"inline-flex items-center gap-1 text-xs px-2 py-1 rounded-md bg-emerald-50 text-emerald-700 hover:bg-emerald-100 transition-colors",children:[t.jsx(me,{size:12}),t.jsx("span",{children:"Upload"})]}),c&&c.length>0&&t.jsxs("div",{className:"text-xs text-muted-foreground",children:[c.length," file",c.length!==1?"s":""]})]}):t.jsx(St,{value:b,children:t.jsxs("div",{className:`relative ${v}`,children:[l&&t.jsx("button",{onClick:()=>i(!1),className:"absolute right-0 top-0 p-1 text-gray-400 hover:text-gray-600 z-10",children:t.jsx(Re,{size:16})}),t.jsxs("div",{className:"space-y-2",children:[!l&&t.jsx(Ft,{className:"block text-sm font-medium text-gray-700",children:"Upload Files"}),t.jsx(xt,{className:`border-2 border-dashed border-gray-300 rounded-lg text-center
            ${l?"p-3":"p-6"} bg-gray-50 hover:bg-gray-100 transition-colors`,children:l?t.jsxs("div",{className:"flex flex-col items-center",children:[t.jsx(me,{className:"h-5 w-5 text-gray-500 mb-1"}),t.jsx(be,{className:"text-xs text-emerald-600 font-medium hover:underline",children:"Choose Files"})]}):t.jsxs(t.Fragment,{children:[t.jsx("p",{className:"text-gray-600 mb-2",children:"Drag your files here"}),t.jsx(be,{className:"py-2 px-4 bg-emerald-600 text-white rounded hover:bg-emerald-700 transition-colors",children:"Choose Files"})]})}),t.jsx(Nt,{children:t.jsx(Ar,{children:g=>t.jsxs(t.Fragment,{children:[g.acceptedFiles.length>0&&t.jsx("div",{className:`space-y-2 mt-2 ${l?"max-h-32 overflow-y-auto":""}`,children:g.acceptedFiles.map(N=>t.jsxs(jt,{file:N,className:"flex items-center p-2 border rounded bg-white",children:[t.jsx(Ne,{type:"image/*",className:"w-8 h-8 mr-2 bg-gray-100 flex items-center justify-center rounded overflow-hidden",children:t.jsx(bt,{className:"max-w-full max-h-full object-cover"})}),t.jsx(Ne,{type:".*",className:"w-8 h-8 mr-2 bg-gray-100 flex items-center justify-center rounded",children:t.jsx(oe,{className:"h-4 w-4 text-gray-500"})}),t.jsxs("div",{className:"flex-1 truncate",children:[t.jsx(yt,{className:"font-medium text-sm truncate"}),t.jsx(wt,{className:"text-xs text-gray-500"})]}),y?t.jsx("div",{className:"animate-pulse text-emerald-500",children:t.jsxs("svg",{className:"animate-spin h-4 w-4",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[t.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),t.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]})}):t.jsx(vt,{className:"text-red-500 hover:text-red-700 p-1",children:t.jsx(Re,{className:"h-4 w-4"})})]},N.name))}),g.acceptedFiles.length>0&&!y&&t.jsxs("button",{onClick:()=>F(g.acceptedFiles),className:`mt-2 py-1.5 px-3 bg-emerald-600 text-white rounded hover:bg-emerald-700 transition-colors
                        flex items-center justify-center gap-1.5 ${l?"text-xs w-full":"w-full"}`,children:[t.jsx(me,{className:`${l?"h-3 w-3":"h-4 w-4"}`}),t.jsxs("span",{children:["Upload ",g.acceptedFiles.length," File",g.acceptedFiles.length!==1?"s":""]})]})]})})})]}),c&&c.length>0&&!l&&t.jsxs("div",{className:"mt-4",children:[t.jsx("h4",{className:"text-sm font-medium mb-2 text-gray-700",children:"Uploaded Files"}),t.jsx("div",{className:"space-y-2 max-h-40 overflow-y-auto pr-1",children:c.map((g,N)=>t.jsxs("div",{className:"flex items-center p-2 border rounded bg-white",children:[t.jsx("div",{className:"w-8 h-8 mr-2 bg-gray-100 flex items-center justify-center rounded",children:t.jsx(oe,{className:"h-4 w-4 text-gray-500"})}),t.jsxs("div",{className:"flex-1 truncate",children:[t.jsx("p",{className:"font-medium text-sm truncate",children:g.name||`File ${N+1}`}),t.jsx("p",{className:"text-xs text-gray-500",children:g.size?h(g.size):"Unknown size"})]}),t.jsx(Xt,{className:"h-4 w-4 text-emerald-500"})]},N))})]}),t.jsx(gt,{})]})})},Qe=e=>{switch(e){case"OWNER":return"bg-green-100 text-green-800 border-green-200";case"ADMIN":return"bg-red-100 text-red-800 border-red-200";case"CONTRIBUTOR":return"bg-blue-100 text-blue-800 border-blue-200";case"VIEWER":return"bg-gray-100 text-gray-800 border-gray-200";default:return"bg-gray-100 text-gray-800 border-gray-200"}};function fs({members:e}){const[r,a]=u.useState(!1),[s,n]=u.useState(!1),o=5,d=e.filter((i,F,h)=>F===h.findIndex(g=>g.user?.id===i.user?.id)),l=d.filter(i=>!i.hasLeft),c=d.filter(i=>i.hasLeft),v=(i,F)=>{const h={OWNER:0,ADMIN:1,CONTRIBUTOR:2,VIEWER:3};return(h[i.role]||4)-(h[F.role]||4)},b=[...l].sort(v),y=[...c].sort(v),w=r?b:b.slice(0,l.length>=o?o:l.length),m=l.length>o&&!r;return t.jsxs("div",{className:"space-y-3",children:[t.jsx("div",{children:w.map(i=>t.jsx("div",{className:"py-1.5",children:t.jsxs("div",{className:"relative flex items-center justify-between group",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(Le,{className:"h-7 w-7",children:i.user?.image?t.jsx("img",{src:i.user.image,alt:i.user?.name||"User"}):t.jsx("div",{className:"bg-gray-200 h-full w-full flex items-center justify-center text-gray-700 text-xs",children:(i.user?.name||"U").charAt(0)})}),t.jsx(he,{children:t.jsxs(xe,{children:[t.jsx(ge,{asChild:!0,children:t.jsx("span",{className:"text-sm font-medium truncate max-w-[120px]",children:i.user?.name||"Unknown User"})}),t.jsxs(je,{children:[t.jsx("p",{children:i.user?.name||"Unknown User"}),t.jsx("p",{className:"text-xs text-muted-foreground",children:i.user?.email})]})]})})]}),t.jsx(Me,{className:Qe(i.role),children:i.role})]})},i.id))}),m&&t.jsx(S,{variant:"ghost",size:"sm",className:"w-full text-xs h-7",onClick:()=>a(!0),children:t.jsxs("span",{className:"flex items-center",children:["Show ",l.length-o," More ",t.jsx(ze,{className:"ml-1 h-3 w-3"})]})}),r&&l.length>o&&t.jsx(S,{variant:"ghost",size:"sm",className:"w-full text-xs h-7",onClick:()=>a(!1),children:t.jsxs("span",{className:"flex items-center",children:["Show Less ",t.jsx($e,{className:"ml-1 h-3 w-3"})]})}),c.length>0&&t.jsxs(Ht,{open:s,onOpenChange:n,className:"mt-3",children:[t.jsxs("div",{className:"flex items-center text-xs text-muted-foreground",children:[t.jsx("div",{className:"h-px bg-border flex-grow mr-2"}),t.jsx(Kt,{asChild:!0,children:t.jsxs("button",{className:"flex items-center gap-1 px-2 py-1 rounded-sm hover:bg-muted/50 transition-colors",children:[t.jsxs("span",{children:["Former Members (",c.length,")"]}),s?t.jsx($e,{className:"h-3 w-3"}):t.jsx(ze,{className:"h-3 w-3"})]})}),t.jsx("div",{className:"h-px bg-border flex-grow ml-2"})]}),t.jsx(Jt,{className:"pt-2",children:t.jsx("div",{className:"space-y-1.5",children:y.map(i=>t.jsx("div",{children:t.jsxs("div",{className:"relative flex items-center justify-between group py-1.5",children:[t.jsx("div",{className:"absolute inset-0 rounded-md bg-muted/30 pointer-events-none"}),t.jsxs("div",{className:"flex items-center gap-2 z-10",children:[t.jsxs("div",{className:"relative",children:[t.jsx(Le,{className:"h-7 w-7",children:i.user?.image?t.jsx("img",{src:i.user.image,alt:i.user?.name||"User",className:"filter grayscale"}):t.jsx("div",{className:"bg-gray-200 h-full w-full flex items-center justify-center text-gray-700 text-xs",children:(i.user?.name||"U").charAt(0)})}),t.jsx("div",{className:"absolute -bottom-1 -right-1 rounded-full w-3 h-3 bg-muted border border-background flex items-center justify-center",children:t.jsx("span",{className:"text-[8px]",children:"Ã—"})})]}),t.jsx(he,{children:t.jsxs(xe,{children:[t.jsx(ge,{asChild:!0,children:t.jsx("span",{className:"text-sm font-medium truncate max-w-[120px] text-muted-foreground",children:i.user?.name||"Unknown User"})}),t.jsxs(je,{children:[t.jsx("p",{children:i.user?.name||"Unknown User"}),t.jsx("p",{className:"text-xs text-muted-foreground",children:i.user?.email}),t.jsx("p",{className:"text-xs text-red-500 mt-1",children:"No longer a member"})]})]})})]}),t.jsx(Me,{className:`${Qe(i.role)} opacity-70`,children:i.role})]})},i.id))})})]})]})}const ys=function(){const{projectId:r}=Se.useParams(),[a,s]=u.useState(!1),[n,o]=u.useState(!0),[d,l]=u.useState(""),[c,v]=u.useState(""),[b,y]=u.useState(!1),[w,m]=u.useState(!1),[i,F]=$t(rt),h=tt(_t),g=Se.useRouteContext(),[N]=u.useState(g.userId),p=i.flatMap(x=>x.projects||[]).find(x=>x.id===r),P=i.find(x=>x.id===p?.teamspaceId);u.useEffect(()=>{p&&o(!1)},[p]);const k=et();if(n)return t.jsxs("div",{className:"flex-1 flex flex-col h-full",children:[t.jsx("div",{className:"h-1.5 bg-gray-200 w-full"}),t.jsxs("div",{className:"p-6 max-w-5xl mx-auto w-full flex-1",children:[t.jsxs("div",{className:"mb-8 relative",children:[t.jsx(_,{className:"h-10 w-60 mb-2"}),t.jsx(_,{className:"h-4 w-full max-w-md mb-4"})]}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[t.jsxs("div",{className:"md:col-span-2 space-y-6",children:[t.jsx("div",{children:t.jsx(_,{className:"h-32 w-full mb-6"})}),t.jsxs("div",{children:[t.jsx("div",{className:"flex justify-between items-center mb-4",children:t.jsx(_,{className:"h-8 w-40"})}),t.jsxs("div",{className:"space-y-3",children:[t.jsx(_,{className:"h-16 w-full"}),t.jsx(_,{className:"h-16 w-full"})]})]})]}),t.jsxs("div",{className:"space-y-6",children:[t.jsx(_,{className:"h-60 w-full"}),t.jsx(_,{className:"h-60 w-full"})]})]})]})]});if(!p)return t.jsxs("div",{className:"flex-1 flex flex-col items-center justify-center p-8 text-center",children:[t.jsx("h2",{className:"text-2xl font-bold mb-4",children:"Project not found"}),t.jsx("p",{className:"text-muted-foreground mb-6",children:"The project you're looking for doesn't exist or you don't have access to it."}),P?t.jsx(S,{variant:"outline",asChild:!0,children:t.jsx(re,{to:"/teamspace/$teamspaceId",params:{teamspaceId:P.id},children:"Back to Teamspace"})}):t.jsx(S,{variant:"outline",asChild:!0,children:t.jsx(re,{to:"/chat",children:"Go to Chat"})})]});const I=async(x="")=>{if(a)return;s(!0);const D=Ae({currentUserId:N,project:p,teamspace:P});try{const{data:f}=await H().chatrooms.createChatroom({chatroomCreatorId:N,chatroomMembers:D,isPrivate:!1,projectId:p.id,name:x.trim()||"New Chat Conversation",teamIds:[],type:"PROJECT_CHATROOM"});p.chatrooms?.push(f),h(f),k({to:"/chat/$chatroomId",params:{chatroomId:f.id}})}catch(f){console.error("Error creating chatroom:",f)}finally{s(!1),m(!1),v("")}},B=async()=>{if(!(!d.trim()||a))try{s(!0);const x=Ae({currentUserId:N,project:p,teamspace:P}),{data:D}=await H().chatrooms.createChatroom({chatroomCreatorId:N,chatroomMembers:x,isPrivate:!1,projectId:p.id,name:"New Chat Conversation",teamIds:[],type:"PROJECT_CHATROOM"});p.chatrooms?.push(D),localStorage.setItem("pendingMessage",d),h(D),k({to:"/chat/$chatroomId",params:{chatroomId:D.id}})}catch(x){console.error("Error starting quick chat:",x),s(!1)}},C=x=>{const D=i.map(f=>f.id===P?.id?{...f,projects:f.projects?.map(j=>j.id===p?.id?x:j)}:f);F(D)};return t.jsxs("div",{className:"flex-1 flex flex-col h-full",children:[t.jsx("div",{className:"h-1.5 bg-emerald-500 w-full flex-shrink-0"}),t.jsxs("div",{className:"p-6 max-w-5xl mx-auto w-full flex-1 overflow-y-auto",children:[t.jsxs("div",{className:"flex items-center text-sm text-muted-foreground mb-4",children:[t.jsxs(re,{to:"/chat",className:"flex items-center hover:text-foreground transition-colors",children:[t.jsx(Zt,{className:"h-3.5 w-3.5 mr-1"}),"Home"]}),P&&t.jsxs(t.Fragment,{children:[t.jsx(Te,{className:"h-3.5 w-3.5 mx-1.5"}),t.jsxs(re,{to:"/teamspace/$teamspaceId",params:{teamspaceId:P.id},className:"flex items-center hover:text-foreground transition-colors",children:[t.jsx(ke,{className:"h-3.5 w-3.5 mr-1.5"}),P.name]})]}),t.jsx(Te,{className:"h-3.5 w-3.5 mx-1.5"}),t.jsxs("span",{className:"font-medium text-foreground flex items-center",children:[t.jsx(Oe,{className:"h-3.5 w-3.5 mr-1.5"}),"Project"]})]}),t.jsxs("div",{className:"mb-8 relative",children:[t.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[t.jsx("div",{className:"flex h-10 w-10 items-center justify-center rounded-lg bg-emerald-100 text-emerald-700",children:t.jsx(Oe,{className:"h-5 w-5"})}),t.jsxs("div",{children:[t.jsx("h1",{className:"text-3xl font-bold",children:p.name}),t.jsxs("div",{className:"flex items-center mt-1",children:[t.jsx("span",{className:"inline-flex items-center rounded-md bg-emerald-50 px-2 py-1 text-xs font-medium text-emerald-700 ring-1 ring-inset ring-emerald-600/20",children:"Project"}),p.isPrivate&&t.jsxs("span",{className:"ml-2 inline-flex items-center rounded-md bg-gray-50 px-2 py-1 text-xs font-medium text-gray-700 ring-1 ring-inset ring-gray-600/20",children:[t.jsx(ae,{className:"h-3 w-3 mr-1"}),"Private"]}),P&&t.jsxs("span",{className:"ml-2 text-sm text-muted-foreground flex items-center",children:[t.jsx(ke,{className:"h-3 w-3 mr-1"}),P.name]})]})]})]}),t.jsx("div",{className:"mt-2",children:t.jsx("p",{className:"text-muted-foreground",children:p.description||"No description provided"})}),t.jsx("div",{className:"absolute top-0 right-0",children:t.jsx(rr,{project:p,userId:N,onProjectUpdated:C})})]}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[t.jsxs("div",{className:"md:col-span-2 space-y-6",children:[t.jsxs(V,{className:"border-b-4 border-b-emerald-500",children:[t.jsxs(W,{className:"pb-3",children:[t.jsx(q,{children:"New chat in this project"}),t.jsx(se,{children:"Start a new conversation in the context of this project"})]}),t.jsx(K,{children:t.jsxs(Bt,{value:d,onChange:x=>l(x.target.value),onSubmit:B,hasMessages:!1,children:[t.jsx(Vt,{placeholder:a?"Creating chat...":"Type a message to start a new chat...",disabled:a,onKeyDown:x=>{x.key==="Enter"&&!x.shiftKey&&(x.preventDefault(),B())}}),t.jsx(Wt,{disabled:a||!d.trim()})]})})]}),t.jsxs("div",{children:[t.jsxs("div",{className:"flex justify-between items-center mb-4",children:[t.jsx("h2",{className:"text-xl font-semibold",children:"Chats in this project"}),w?t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("input",{type:"text",className:"px-3 py-1 border rounded-md text-sm",placeholder:"Chatroom name...",value:c,onChange:x=>v(x.target.value),onKeyDown:x=>{x.key==="Enter"?I(c):x.key==="Escape"&&(m(!1),v(""))},autoFocus:!0}),t.jsx(S,{size:"sm",onClick:()=>I(c),disabled:a,className:"bg-emerald-600 hover:bg-emerald-700 text-white hover:cursor-pointer",children:"Create"}),t.jsx(S,{size:"sm",variant:"ghost",onClick:()=>{m(!1),v("")},className:"hover:cursor-pointer",children:"Cancel"})]}):t.jsxs(S,{size:"sm",onClick:()=>m(!0),disabled:a,className:"bg-emerald-600 hover:bg-emerald-700 text-white hover:cursor-pointer",children:[t.jsx(Be,{className:"h-4 w-4 mr-2"})," New Chat"]})]}),p.chatrooms&&p.chatrooms.length>0?t.jsx("div",{className:"space-y-3",children:p.chatrooms.map(x=>t.jsx(V,{className:de("cursor-pointer transition-all border-l-4 border-l-transparent","hover:shadow-md hover:border-l-emerald-500 hover:bg-muted/30"),onClick:()=>{h(x),k({to:"/chat"})},children:t.jsx(W,{className:"py-3",children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs(q,{className:"text-base flex items-center",children:[t.jsx(Qt,{className:"h-4 w-4 mr-2"}),x.name,x.isPrivate&&t.jsx(he,{children:t.jsxs(xe,{children:[t.jsx(ge,{asChild:!0,children:t.jsx("span",{children:t.jsx(ae,{className:"h-3 w-3 ml-2 text-red-500"})})}),t.jsx(je,{children:t.jsx("p",{children:"Private"})})]})})]}),t.jsx("div",{className:"flex items-center gap-3 text-muted-foreground text-xs",children:t.jsxs("div",{className:"flex items-center",children:[t.jsx(Ue,{className:"h-3 w-3 mr-1"}),x.members?.length||1]})})]})})},x.id))}):t.jsxs("div",{className:"border rounded-lg p-8 text-center bg-muted/20",children:[t.jsx("h3",{className:"font-medium mb-2",children:"No chats yet"}),t.jsx("p",{className:"text-muted-foreground mb-4",children:"Start by creating your first chat in this project"}),t.jsxs(S,{variant:"outline",onClick:()=>m(!0),className:"border-emerald-600/20 text-emerald-700 hover:bg-emerald-50",children:[t.jsx(Be,{className:"h-4 w-4 mr-2"})," Create Chat"]})]})]})]}),t.jsxs("div",{className:"space-y-6",children:[t.jsxs(V,{className:"border-t-4 border-t-emerald-500",children:[t.jsxs(W,{children:[t.jsxs(q,{className:"flex items-center justify-between",children:[t.jsx("span",{children:"Project Context"}),t.jsx(S,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0 hover:cursor-pointer",onClick:()=>y(!b),children:t.jsx(st,{className:"h-4 w-4"})})]}),t.jsx(se,{children:"Information about this project's purpose"})]}),t.jsx(K,{children:b?t.jsxs("div",{className:"space-y-4",children:[t.jsx("textarea",{className:"w-full min-h-[150px] p-3 border rounded-md",placeholder:"Describe what this teamspace is used for...",value:p.context}),t.jsxs("div",{className:"flex justify-end space-x-2",children:[t.jsx(S,{variant:"outline",size:"sm",onClick:()=>y(!1),children:"Cancel"}),t.jsx(S,{size:"sm",onClick:()=>y(!1),children:"Save"})]})]}):t.jsx("div",{className:"text-sm",children:t.jsx("p",{children:p.context})})})]}),t.jsxs(V,{className:"border-t-4 border-t-emerald-500",children:[t.jsxs(W,{children:[t.jsx(q,{children:"Members"}),t.jsx(se,{children:"People with access to this project"})]}),t.jsx(K,{children:p.members&&p.members.length>0?t.jsx(fs,{members:p.members}):t.jsx("div",{className:"text-sm text-muted-foreground",children:"Only you have access to this project"})}),t.jsx(qt,{children:t.jsx(Gt,{type:"project",projectId:p.id,teamspaceId:p.teamspaceId,members:p.members||[],userId:N,onMembersChanged:()=>{H().chatrooms.getTeamspaces().then(({data:x})=>{x&&F(x)})},children:t.jsxs(S,{size:"sm",variant:"outline",className:"w-full border-emerald-600/20 text-emerald-700 hover:bg-emerald-50 hover:cursor-pointer",children:[t.jsx(Ue,{className:"h-4 w-4 mr-2"})," Manage Members"]})})})]}),t.jsxs(V,{className:"border-t-4 border-t-emerald-500",children:[t.jsx(W,{children:t.jsx(q,{children:"Project Stats"})}),t.jsx(K,{children:t.jsxs("div",{className:"space-y-2",children:[t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{className:"text-muted-foreground",children:"Chats"}),t.jsx("span",{className:"font-medium",children:p.chatrooms?.length||0})]}),t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{className:"text-muted-foreground",children:"Members"}),t.jsx("span",{className:"font-medium",children:p.members?.length||1})]}),t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{className:"text-muted-foreground",children:"Files"}),t.jsx("span",{className:"font-medium",children:p.files?.length||0})]}),t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{className:"text-muted-foreground",children:"Created"}),t.jsx("span",{className:"font-medium",children:new Date(p.createdAt).toLocaleDateString()})]}),p.isPrivate&&t.jsxs("div",{className:"flex justify-between items-center pt-2 mt-2 border-t",children:[t.jsxs("span",{className:"text-muted-foreground flex items-center",children:[t.jsx(ae,{className:"h-3.5 w-3.5 mr-1.5 text-red-500"}),"Visibility"]}),t.jsx("span",{className:"font-medium text-sm bg-gray-100 px-2 py-0.5 rounded",children:"Private"})]})]})})]}),t.jsxs(V,{className:"border-t-4 border-t-emerald-500",children:[t.jsxs(W,{className:"pb-2",children:[t.jsxs(q,{className:"flex items-center justify-between",children:[t.jsx("span",{children:"Project Files"}),t.jsx(Xe,{teamspaceId:P?.id,projectId:p.id,organizationId:g.session?.activeOrganizationId||void 0,compact:!0,files:p.files||[],className:"ml-auto"})]}),t.jsx(se,{children:"Upload and manage files for this project"})]}),t.jsx(K,{children:p.files&&p.files.length>0?t.jsx("div",{className:"space-y-2 max-h-64 overflow-y-auto pr-1",children:p.files.map((x,D)=>t.jsxs("div",{className:"flex items-center p-2 border rounded bg-white hover:bg-gray-50 transition-colors",children:[t.jsx("div",{className:"w-8 h-8 mr-2 bg-gray-100 flex items-center justify-center rounded",children:t.jsx(oe,{className:"h-4 w-4 text-gray-500"})}),t.jsxs("div",{className:"flex-1 truncate",children:[t.jsx("p",{className:"font-medium text-sm truncate",children:x.fileName||`File ${D+1}`}),t.jsx("p",{className:"text-xs text-muted-foreground",children:new Date(x.createdAt).toLocaleDateString()})]})]},D))}):t.jsxs("div",{className:"text-center py-6 bg-muted/20 rounded-lg border border-dashed",children:[t.jsx(oe,{className:"h-8 w-8 mx-auto text-muted-foreground mb-2"}),t.jsx("p",{className:"text-sm text-muted-foreground mb-3",children:"No files uploaded yet"}),t.jsx(Xe,{projectId:p.id,organizationId:g.session?.activeOrganizationId||void 0,compact:!0})]})})]})]})]})]})]})};export{ys as component};
