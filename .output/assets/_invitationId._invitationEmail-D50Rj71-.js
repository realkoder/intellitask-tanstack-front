import{y as j,z as f,r as d,u as v,D as p,j as e,C as N,a as w,b as y,c as C,d as b,w as z,X as u,h as S,B as a,k as r,E as m,F as k}from"./client-LSARlrfQ.js";const T=function(){const{data:o}=j(),{invitationId:c,invitationEmail:s}=f.useParams(),[t,i]=d.useState("initial"),n=v(),x=p(),h=t==="loading"?"Processing your invitation...":t==="success"?"Your invitation has been accepted!":t==="error"?"There was a problem with your invitation":"";d.useEffect(()=>{if(!s||!c){n({to:"/sign-in",reloadDocument:!0});return}},[]);const g=async()=>{if(i("loading"),!o?.user.id){localStorage.setItem("invitationEmail",s),r.error("You have to sign in before we can make you join an organization"),i("must-signin");return}if(o.user.email!==s){r.error(`You must sign in using the email: ${s}`),localStorage.setItem("invitationEmail",s),i("must-change-account");return}const{data:l,error:E}=await m.acceptInvitation({invitationId:c});l?.invitation?(r.info("You have joined the organization"),i("success"),await m.setActive({organizationId:l?.member.organizationId}),await k({query:{disableCookieCache:!0}}),setTimeout(()=>n({to:"/chat"}),1e3)):i("error")};return e.jsx("div",{className:"flex min-h-screen items-center justify-center bg-muted/40 p-4",children:e.jsxs(N,{className:"mx-auto max-w-md w-full",children:[e.jsxs(w,{className:"text-center",children:[e.jsx(y,{className:"text-xl",children:"Organization Invitation"}),e.jsx(C,{className:`${t==="error"?" text-destructive":""}`,children:h})]}),e.jsx(b,{className:"flex justify-center",children:t==="initial"?e.jsx("div",{children:e.jsx("p",{className:"font-medium",children:"You have been invited to join an organization"})}):t==="loading"?e.jsxs("div",{className:"flex flex-col items-center gap-4",children:[e.jsx("div",{className:"h-12 w-12 rounded-full border-4 border-primary/30 border-t-primary animate-spin"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Please wait while we process your invitation"})]}):t==="success"?e.jsxs("div",{className:"flex flex-col items-center gap-4 text-center",children:[e.jsx("div",{className:"h-12 w-12 rounded-full bg-green-100 flex items-center justify-center",children:e.jsx(z,{className:"h-6 w-6 text-green-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:"You have successfully joined the organization"}),e.jsx("p",{className:"mt-1 text-sm text-muted-foreground",children:"You now have access to all resources shared with you"})]})]}):t==="error"?e.jsxs("div",{className:"flex flex-col items-center gap-4 text-center",children:[e.jsx("div",{className:"h-12 w-12 rounded-full bg-red-100 flex items-center justify-center",children:e.jsx(u,{className:"h-6 w-6 text-red-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:"This invitation is invalid or has expired"}),e.jsx("p",{className:"mt-1 text-sm text-muted-foreground",children:"Please contact your organization admin for a new invitation"})]})]}):e.jsxs("div",{className:"flex flex-col items-center gap-4 text-center",children:[e.jsx("div",{className:"h-12 w-12 rounded-full bg-red-100 flex items-center justify-center",children:e.jsx(u,{className:"h-6 w-6 text-red-600"})}),e.jsx("div",{children:e.jsx("p",{className:"font-medium",children:"This invitation could not be accepted you have to sign in or switch your account"})})]})}),e.jsx(S,{className:"flex justify-center",children:t==="initial"?e.jsx(a,{onClick:()=>g(),children:"Accept invitation"}):t==="error"?e.jsx(a,{onClick:()=>n({to:"/sign-up"}),children:"Return to Home"}):t==="must-signin"?e.jsx(a,{onClick:()=>n({to:"/sign-in"}),children:"sign me in"}):t==="must-change-account"?e.jsx(a,{onClick:()=>x(),children:"switch account"}):e.jsx(e.Fragment,{})})]})})};export{T as component};
