import{r as n,u as C,j as e,C as S,a as b,b as c,c as I,d as o,I as L,e as O,f as t,g as j,h as P,B as p,L as g,i as T,s as V,k as d,R}from"./client-LSARlrfQ.js";const E=({emailReqParam:x})=>{const[a,r]=n.useState(""),[i,v]=n.useState(x),[l,y]=n.useState(""),[m,u]=n.useState(!1),h=a.length===6&&/^\d{6}$/.test(a)&&i.length>3&&l.length>7,f=C(),N=async()=>{u(!0);const{data:s}=await T.verifyEmail({email:i,otp:a});if(s?.user.id){const{data:w}=await V.email({email:i,password:l,rememberMe:!0});w?.user.id?(d.info("You have been verified"),setTimeout(()=>f({to:"/chat"}),1e3)):(d.info("You have been verified - sign in"),setTimeout(()=>f({to:"/sign-in"}),1e3))}else d.info("Something went wrong - try verifying again");u(!1)};return e.jsxs("div",{className:"flex flex-col items-center mt-20 text-center text-sm ",children:[e.jsxs("div",{className:"flex flex-col sm:w-[40%] w-full items-center gap-y-2 mb-6",children:[e.jsx("h3",{children:"You must be verified to create an organization."}),e.jsx("p",{className:"text-gray-500",children:"Please verify your account to proceed."})]}),e.jsxs(S,{className:"w-full max-w-lg",children:[e.jsxs(b,{children:[e.jsx(c,{children:"Verification Required"}),e.jsx(I,{children:"Please enter the 6-character code sent to your email"})]}),e.jsx(o,{className:"flex flex-col items-center",children:e.jsx("div",{className:"space-y-2",children:e.jsx(L,{maxLength:6,value:a,onChange:s=>r(s),children:e.jsxs(O,{children:[e.jsx(t,{index:0}),e.jsx(t,{index:1}),e.jsx(t,{index:2}),e.jsx(t,{index:3}),e.jsx(t,{index:4}),e.jsx(t,{index:5})]})})})}),e.jsx(o,{className:"flex flex-col items-center text-left",children:e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{children:"Email"}),e.jsx(j,{id:"email",type:"email",value:i,onChange:s=>v(s.target.value.toLowerCase()),required:!0})]})}),e.jsx(o,{className:"flex flex-col items-center text-left",children:e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{children:"Your password"}),e.jsx(j,{id:"password",type:"password",minLength:8,value:l,onChange:s=>y(s.target.value),required:!0})]})}),e.jsxs(P,{className:"flex flex-col",children:[e.jsxs("div",{className:"flex justify-center gap-x-6",children:[e.jsx(p,{disabled:m||!h,onClick:()=>N(),children:m?"Verifying...":"Verify"}),e.jsx(p,{variant:"outline",onClick:()=>window.location.reload(),children:"Cancel"})]}),e.jsxs("div",{className:"mt-6 mb-2",children:[e.jsxs("span",{className:"text-gray-500",children:["Don't have an account?"," "]}),e.jsx(g,{to:"/sign-up",className:"text-primary hover:underline ml-0.5",children:"Sign up"})]}),e.jsxs("div",{children:[e.jsxs("span",{className:"text-gray-500",children:["Already verified?"," "]}),e.jsx(g,{to:"/sign-in",viewTransition:!0,className:"text-primary hover:underline ml-0.5",children:"Sign in"})]})]})]})]})},q=function(){const a=R.useSearch({select:r=>r.email});return e.jsx(E,{emailReqParam:a})};export{q as component};
