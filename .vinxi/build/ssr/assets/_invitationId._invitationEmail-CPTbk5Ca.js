import{jsx as e,jsxs as i,Fragment as g}from"react/jsx-runtime";import{useNavigate as v}from"@tanstack/react-router";import{H as x,a5 as N,C as w,a as y,b as C,c as b,d as j,h as z,B as a,a6 as d,a7 as S}from"./ssr-D494T9bW.js";import{useState as I,useEffect as k}from"react";import{Check as Y,X as u}from"lucide-react";import{toast as s}from"sonner";import{u as T}from"./useSignOut-DrUzyn0C.js";import"jotai";import"@vercel/analytics";import"@tanstack/router-core";import"@tanstack/start-client-core";import"@tanstack/start-server-core";import"zod";import"@radix-ui/react-slot";import"class-variance-authority";import"clsx";import"tailwind-merge";import"@radix-ui/react-label";import"better-auth/react";import"better-auth/client/plugins";import"input-otp";import"@radix-ui/react-select";import"@radix-ui/react-tooltip";import"@radix-ui/react-radio-group";import"@radix-ui/react-scroll-area";import"framer-motion";import"motion/react";import"@radix-ui/react-dropdown-menu";import"uuid";import"marked";import"react-markdown";import"remark-gfm";import"@radix-ui/react-hover-card";import"qss";import"@radix-ui/react-dialog";import"tiny-invariant";import"node:stream";import"isbot";import"react-dom/server";const ve=function(){const{data:c}=x(),{invitationId:m,invitationEmail:n}=N.useParams(),[t,r]=I("initial"),o=v(),p=T(),h=t==="loading"?"Processing your invitation...":t==="success"?"Your invitation has been accepted!":t==="error"?"There was a problem with your invitation":"";k(()=>{if(!n||!m){o({to:"/sign-in",reloadDocument:!0});return}},[]);const f=async()=>{if(r("loading"),!c?.user.id){localStorage.setItem("invitationEmail",n),s.error("You have to sign in before we can make you join an organization"),r("must-signin");return}if(c.user.email!==n){s.error(`You must sign in using the email: ${n}`),localStorage.setItem("invitationEmail",n),r("must-change-account");return}const{data:l}=await d.acceptInvitation({invitationId:m});l?.invitation?(s.info("You have joined the organization"),r("success"),await d.setActive({organizationId:l?.member.organizationId}),await S({query:{disableCookieCache:!0}}),setTimeout(()=>o({to:"/chat"}),1e3)):r("error")};return e("div",{className:"flex min-h-screen items-center justify-center bg-muted/40 p-4",children:i(w,{className:"mx-auto max-w-md w-full",children:[i(y,{className:"text-center",children:[e(C,{className:"text-xl",children:"Organization Invitation"}),e(b,{className:`${t==="error"?" text-destructive":""}`,children:h})]}),e(j,{className:"flex justify-center",children:t==="initial"?e("div",{children:e("p",{className:"font-medium",children:"You have been invited to join an organization"})}):t==="loading"?i("div",{className:"flex flex-col items-center gap-4",children:[e("div",{className:"h-12 w-12 rounded-full border-4 border-primary/30 border-t-primary animate-spin"}),e("p",{className:"text-sm text-muted-foreground",children:"Please wait while we process your invitation"})]}):t==="success"?i("div",{className:"flex flex-col items-center gap-4 text-center",children:[e("div",{className:"h-12 w-12 rounded-full bg-green-100 flex items-center justify-center",children:e(Y,{className:"h-6 w-6 text-green-600"})}),i("div",{children:[e("p",{className:"font-medium",children:"You have successfully joined the organization"}),e("p",{className:"mt-1 text-sm text-muted-foreground",children:"You now have access to all resources shared with you"})]})]}):t==="error"?i("div",{className:"flex flex-col items-center gap-4 text-center",children:[e("div",{className:"h-12 w-12 rounded-full bg-red-100 flex items-center justify-center",children:e(u,{className:"h-6 w-6 text-red-600"})}),i("div",{children:[e("p",{className:"font-medium",children:"This invitation is invalid or has expired"}),e("p",{className:"mt-1 text-sm text-muted-foreground",children:"Please contact your organization admin for a new invitation"})]})]}):i("div",{className:"flex flex-col items-center gap-4 text-center",children:[e("div",{className:"h-12 w-12 rounded-full bg-red-100 flex items-center justify-center",children:e(u,{className:"h-6 w-6 text-red-600"})}),e("div",{children:e("p",{className:"font-medium",children:"This invitation could not be accepted you have to sign in or switch your account"})})]})}),e(z,{className:"flex justify-center",children:t==="initial"?e(a,{onClick:()=>f(),children:"Accept invitation"}):t==="error"?e(a,{onClick:()=>o({to:"/sign-up"}),children:"Return to Home"}):t==="must-signin"?e(a,{onClick:()=>o({to:"/sign-in"}),children:"sign me in"}):t==="must-change-account"?e(a,{onClick:()=>p(),children:"switch account"}):e(g,{})})]})})};export{ve as component};
