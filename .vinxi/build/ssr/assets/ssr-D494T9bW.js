import{RouterProvider as Ga,useRouter as Ba,ErrorComponent as Ha,Link as J,createRootRoute as Va,Outlet as Wa,HeadContent as qa,Scripts as Ja,createFileRoute as B,lazyRouteComponent as ae,redirect as we,useNavigate as Ce,createRouter as Ka}from"@tanstack/react-router";import{jsx as t,jsxs as i,Fragment as ge}from"react/jsx-runtime";import{Provider as Xa,atom as X,useAtom as wt,useAtomValue as qe,useSetAtom as Qe}from"jotai";import{Toaster as Ya,toast as G}from"sonner";import{inject as Qa}from"@vercel/analytics";import{isPlainObject as Za,encode as en,isRedirect as tn,isNotFound as an}from"@tanstack/router-core";import{startSerializer as he,mergeHeaders as jt,createServerFn as Ie}from"@tanstack/start-client-core";import{defineHandlerCallback as nn,transformReadableStreamWithRouter as rn,transformPipeableStreamWithRouter as sn,getHeaders as on,getEvent as cn,createStartHandler as ln}from"@tanstack/start-server-core";import{z as K}from"zod";import*as F from"react";import Z,{useState as x,useEffect as D,useRef as L,memo as De,useCallback as me,useLayoutEffect as dn,createContext as un,useContext as Vt,forwardRef as mn,useMemo as Ze,Suspense as hn,isValidElement as pn}from"react";import{Slot as fn}from"@radix-ui/react-slot";import{cva as Te}from"class-variance-authority";import{clsx as gn}from"clsx";import{twMerge as yn}from"tailwind-merge";import*as vn from"@radix-ui/react-label";import{createAuthClient as bn}from"better-auth/react";import{organizationClient as wn,adminClient as xn,emailOTPClient as Nn}from"better-auth/client/plugins";import{Minus as Cn,Mail as et,ArrowLeft as Mt,Check as Ue,X as Wt,Upload as In,ChevronDown as Fe,ChevronUp as Tn,UserPlus as Sn,Circle as kn,Info as Pn,Users as An,Bell as Rn,ExternalLink as En,ChevronRight as qt,Folder as _n,FileText as On,ChevronRightIcon as jn,CheckIcon as Mn,Split as $n,ArrowUpIcon as zn,AudioLines as Ln,BrainCircuit as tt,Bot as Dn,Star as Un,Settings as Fn,Globe as Gn,Telescope as Bn,SparklesIcon as $e,UserIcon as ze,XIcon as Hn,Smile as Vn,MessageSquare as Wn,Edit as qn,MessageSquareIcon as Jn}from"lucide-react";import{OTPInput as Kn,OTPInputContext as Xn}from"input-otp";import*as U from"@radix-ui/react-select";import*as pe from"@radix-ui/react-tooltip";import*as xe from"@radix-ui/react-radio-group";import*as le from"@radix-ui/react-scroll-area";import{AnimatePresence as Yn,motion as Qn}from"framer-motion";import{animate as Zn,useMotionValue as er,useSpring as tr,AnimatePresence as ar,motion as nr}from"motion/react";import*as V from"@radix-ui/react-dropdown-menu";import{v4 as Jt}from"uuid";import{marked as rr}from"marked";import sr from"react-markdown";import or from"remark-gfm";import*as Je from"@radix-ui/react-hover-card";import{encode as ir}from"qss";import*as oe from"@radix-ui/react-dialog";import cr from"tiny-invariant";import{PassThrough as lr}from"node:stream";import{isbot as $t}from"isbot";import Ae from"react-dom/server";function zt(e){return t(Ga,{router:e.router})}const dr=nn(async({request:e,router:n,responseHeaders:r})=>{if(typeof Ae.renderToReadableStream=="function"){const a=await Ae.renderToReadableStream(t(zt,{router:n}),{signal:e.signal});$t(e.headers.get("User-Agent"))&&await a.allReady;const s=rn(n,a);return new Response(s,{status:n.state.statusCode,headers:r})}if(typeof Ae.renderToPipeableStream=="function"){const a=new lr;try{const o=Ae.renderToPipeableStream(t(zt,{router:n}),{...$t(e.headers.get("User-Agent"))?{onAllReady(){o.pipe(a)}}:{onShellReady(){o.pipe(a)}},onError:(c,l)=>{console.error("Error in renderToPipeableStream:",c,l)}})}catch(o){console.error("Error in renderToPipeableStream:",o)}const s=sn(n,a);return new Response(s,{status:n.state.statusCode,headers:r})}throw new Error("No renderToReadableStream or renderToPipeableStream found in react-dom/server. Ensure you are using a version of react-dom that supports streaming.")}),ur=()=>({routes:{__root__:{filePath:"__root.tsx",children:["/","/_authed","/create-organization","/forgot-password","/sign-in","/sign-up","/verify-account","/accept-invitation/$invitationId/$invitationEmail"],preloads:["/_build/assets/client-DUcPGb69.js","/_build/assets/client-CMvCw2jp.js"]},"/":{filePath:"index.tsx"},"/_authed":{filePath:"_authed.tsx",children:["/_authed/_layout"]},"/create-organization":{filePath:"create-organization.tsx"},"/forgot-password":{filePath:"forgot-password.tsx"},"/sign-in":{filePath:"sign-in.tsx"},"/sign-up":{filePath:"sign-up.tsx"},"/verify-account":{filePath:"verify-account.tsx"},"/_authed/_layout":{filePath:"_authed/_layout.tsx",parent:"/_authed",children:["/_authed/_layout/chat/$chatroomId","/_authed/_layout/project/$projectId","/_authed/_layout/teamspace/$teamspaceId","/_authed/_layout/chat/","/_authed/_layout/members/","/_authed/_layout/organization-settings/","/_authed/_layout/organizations/","/_authed/_layout/team-chat/"]},"/accept-invitation/$invitationId/$invitationEmail":{filePath:"accept-invitation/$invitationId.$invitationEmail.tsx"},"/_authed/_layout/chat/$chatroomId":{filePath:"_authed/_layout/chat/$chatroomId.tsx",parent:"/_authed/_layout"},"/_authed/_layout/project/$projectId":{filePath:"_authed/_layout/project/$projectId.tsx",parent:"/_authed/_layout"},"/_authed/_layout/teamspace/$teamspaceId":{filePath:"_authed/_layout/teamspace/$teamspaceId.tsx",parent:"/_authed/_layout"},"/_authed/_layout/chat/":{filePath:"_authed/_layout/chat/index.tsx",parent:"/_authed/_layout"},"/_authed/_layout/members/":{filePath:"_authed/_layout/members/index.tsx",parent:"/_authed/_layout"},"/_authed/_layout/organization-settings/":{filePath:"_authed/_layout/organization-settings/index.tsx",parent:"/_authed/_layout"},"/_authed/_layout/organizations/":{filePath:"_authed/_layout/organizations/index.tsx",parent:"/_authed/_layout"},"/_authed/_layout/team-chat/":{filePath:"_authed/_layout/team-chat/index.tsx",parent:"/_authed/_layout"}}});function mr(e){return globalThis.MANIFEST[e]}function hr(){const e=ur(),n=e.routes.__root__=e.routes.__root__||{};n.assets=n.assets||[];let r="";const a=mr("client"),s=a.inputs[a.handler]?.output.path;return s||cr(s,"Could not find client entry in vinxi manifest"),n.assets.push({tag:"script",attrs:{type:"module",suppressHydrationWarning:!0,async:!0},children:`${r}import("${s}")`}),e}function pr(){const e=hr();return{...e,routes:Object.fromEntries(Object.entries(e.routes).map(([n,r])=>{const{preloads:a,assets:s}=r;return[n,{preloads:a,assets:s}]}))}}async function fr(e,n,r){var a;const s=n[0];if(Za(s)&&s.method){const l=s,p=l.data instanceof FormData?"formData":"payload",m=new Headers({...p==="payload"?{"content-type":"application/json",accept:"application/json"}:{},...l.headers instanceof Headers?Object.fromEntries(l.headers.entries()):l.headers});if(l.method==="GET"){const h=en({payload:he.stringify({data:l.data,context:l.context})});h&&(e.includes("?")?e+=`&${h}`:e+=`?${h}`)}e.includes("?")?e+="&createServerFn":e+="?createServerFn",l.response==="raw"&&(e+="&raw");const f=await r(e,{method:l.method,headers:m,signal:l.signal,...gr(l)}),d=await Lt(f);if((a=d.headers.get("content-type"))!=null&&a.includes("application/json")){const h=he.decode(await d.json());if(tn(h)||an(h)||h instanceof Error)throw h;return h}return d}const o=await Lt(await r(e,{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(n)})),c=o.headers.get("content-type");return c&&c.includes("application/json")?he.decode(await o.json()):o.text()}function gr(e){return e.method==="POST"?e.data instanceof FormData?(e.data.set("__TSR_CONTEXT",he.stringify(e.context)),{body:e.data}):{body:he.stringify({data:e.data??null,context:e.context})}:{}}async function Lt(e){if(!e.ok){const n=e.headers.get("content-type");throw n&&n.includes("application/json")?he.decode(await e.json()):new Error(await e.text())}return e}function yr(e){return e.replace(/^\/|\/$/g,"")}const Se=(e,n)=>{const r=`/${yr(n)}/${e}`;return Object.assign((...s)=>fr(r,s,async(o,c)=>{c.headers=jt(on(),c.headers);const l=await $fetch.native(o,c),p=cn(),m=jt(l.headers,p.___ssrRpcResponseHeaders);return p.___ssrRpcResponseHeaders=m,l}),{url:r,functionId:e})},vr="/_build/assets/app-Cs9mLtrU.css",br="/_build/assets/index-BCQOL4kc.css";function Kt({error:e}){const n=Ba();return console.error(e),i("div",{className:"min-w-0 flex-1 p-4 flex flex-col items-center justify-center gap-6",children:[t(Ha,{error:e}),i("div",{className:"flex gap-2 items-center flex-wrap",children:[t("button",{onClick:()=>{n.invalidate()},className:"px-2 py-1 bg-gray-600 dark:bg-gray-700 rounded text-white uppercase font-extrabold hover:cursor-pointer hover:bg-gray-700 dark:hover:bg-gray-600",children:"Try Again"}),t(J,{to:"/",className:"px-2 py-1 bg-gray-600 dark:bg-gray-700 rounded text-white uppercase font-extrabold hover:cursor-pointer hover:bg-gray-700 dark:hover:bg-gray-600",children:"Home"})]})]})}function Xt({children:e}){return i("div",{className:"space-y-2 p-2 w-screen flex flex-col items-center justify-center min-h-screen",children:[t("div",{className:"text-gray-600 dark:text-gray-400",children:e||t("p",{children:"The page you are looking for does not exist."})}),i("p",{className:"flex items-center gap-2 flex-wrap",children:[t("button",{onClick:()=>window.history.back(),className:"bg-emerald-500 text-white px-2 py-1 rounded uppercase font-black text-sm hover:cursor-pointer hover:bg-emerald-600",children:"Go back"}),t(J,{to:"/",className:"bg-cyan-600 text-white px-2 py-1 rounded uppercase font-black text-sm hover:cursor-pointer hover:bg-cyan-700",children:"Start Over"})]})]})}const wr=Se("app_routes_root_tsx--fetchBetterAuth_createServerFn_handler","/_server"),xr=Ie({method:"GET"}).handler(wr),re=Va({head:()=>({meta:[{charSet:"utf-8"},{name:"viewport",content:"width=device-width, initial-scale=1"},{title:"IntelliOptima | Chat"}],links:[{rel:"preconnect",href:"https://fonts.googleapis.com"},{rel:"preconnect",href:"https://fonts.gstatic.com",crossOrigin:"anonymous"},{rel:"stylesheet",href:"https://fonts.googleapis.com/css2?family=Inter:ital,opsz,wght@0,14..32,100..900;1,14..32,100..900&display=swap"},{rel:"stylesheet",href:vr},{rel:"stylesheet",href:br}]}),beforeLoad:async({})=>{const{data:e}=await xr();return!e||!e.user||!e.session?{userId:void 0,user:void 0,session:void 0}:{userId:e.userID,user:e.user,session:e.session}},errorComponent:e=>t(Yt,{children:t(Kt,{...e})}),notFoundComponent:()=>t(Xt,{}),component:Nr});function Nr(){return t(Yt,{children:i(Xa,{children:[t(Ya,{}),t(Wa,{})]})})}function Yt({children:e}){return Qa(),i("html",{children:[t("head",{children:t(qa,{})}),i("body",{children:[e,t(Ja,{})]})]})}const Cr=()=>import("./verify-account-B07A2W2v.js"),Ir=K.object({email:K.string().catch("")}),Qt=B("/verify-account")({validateSearch:e=>Ir.parse(e),component:ae(Cr,"component",()=>Qt.ssr)});function v(...e){return yn(gn(e))}const Tr=Te("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground shadow hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground shadow-sm hover:bg-destructive/90",outline:"border border-input bg-background shadow-sm hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground shadow-sm hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2",sm:"h-8 rounded-md px-3 text-xs",lg:"h-10 rounded-md px-8",icon:"h-9 w-9"}},defaultVariants:{variant:"default",size:"default"}}),O=F.forwardRef(({className:e,variant:n,size:r,asChild:a=!1,...s},o)=>t(a?fn:"button",{className:v("cursor-pointer",Tr({variant:n,size:r,className:e})),ref:o,...s}));O.displayName="Button";const ee=F.forwardRef(({className:e,type:n,...r},a)=>t("input",{type:n,className:v("flex h-9 w-full rounded-md border border-input bg-transparent px-3 py-1 text-base shadow-sm transition-colors file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",e),ref:a,...r}));ee.displayName="Input";function ue({className:e,...n}){return t("div",{"data-slot":"card",className:v("bg-card text-card-foreground rounded-xl border shadow-sm",e),...n})}function ye({className:e,...n}){return t("div",{"data-slot":"card-header",className:v("flex flex-col gap-1.5 p-6",e),...n})}function de({className:e,...n}){return t("div",{"data-slot":"card-title",className:v("leading-none font-semibold tracking-tight",e),...n})}function ne({className:e,...n}){return t("div",{"data-slot":"card-description",className:v("text-muted-foreground text-sm",e),...n})}function ie({className:e,...n}){return t("div",{"data-slot":"card-content",className:v("p-6 pt-0",e),...n})}function ke({className:e,...n}){return t("div",{"data-slot":"card-footer",className:v("flex items-center p-6 pt-0",e),...n})}function te({className:e,...n}){return t(vn.Root,{"data-slot":"label",className:v("text-sm leading-none font-medium select-none group-data-[disabled=true]:pointer-events-none group-data-[disabled=true]:opacity-50 peer-disabled:cursor-not-allowed peer-disabled:opacity-50",e),...n})}function Zt(e){return`https://${e}-intellitask-yrr2.encr.app`}class Sr{auth;chatrooms;chats;eventStreamer;fileManagement;fuck;openai;constructor(n,r){const a=new _r(n,r??{});this.auth=new at.ServiceClient(a),this.chatrooms=new nt.ServiceClient(a),this.chats=new rt.ServiceClient(a),this.eventStreamer=new st.ServiceClient(a),this.fileManagement=new ot.ServiceClient(a),this.fuck=new it.ServiceClient(a),this.openai=new ct.ServiceClient(a)}}var at;(e=>{class n{baseClient;constructor(a){this.baseClient=a}async authRouter(a,s,o,c){return this.baseClient.callAPI(a,`/api/auth/${s.map(encodeURIComponent).join("/")}`,o,c)}async getIfUserHasActiveOrganization(){return await(await this.baseClient.callTypedAPI("GET","/organizations/has-active")).json()}async getOrganizationInvitationsByEmail(){return await(await this.baseClient.callTypedAPI("GET","/organizations/invitations")).json()}async getOrganizationsAttendedByUser(){return await(await this.baseClient.callTypedAPI("GET","/organizations/attended-by-user")).json()}async handler(){return await(await this.baseClient.callTypedAPI("GET","/api/authorize")).json()}}e.ServiceClient=n})(at||(at={}));var nt;(e=>{class n{baseClient;constructor(a){this.baseClient=a}async addTeamspaceMember(a,s){return await(await this.baseClient.callTypedAPI("POST",`/teamspaces/${encodeURIComponent(a)}/members`,JSON.stringify(s))).json()}async changeProjectMemberStatus(a,s,o){await this.baseClient.callTypedAPI("PATCH",`/projects/${encodeURIComponent(a)}/kick-member/${encodeURIComponent(s)}`,JSON.stringify(o))}async changeTeamspaceMemberStatus(a,s,o){await this.baseClient.callTypedAPI("PATCH",`/teamspaces/${encodeURIComponent(a)}/kick-member/${encodeURIComponent(s)}`,JSON.stringify(o))}async createChatroom(a){return await(await this.baseClient.callTypedAPI("POST","/chatrooms",JSON.stringify(a))).json()}async createProject(a){return await(await this.baseClient.callTypedAPI("POST","/projects",JSON.stringify(a))).json()}async createTeamspace(a){return await(await this.baseClient.callTypedAPI("POST","/teamspaces",JSON.stringify(a))).json()}async deleteChatroom(a){await this.baseClient.callTypedAPI("DELETE",`/chatrooms/${encodeURIComponent(a)}`)}async deleteProject(a){await this.baseClient.callTypedAPI("DELETE",`/projects/${encodeURIComponent(a)}`)}async deleteTeamspace(a){await this.baseClient.callTypedAPI("DELETE",`/teamspaces/${encodeURIComponent(a)}`)}async getChatroom(a){return await(await this.baseClient.callTypedAPI("GET",`/chatrooms/${encodeURIComponent(a)}`)).json()}async getParticipatingChatroomsWithLatestMessages(){return await(await this.baseClient.callTypedAPI("GET","/chatrooms/participating")).json()}async getParticipatingTeamspaces(){return await(await this.baseClient.callTypedAPI("GET","/teamspaces/participating")).json()}async getProject(a){return await(await this.baseClient.callTypedAPI("GET",`/projects/${encodeURIComponent(a)}`)).json()}async getProjects(a){return await(await this.baseClient.callTypedAPI("GET",`/teamspaces/${encodeURIComponent(a)}/projects`)).json()}async getTeamspace(a){return await(await this.baseClient.callTypedAPI("GET",`/teamspaces/${encodeURIComponent(a)}`)).json()}async getTeamspaceMembers(a){return await(await this.baseClient.callTypedAPI("GET",`/teamspaces/${encodeURIComponent(a)}/members`)).json()}async getTeamspaces(){return await(await this.baseClient.callTypedAPI("GET","/teamspaces")).json()}async getUserProjects(){return await(await this.baseClient.callTypedAPI("GET","/user/projects")).json()}async removeTeamspaceMember(a){await this.baseClient.callTypedAPI("DELETE",`/teamspaces/members/${encodeURIComponent(a)}`)}async updateChatroom(a,s){await this.baseClient.callTypedAPI("PATCH",`/chatrooms/${encodeURIComponent(a)}`,JSON.stringify(s))}async updateProject(a,s){return await(await this.baseClient.callTypedAPI("PATCH",`/projects/${encodeURIComponent(a)}`,JSON.stringify(s))).json()}async updateTeamspace(a,s){await this.baseClient.callTypedAPI("PATCH",`/teamspaces/${encodeURIComponent(a)}`,JSON.stringify(s))}async updateTeamspaceMember(a,s){await this.baseClient.callTypedAPI("PATCH",`/teamspaces/members/${encodeURIComponent(a)}`,JSON.stringify(s))}}e.ServiceClient=n})(nt||(nt={}));var rt;(e=>{class n{baseClient;constructor(a){this.baseClient=a}async chat(a){const s=Ne({chatroomId:a.chatroomId,userId:a.userId});return await this.baseClient.createStreamInOut("/chat",{query:s})}async createChatMessageReactions(a){return await(await this.baseClient.callTypedAPI("POST","/chatmessage-reactions",JSON.stringify(a))).json()}async deleteChatMessageReaction(a){await this.baseClient.callTypedAPI("DELETE",`/chatmessage-reactions/${encodeURIComponent(a)}`)}async updateChatMessageReaction(a,s){await this.baseClient.callTypedAPI("PATCH",`/chatmessage-reactions/${encodeURIComponent(a)}`,JSON.stringify(s))}}e.ServiceClient=n})(rt||(rt={}));var st;(e=>{class n{baseClient;constructor(a){this.baseClient=a}async eventsStream(){return await this.baseClient.createStreamIn("/events")}async stats(a){await this.baseClient.callTypedAPI("GET",`/stats/${encodeURIComponent(a)}`)}}e.ServiceClient=n})(st||(st={}));var ot;(e=>{class n{baseClient;constructor(a){this.baseClient=a}async getFilesByIds(a){const s=Ne({fileIds:a.fileIds.map(c=>c)});return await(await this.baseClient.callTypedAPI("GET","/files",void 0,{query:s})).json()}async uploadFilesWithMetadata(a,s,o){return this.baseClient.callAPI(a,"/upload-with-metadata",s,o)}}e.ServiceClient=n})(ot||(ot={}));var it;(e=>{class n{baseClient;constructor(a){this.baseClient=a}async createAgent(a){return await(await this.baseClient.callTypedAPI("POST","/agents",JSON.stringify(a))).json()}async createConfigProfile(a){return await(await this.baseClient.callTypedAPI("POST","/config-profile",JSON.stringify(a))).json()}async createInstructionSet(a){return await(await this.baseClient.callTypedAPI("POST","/instruction-set",JSON.stringify(a))).json()}async createModel(a){return await(await this.baseClient.callTypedAPI("POST","/model",JSON.stringify(a))).json()}async createVoiceProfile(a){return await(await this.baseClient.callTypedAPI("POST","/voice-profile",JSON.stringify(a))).json()}async deleteAgent(a){const s=Ne({id:a.id});await this.baseClient.callTypedAPI("DELETE","/agents:id",void 0,{query:s})}async deleteConfigProfile(a){await this.baseClient.callTypedAPI("DELETE",`/config-profile/${encodeURIComponent(a)}`)}async deleteInstructionSet(a){await this.baseClient.callTypedAPI("DELETE",`/instruction-set/${encodeURIComponent(a)}`)}async deleteModel(a){await this.baseClient.callTypedAPI("DELETE",`/model/${encodeURIComponent(a)}`)}async deleteVoiceProfile(a){await this.baseClient.callTypedAPI("DELETE",`/voice-profile/${encodeURIComponent(a)}`)}async getAgent(a){const s=Ne({id:a.id});return await(await this.baseClient.callTypedAPI("GET","/agents:id",void 0,{query:s})).json()}async getConfigProfile(a){return await(await this.baseClient.callTypedAPI("GET",`/config-profile/${encodeURIComponent(a)}`)).json()}async getInstructionSet(a){return await(await this.baseClient.callTypedAPI("GET",`/instruction-set/${encodeURIComponent(a)}`)).json()}async getModel(a){return await(await this.baseClient.callTypedAPI("GET",`/model/${encodeURIComponent(a)}`)).json()}async getModels(){return await(await this.baseClient.callTypedAPI("GET","/models")).json()}async getModelsByProvider(a){return await(await this.baseClient.callTypedAPI("GET",`/models/provider/${encodeURIComponent(a)}`)).json()}async getPublicAgents(){return await(await this.baseClient.callTypedAPI("GET","/agents")).json()}async getPublicConfigProfiles(){return await(await this.baseClient.callTypedAPI("GET","/config-profiles")).json()}async getPublicInstructionSets(){return await(await this.baseClient.callTypedAPI("GET","/instruction-sets")).json()}async getVoiceProfile(a){return await(await this.baseClient.callTypedAPI("GET",`/voice-profile/${encodeURIComponent(a)}`)).json()}async getVoiceProfiles(){return await(await this.baseClient.callTypedAPI("GET","/voice-profiles")).json()}async updateAgent(a){await this.baseClient.callTypedAPI("PATCH","/agents:id",JSON.stringify(a))}async updateConfigProfile(a,s){await this.baseClient.callTypedAPI("PATCH",`/config-profile/${encodeURIComponent(a)}`,JSON.stringify(s))}async updateInstructionSet(a,s){await this.baseClient.callTypedAPI("PATCH",`/instruction-set/${encodeURIComponent(a)}`,JSON.stringify(s))}async updateModel(a,s){await this.baseClient.callTypedAPI("PATCH",`/model/${encodeURIComponent(a)}`,JSON.stringify(s))}async updateVoiceProfile(a,s){await this.baseClient.callTypedAPI("PATCH",`/voice-profile/${encodeURIComponent(a)}`,JSON.stringify(s))}}e.ServiceClient=n})(it||(it={}));var ct;(e=>{class n{baseClient;constructor(a){this.baseClient=a}async getCommunicationCoach(){return await(await this.baseClient.callTypedAPI("GET","/communication-coach")).json()}async getDataAnalyst(){return await(await this.baseClient.callTypedAPI("GET","/data-analyst")).json()}async getFinancialAdvisor(){return await(await this.baseClient.callTypedAPI("GET","/financial-advisor")).json()}async getHRConsultant(){return await(await this.baseClient.callTypedAPI("GET","/hr-consultant")).json()}async getInnovationConsultant(){return await(await this.baseClient.callTypedAPI("GET","/innovation-consultant")).json()}async getLegalAdvisor(){return await(await this.baseClient.callTypedAPI("GET","/legal-advisor")).json()}async getMarketingAdvisor(){return await(await this.baseClient.callTypedAPI("GET","/marketing-advisor")).json()}async getProductivityCoach(){return await(await this.baseClient.callTypedAPI("GET","/productivity-coach")).json()}async getProjectManager(){return await(await this.baseClient.callTypedAPI("GET","/project-manager")).json()}async getSupervisor(){return await(await this.baseClient.callTypedAPI("GET","/supervisor")).json()}async getTechAdvisor(){return await(await this.baseClient.callTypedAPI("GET","/tech-advisor")).json()}async getWellnessCoach(){return await(await this.baseClient.callTypedAPI("GET","/wellness-coach")).json()}async openaiStream(a,s,o){return this.baseClient.callAPI(a,"/stream-chat",s,o)}}e.ServiceClient=n})(ct||(ct={}));function Re(e){const n=[];for(const r in e){const a=Array.isArray(e[r])?e[r]:[e[r]];for(const s of a)n.push(`${r}=${encodeURIComponent(s)}`)}return n.join("&")}function Ne(e){for(const n in e)e[n]===void 0&&delete e[n];return e}function kr(e){return"encore.dev.headers."+btoa(JSON.stringify(e)).replaceAll("=","").replaceAll("+","-").replaceAll("/","_")}class xt{ws;hasUpdateHandlers=[];constructor(n,r){let a=["encore-ws"];r&&a.push(kr(r)),this.ws=new WebSocket(n,a),this.on("error",()=>{this.resolveHasUpdateHandlers()}),this.on("close",()=>{this.resolveHasUpdateHandlers()})}resolveHasUpdateHandlers(){const n=this.hasUpdateHandlers;this.hasUpdateHandlers=[];for(const r of n)r()}async hasUpdate(){await new Promise(n=>{this.hasUpdateHandlers.push(()=>n(null))})}on(n,r){this.ws.addEventListener(n,r)}off(n,r){this.ws.removeEventListener(n,r)}close(){this.ws.close()}}class Pr{socket;buffer=[];constructor(n,r){this.socket=new xt(n,r),this.socket.on("message",a=>{this.buffer.push(JSON.parse(a.data)),this.socket.resolveHasUpdateHandlers()})}close(){this.socket.close()}async send(n){return this.socket.ws.readyState===WebSocket.CONNECTING&&await new Promise(r=>{this.socket.ws.addEventListener("open",r,{once:!0})}),this.socket.ws.send(JSON.stringify(n))}async next(){for await(const n of this)return n}async*[Symbol.asyncIterator](){for(;;)if(this.buffer.length>0)yield this.buffer.shift();else{if(this.socket.ws.readyState===WebSocket.CLOSED)return;await this.socket.hasUpdate()}}}class Ar{socket;buffer=[];constructor(n,r){this.socket=new xt(n,r),this.socket.on("message",a=>{this.buffer.push(JSON.parse(a.data)),this.socket.resolveHasUpdateHandlers()})}close(){this.socket.close()}async next(){for await(const n of this)return n}async*[Symbol.asyncIterator](){for(;;)if(this.buffer.length>0)yield this.buffer.shift();else{if(this.socket.ws.readyState===WebSocket.CLOSED)return;await this.socket.hasUpdate()}}}class Rr{socket;responseValue;constructor(n,r){let a;this.responseValue=new Promise(s=>a=s),this.socket=new xt(n,r),this.socket.on("message",s=>{a(JSON.parse(s.data))})}async response(){return this.responseValue}close(){this.socket.close()}async send(n){return this.socket.ws.readyState===WebSocket.CONNECTING&&await new Promise(r=>{this.socket.ws.addEventListener("open",r,{once:!0})}),this.socket.ws.send(JSON.stringify(n))}}const Er=fetch.bind(void 0);class _r{baseURL;fetcher;headers;requestInit;authGenerator;constructor(n,r){if(this.baseURL=n,this.headers={},typeof globalThis=="object"&&!("window"in globalThis)&&(this.headers["User-Agent"]="intellitask-yrr2-Generated-TS-Client (Encore/v1.46.16)"),this.requestInit=r.requestInit??{},r.fetcher!==void 0?this.fetcher=r.fetcher:this.fetcher=Er,r.auth!==void 0){const a=r.auth;typeof a=="function"?this.authGenerator=a:this.authGenerator=()=>a}}async getAuthData(){let n;if(this.authGenerator){const r=this.authGenerator();r instanceof Promise?n=await r:n=r}if(n){const r={};return r.headers=Ne({cookie:n.cookie}),r}}async createStreamInOut(n,r){let{query:a,headers:s}=r??{};const o=await this.getAuthData();o&&(o.query&&(a={...a,...o.query}),o.headers&&(s={...s,...o.headers}));const c=a?"?"+Re(a):"";return new Pr(this.baseURL+n+c,s)}async createStreamIn(n,r){let{query:a,headers:s}=r??{};const o=await this.getAuthData();o&&(o.query&&(a={...a,...o.query}),o.headers&&(s={...s,...o.headers}));const c=a?"?"+Re(a):"";return new Ar(this.baseURL+n+c,s)}async createStreamOut(n,r){let{query:a,headers:s}=r??{};const o=await this.getAuthData();o&&(o.query&&(a={...a,...o.query}),o.headers&&(s={...s,...o.headers}));const c=a?"?"+Re(a):"";return new Rr(this.baseURL+n+c,s)}async callTypedAPI(n,r,a,s){return this.callAPI(n,r,a,{...s,headers:{"Content-Type":"application/json",...s?.headers}})}async callAPI(n,r,a,s){let{query:o,headers:c,...l}=s??{};const p={...this.requestInit,...l,method:n,body:a??null};p.headers={...this.headers,...p.headers,...c};const m=await this.getAuthData();m&&(m.query&&(o={...o,...m.query}),m.headers&&(p.headers={...p.headers,...m.headers}));const f=o?"?"+Re(o):"",d=await this.fetcher(this.baseURL+r+f,p);if(!d.ok){let h={code:"unknown",message:`request failed: status ${d.status}`};try{const k=await d.text();try{const u=JSON.parse(k);Or(u)?h=u:h.message+=": "+JSON.stringify(u)}catch{h.message+=": "+k}}catch(k){h.message+=": "+String(k)}throw new Le(d.status,h)}return d}}function Or(e){return e!=null&&jr(e.code)&&typeof e.message=="string"&&(e.details===void 0||e.details===null||typeof e.details=="object")}function jr(e){return e!==void 0&&Object.values(ea).includes(e)}class Le extends Error{status;code;details;constructor(n,r){super(r.message),Object.defineProperty(this,"name",{value:"APIError",enumerable:!1,configurable:!0}),Object.setPrototypeOf==null?this.__proto__=Le.prototype:Object.setPrototypeOf(this,Le.prototype),Error.captureStackTrace!==void 0&&Error.captureStackTrace(this,this.constructor),this.status=n,this.code=r.code,this.details=r.details}}var ea=(e=>(e.OK="ok",e.Canceled="canceled",e.Unknown="unknown",e.InvalidArgument="invalid_argument",e.DeadlineExceeded="deadline_exceeded",e.NotFound="not_found",e.AlreadyExists="already_exists",e.PermissionDenied="permission_denied",e.ResourceExhausted="resource_exhausted",e.FailedPrecondition="failed_precondition",e.Aborted="aborted",e.OutOfRange="out_of_range",e.Unimplemented="unimplemented",e.Internal="internal",e.Unavailable="unavailable",e.DataLoss="data_loss",e.Unauthenticated="unauthenticated",e))(ea||{});const Mr=()=>{const e=Zt("staging");return bn({baseURL:e,plugins:[wn(),xn(),Nn()]})},{useSession:ta,getSession:$r,signIn:lt,signUp:zr,signOut:si,emailOtp:dt,verifyEmail:oi,organization:ut,useListOrganizations:Lr,useActiveOrganization:Dr}=Mr(),Dt=({className:e})=>t("div",{className:"flex items-center justify-center",children:i("div",{className:`${e} flex items-center justify-center`,children:[t("div",{className:"w-[45%] border-b border-gray-200"}),t("div",{className:"h-4.5 w-4.5 rounded-full border border-gray-200 m-1"}),t("div",{className:"w-[45%] border-b border-gray-200"})]})}),Ur=B("/sign-up")({beforeLoad({context:e}){if(e.user)throw we({to:"/chat"})},component:Fr});function Fr(){const[e,n]=x(""),[r,a]=x(""),[s,o]=x(""),[c,l]=x(!1),p=Ce();return D(()=>{if(typeof window<"u"){const f=localStorage.getItem("invitationEmail");f&&(a(f),localStorage.removeItem("invitationEmail"))}},[]),t("div",{className:"flex min-h-screen items-center justify-center bg-gradient-to-b from-background to-muted/30 p-4",children:i(ue,{className:"w-full max-w-md",children:[i(ye,{className:"space-y-1 text-center",children:[t(de,{className:"text-2xl font-bold",children:"Create an account"}),t(ne,{children:"Enter your information to create your account"})]}),i("form",{onSubmit:async f=>{f.preventDefault(),l(!0);try{const{data:d}=await zr.email({email:r,name:e,password:s});if(d){const{data:h}=await dt.sendVerificationOtp({email:r,type:"email-verification"});h?.success?(G.success("Account created successfully!"),setTimeout(()=>{p({to:`/verify-account?email=${r}`,viewTransition:!0,reloadDocument:!0})},1e3)):G.error("Account not created - try again")}else G.error("Failed to create account. Please try again or check your credentials.")}catch{G.error("Failed to create account. Please try again.")}finally{l(!1)}},children:[i(ie,{className:"space-y-4",children:[t("div",{className:v("w-full gap-2 flex items-center","justify-between flex-col"),children:i(O,{type:"button",variant:"outline",className:v("w-full gap-2 hover:cursor-pointer"),onClick:async f=>{const{data:d,error:h}=await lt.social({provider:"google",callbackURL:"http://localhost:3000/create-organization"});console.log("GOOGLE SIGNIN",d,h)},children:[i("svg",{xmlns:"http://www.w3.org/2000/svg",width:"0.98em",height:"1em",viewBox:"0 0 256 262",children:[t("path",{fill:"#4285F4",d:"M255.878 133.451c0-10.734-.871-18.567-2.756-26.69H130.55v48.448h71.947c-1.45 12.04-9.283 30.172-26.69 42.356l-.244 1.622l38.755 30.023l2.685.268c24.659-22.774 38.875-56.282 38.875-96.027"}),t("path",{fill:"#34A853",d:"M130.55 261.1c35.248 0 64.839-11.605 86.453-31.622l-41.196-31.913c-11.024 7.688-25.82 13.055-45.257 13.055c-34.523 0-63.824-22.773-74.269-54.25l-1.531.13l-40.298 31.187l-.527 1.465C35.393 231.798 79.49 261.1 130.55 261.1"}),t("path",{fill:"#FBBC05",d:"M56.281 156.37c-2.756-8.123-4.351-16.827-4.351-25.82c0-8.994 1.595-17.697 4.206-25.82l-.073-1.73L15.26 71.312l-1.335.635C5.077 89.644 0 109.517 0 130.55s5.077 40.905 13.925 58.602z"}),t("path",{fill:"#EB4335",d:"M130.55 50.479c24.514 0 41.05 10.589 50.479 19.438l36.844-35.974C195.245 12.91 165.798 0 130.55 0C79.49 0 35.393 29.301 13.925 71.947l42.211 32.783c10.59-31.477 39.891-54.251 74.414-54.251"})]}),"Sign up with Google"]})}),t(Dt,{className:"w-[90%]"}),i("div",{className:"space-y-2",children:[t(te,{htmlFor:"name",children:"Full Name"}),t(ee,{id:"name",placeholder:"John Doe",value:e,onChange:f=>n(f.target.value),required:!0})]}),t(te,{htmlFor:"email",children:"Email"}),t(ee,{id:"email",type:"email",placeholder:"your.email@example.com",value:r,onChange:f=>a(f.target.value),required:!0}),i("div",{className:"space-y-2",children:[t(te,{htmlFor:"password",children:"Password"}),t(ee,{id:"password",type:"password",minLength:8,value:s,onChange:f=>o(f.target.value),required:!0}),t("p",{className:"text-xs text-muted-foreground",children:"Password must be at least 8 characters long"})]})]}),t(Dt,{className:"mb-3 w-[80%]"}),i(ke,{className:"flex flex-col space-y-4",children:[t(O,{type:"submit",className:"w-full",disabled:c||e.length===0||r.length<3||s.length<7,children:c?"Creating account...":"Create account"}),i("div",{className:"text-center text-sm",children:["Already have an account?"," ",t(J,{to:"/sign-in",viewTransition:!0,className:"text-primary hover:underline",children:"Sign in"})]}),i("div",{className:"text-center text-sm",children:["Go back?"," ",t(J,{to:"/",viewTransition:!0,className:"text-primary hover:underline",children:"Home"})]})]})]})]})})}const Gr=B("/sign-in")({beforeLoad({context:e}){if(e.user)throw we({to:"/chat"})},component:Br});function Br(){const[e,n]=x(""),[r,a]=x(""),[s,o]=x(!1),c=Ce();D(()=>{if(typeof window<"u"){const m=localStorage.getItem("invitationEmail");m&&(n(m),localStorage.removeItem("invitationEmail"))}},[]);const l=async()=>{await lt.social({provider:"google",callbackURL:"http://localhost:3000/chat"})};return t("div",{className:"flex min-h-screen items-center justify-center bg-gradient-to-b from-background to-muted/30 p-4",children:i(ue,{className:"w-full max-w-md",children:[i(ye,{className:"space-y-1 text-center",children:[t(de,{className:"text-2xl font-bold",children:"Sign in"}),t(ne,{children:"Enter your email and password to access your account"})]}),i("form",{onSubmit:async m=>{m.preventDefault(),o(!0);try{const{data:f,error:d}=await lt.email({email:e,password:r,rememberMe:!0});f?(G.success("Successfully signed in!"),c({to:"/chat",reloadDocument:!0,viewTransition:!0})):d.status===403?(G.error("You need to verify your account!"),setTimeout(()=>{c({to:`/verify-account?email=${e}`,reloadDocument:!0,viewTransition:!0})},1e3)):G.error("We could not sign you in - check your credentials")}catch{G.error("Failed to sign in. Please check your credentials.")}finally{o(!1)}},children:[i(ie,{className:"space-y-4",children:[i("div",{className:"space-y-2",children:[t(te,{htmlFor:"email",children:"Email"}),t(ee,{id:"email",type:"email",placeholder:"your.email@example.com",value:e,onChange:m=>n(m.target.value.toLowerCase()),required:!0})]}),i("div",{className:"space-y-2",children:[i("div",{className:"flex items-center justify-between",children:[t(te,{htmlFor:"password",children:"Password"}),t(J,{to:"/forgot-password",viewTransition:!0,className:"text-sm text-primary hover:underline",children:"Forgot password?"})]}),t(ee,{id:"password",type:"password",value:r,onChange:m=>a(m.target.value),required:!0})]}),t("div",{className:v("w-full gap-2 flex items-center","justify-between flex-col"),children:i(O,{type:"button",variant:"outline",className:v("w-full gap-2 hover:cursor-pointer"),onClick:async m=>l(),children:[i("svg",{xmlns:"http://www.w3.org/2000/svg",width:"0.98em",height:"1em",viewBox:"0 0 256 262",children:[t("path",{fill:"#4285F4",d:"M255.878 133.451c0-10.734-.871-18.567-2.756-26.69H130.55v48.448h71.947c-1.45 12.04-9.283 30.172-26.69 42.356l-.244 1.622l38.755 30.023l2.685.268c24.659-22.774 38.875-56.282 38.875-96.027"}),t("path",{fill:"#34A853",d:"M130.55 261.1c35.248 0 64.839-11.605 86.453-31.622l-41.196-31.913c-11.024 7.688-25.82 13.055-45.257 13.055c-34.523 0-63.824-22.773-74.269-54.25l-1.531.13l-40.298 31.187l-.527 1.465C35.393 231.798 79.49 261.1 130.55 261.1"}),t("path",{fill:"#FBBC05",d:"M56.281 156.37c-2.756-8.123-4.351-16.827-4.351-25.82c0-8.994 1.595-17.697 4.206-25.82l-.073-1.73L15.26 71.312l-1.335.635C5.077 89.644 0 109.517 0 130.55s5.077 40.905 13.925 58.602z"}),t("path",{fill:"#EB4335",d:"M130.55 50.479c24.514 0 41.05 10.589 50.479 19.438l36.844-35.974C195.245 12.91 165.798 0 130.55 0C79.49 0 35.393 29.301 13.925 71.947l42.211 32.783c10.59-31.477 39.891-54.251 74.414-54.251"})]}),"Sign in with Google"]})})]}),i(ke,{className:"flex flex-col space-y-4",children:[t(O,{type:"submit",className:"w-full",disabled:s,children:s?"Signing in...":"Sign in"}),i("div",{className:"text-center text-sm",children:["Don't have an account?"," ",t(J,{to:"/sign-up",className:"text-primary hover:underline",children:"Sign up"})]}),i("div",{className:"text-center text-sm",children:["Go back?"," ",t(J,{to:"/",viewTransition:!0,className:"text-primary hover:underline",children:"Home"})]})]})]})]})})}const aa=F.forwardRef(({className:e,containerClassName:n,...r},a)=>t(Kn,{ref:a,containerClassName:v("flex items-center gap-2 has-[:disabled]:opacity-50",n),className:v("disabled:cursor-not-allowed",e),...r}));aa.displayName="InputOTP";const na=F.forwardRef(({className:e,...n},r)=>t("div",{ref:r,className:v("flex items-center",e),...n}));na.displayName="InputOTPGroup";const ce=F.forwardRef(({index:e,className:n,...r},a)=>{const s=F.useContext(Xn),{char:o,hasFakeCaret:c,isActive:l}=s.slots[e];return i("div",{ref:a,className:v("relative flex h-9 w-9 items-center justify-center border-y border-r border-input text-sm shadow-sm transition-all first:rounded-l-md first:border-l last:rounded-r-md",l&&"z-10 ring-1 ring-ring",n),...r,children:[o,c&&t("div",{className:"pointer-events-none absolute inset-0 flex items-center justify-center",children:t("div",{className:"h-4 w-px animate-caret-blink bg-foreground duration-1000"})})]})});ce.displayName="InputOTPSlot";const Hr=F.forwardRef(({...e},n)=>t("div",{ref:n,role:"separator",...e,children:t(Cn,{})}));Hr.displayName="InputOTPSeparator";const Vr=B("/forgot-password")({component:Wr});function Wr(){const[e,n]=x(""),[r,a]=x(""),[s,o]=x(""),[c,l]=x(!1),[p,m]=x(!1),f=r.length===6&&/^\d{6}$/.test(r)&&e.length>3&&s.length>7,d=Ce(),h=async u=>{u.preventDefault(),l(!0);try{const{data:b}=await dt.sendVerificationOtp({email:e,type:"forget-password"});b?.success&&(m(!0),G.success("Password reset token sent! Please check your email."))}catch(b){G.error("Failed to send reset link. Please try again."),console.error("Password reset error:",b)}finally{l(!1)}},k=async()=>{l(!0);const{data:u,error:b}=await dt.resetPassword({email:e,otp:r,password:s});l(!1),u?.success?d({to:"/sign-in",viewTransition:!0}):(console.error("Error resetting password",b),G.error("Something went wrong"))};return t("div",{className:"flex min-h-screen items-center justify-center bg-gradient-to-b from-background to-muted/30 p-4",children:i(ue,{className:"w-full max-w-md",children:[i(ye,{className:"space-y-1 text-center",children:[t(de,{className:"text-2xl font-bold",children:"Reset your password"}),t(ne,{children:p?"Check your email for a link to reset your password":"Enter your email and we'll send you a link to reset your password"})]}),p?i(ie,{className:"space-y-6 flex flex-col items-center",children:[i("div",{className:"rounded-lg bg-muted p-6 text-center",children:[t(et,{className:"mx-auto mb-4 h-12 w-12 text-primary"}),i("p",{className:"text-sm text-muted-foreground",children:["We've sent a password reset token to ",t("strong",{children:e}),". Please check your inbox and get the token to reset your password."]})]}),t(ne,{children:"Please enter the 6-character code sent to your email"}),t("div",{className:"space-y-2",children:t(aa,{maxLength:6,value:r,onChange:u=>a(u),children:i(na,{children:[t(ce,{index:0}),t(ce,{index:1}),t(ce,{index:2}),t(ce,{index:3}),t(ce,{index:4}),t(ce,{index:5})]})})}),i("div",{className:"space-y-2",children:[t(de,{children:"New password"}),t(ee,{id:"password",type:"password",minLength:8,value:s,onChange:u=>o(u.target.value),required:!0}),t(ne,{children:"Password must be at least 8 characters long"})]}),t(O,{className:"w-full",disabled:!f||c,onClick:()=>k(),children:"Reset password"}),t(O,{variant:"outline",className:"w-full",onClick:()=>{m(!1),n(""),o("")},children:"Try another email"}),t("div",{className:"text-center text-sm",children:i(J,{to:"/sign-in",className:"inline-flex items-center justify-center text-primary hover:underline",children:[t(Mt,{className:"mr-1 h-4 w-4"})," Back to sign in"]})})]}):i("form",{onSubmit:h,children:[t(ie,{className:"space-y-4",children:i("div",{className:"space-y-2",children:[t(te,{htmlFor:"email",children:"Email"}),i("div",{className:"relative",children:[t(et,{className:"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-muted-foreground"}),t(ee,{id:"email",type:"email",placeholder:"your.email@example.com",value:e,onChange:u=>n(u.target.value.toLowerCase()),className:"pl-10",required:!0})]})]})}),i(ke,{className:"flex flex-col space-y-4",children:[t(O,{type:"submit",className:"w-full",disabled:c,children:c?"Sending reset link...":"Send reset link"}),t("div",{className:"text-center text-sm",children:i(J,{to:"/sign-in",className:"inline-flex items-center text-primary hover:underline",viewTransition:!0,children:[t(Mt,{className:"mr-1 h-4 w-4"})," Back to sign in"]})})]})]})]})})}function qr({steps:e,currentStep:n,paymentPlan:r,onStepClick:a,className:s,showLabels:o=!0}){const[c,l]=x(!1);return D(()=>{l(!0)},[]),c?t("div",{className:v("w-full",s),children:t("div",{className:"relative flex items-center justify-center w-full",children:e.map((p,m)=>{if(r==="enterprise"&&p.id=="3")return;const f=p.id===n,d=p.completed||m<e.findIndex(h=>h.id===n);return i("div",{className:"relative flex flex-col items-center flex-1",children:[m>0&&t("div",{className:v("absolute top-1/2 w-full h-[2px] -translate-y-1/2 -left-1/2",d?"bg-primary":"bg-muted")}),t("button",{type:"button",onClick:()=>a?.(p.id),disabled:!a,className:v("relative z-10 flex items-center justify-center w-10 h-10 rounded-full border-2 transition-all",f&&"ring-4 ring-primary/20",d?"bg-primary border-primary text-primary-foreground":f?"border-primary bg-background text-primary":"border-muted bg-white text-muted-foreground",a&&"cursor-pointer hover:opacity-80"),"aria-current":f?"step":void 0,children:d?t(Ue,{className:"w-5 h-5"}):t("span",{className:"text-sm font-medium",children:m+1})}),o&&t("div",{className:v("mt-2 text-xs font-medium text-center",f?"text-primary":"text-muted-foreground"),children:p.label})]},p.id)})})}):null}const Ke=768;function ra(){const[e,n]=F.useState(void 0);return F.useEffect(()=>{const r=window.matchMedia(`(max-width: ${Ke-1}px)`),a=()=>{n(window.innerWidth<Ke)};return r.addEventListener("change",a),n(window.innerWidth<Ke),()=>r.removeEventListener("change",a)},[]),!!e}const Nt=F.forwardRef(({className:e,...n},r)=>t("textarea",{className:v("flex min-h-[60px] w-full rounded-md border border-input bg-transparent px-3 py-2 text-base shadow-sm placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",e),ref:r,...n}));Nt.displayName="Textarea";function Jr({onImageUpload:e,defaultImage:n,className:r,maxSizeMB:a=5,aspectRatio:s="square",width:o=200,height:c=200}){const[l,p]=x(!1),[m,f]=x(n||null),[d,h]=x(null),[k,u]=x(!1),b=L(null),w=g=>{g.preventDefault(),g.stopPropagation(),g.type==="dragenter"||g.type==="dragover"?p(!0):g.type==="dragleave"&&p(!1)},y=g=>g.size>a*1024*1024?(h(`File size exceeds ${a}MB limit`),!1):g.type.startsWith("image/")?(h(null),!0):(h("Only image files are allowed"),!1),I=g=>{if(!y(g))return;u(!0);const T=new FileReader;T.onload=S=>{f(S.target?.result),u(!1)},T.readAsDataURL(g),e(g)},M=g=>{g.preventDefault(),g.stopPropagation(),p(!1),g.dataTransfer.files&&g.dataTransfer.files[0]&&I(g.dataTransfer.files[0])},j=g=>{g.preventDefault(),g.target.files&&g.target.files[0]&&I(g.target.files[0])},C=()=>{b.current?.click()},E=()=>{f(null),b.current&&(b.current.value="")};return i("div",{className:v("flex flex-col items-center",r),children:[i("div",{className:v("relative flex flex-col items-center justify-center border-2 border-dashed border-gray-300 bg-gray-50 transition-all hover:cursor-pointer",l?"border-primary bg-primary/5":"hover:bg-gray-100",s==="circle"?"rounded-full":"rounded-lg","overflow-hidden"),style:{width:`${o}px`,height:`${c}px`},onDragEnter:w,onDragLeave:w,onDragOver:w,onDrop:M,onClick:C,children:[k?t("div",{className:"absolute inset-0 flex items-center justify-center bg-background/80",children:t("div",{className:"h-8 w-8 animate-spin rounded-full border-4 border-primary border-t-transparent"})}):m?i(ge,{children:[t("img",{src:m||"/placeholder.svg",alt:"Uploaded image preview",style:{width:`${o}px`,height:`${c}px`},className:"object-cover"}),i(O,{variant:"destructive",size:"icon",className:"absolute right-2 top-2 h-6 w-6 rounded-full",onClick:g=>{g.stopPropagation(),E()},children:[t(Wt,{className:"h-4 w-4"}),t("span",{className:"sr-only",children:"Remove image"})]})]}):t("div",{className:"flex flex-col items-center justify-center p-4 text-center",children:t(In,{className:"mb-2 h-8 w-8 text-gray-400"})}),t("input",{ref:b,type:"file",accept:"image/*",onChange:j,className:"hidden"})]}),d&&t("p",{className:"mt-2 text-sm text-destructive",children:d}),t("p",{className:"mb-1 mt-2 text-sm font-normal",children:"Drag & drop an image here or click to browse"}),i("p",{className:"mt-1 text-xs text-muted-foreground",children:["Supported formats: JPG, PNG, GIF, WebP (max ",a,"MB)"]})]})}const Ut=({name:e,setName:n,description:r,setDescription:a})=>i(ue,{className:"w-full max-w-lg",children:[i(ye,{className:"space-y-1 text-center",children:[t(de,{className:"text-2xl font-bold",children:"Create your organization"}),t(ne,{children:"Set up a teamspace for your team to collaborate"})]}),i(ie,{className:"space-y-4",children:[t("h4",{className:"text-center",children:"Organization Logo"}),t(Jr,{onImageUpload:()=>{},aspectRatio:"circle",width:100,height:100}),i("div",{className:"space-y-2",children:[t(te,{htmlFor:"org-name",children:"Organization Name"}),t(ee,{id:"org-name",placeholder:"Acme Inc.",value:e,maxLength:50,onChange:s=>n(s.target.value),required:!0})]}),i("div",{className:"space-y-2",children:[t(te,{htmlFor:"org-description",children:"Description (optional)"}),t(Nt,{id:"org-description",placeholder:"What does your organization do?",value:r,maxLength:1e3,onChange:s=>a(s.target.value),rows:3})]})]})]}),Kr=U.Root,Xr=U.Value,sa=F.forwardRef(({className:e,children:n,...r},a)=>i(U.Trigger,{ref:a,className:v("flex h-9 w-full items-center justify-between whitespace-nowrap rounded-md border border-input bg-transparent px-3 py-2 text-sm shadow-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-1 focus:ring-ring disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",e),...r,children:[n,t(U.Icon,{asChild:!0,children:t(Fe,{className:"h-4 w-4 opacity-50"})})]}));sa.displayName=U.Trigger.displayName;const oa=F.forwardRef(({className:e,...n},r)=>t(U.ScrollUpButton,{ref:r,className:v("flex cursor-default items-center justify-center py-1",e),...n,children:t(Tn,{className:"h-4 w-4"})}));oa.displayName=U.ScrollUpButton.displayName;const ia=F.forwardRef(({className:e,...n},r)=>t(U.ScrollDownButton,{ref:r,className:v("flex cursor-default items-center justify-center py-1",e),...n,children:t(Fe,{className:"h-4 w-4"})}));ia.displayName=U.ScrollDownButton.displayName;const ca=F.forwardRef(({className:e,children:n,position:r="popper",...a},s)=>t(U.Portal,{children:i(U.Content,{ref:s,className:v("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",r==="popper"&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",e),position:r,...a,children:[t(oa,{}),t(U.Viewport,{className:v("p-1",r==="popper"&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:n}),t(ia,{})]})}));ca.displayName=U.Content.displayName;const Yr=F.forwardRef(({className:e,...n},r)=>t(U.Label,{ref:r,className:v("px-2 py-1.5 text-sm font-semibold",e),...n}));Yr.displayName=U.Label.displayName;const _e=F.forwardRef(({className:e,children:n,...r},a)=>i(U.Item,{ref:a,className:v("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-2 pr-8 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",e),...r,children:[t("span",{className:"absolute right-2 flex h-3.5 w-3.5 items-center justify-center",children:t(U.ItemIndicator,{children:t(Ue,{className:"h-4 w-4"})})}),t(U.ItemText,{children:n})]}));_e.displayName=U.Item.displayName;const Qr=F.forwardRef(({className:e,...n},r)=>t(U.Separator,{ref:r,className:v("-mx-1 my-1 h-px bg-muted",e),...n}));Qr.displayName=U.Separator.displayName;const Zr=Te("inline-flex items-center rounded-md border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground shadow hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground shadow hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function mt({className:e,variant:n,...r}){return t("div",{className:v(Zr({variant:n}),e),...r})}function es({invitees:e,onAddInvitee:n,onRemoveInvitee:r,isSubmitting:a=!1}){const{data:s}=ta(),[o,c]=x(""),[l,p]=x("member"),[m,f]=x(""),d=u=>/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(u),h=()=>{if(o.toLowerCase()===s?.user.email.toLowerCase()){f("Not allowed to use your own email here");return}if(!o){f("Email is required");return}if(!d(o)){f("Please enter a valid email address");return}if(e.some(u=>u.email.toLowerCase()===o.toLowerCase())){f("This email has already been added");return}f(""),n(o,l),c("")},k=u=>{switch(u){case"admin":return"bg-red-100 text-red-800 hover:bg-red-200";case"member":return"bg-blue-100 text-blue-800 hover:bg-blue-200";case"owner":return"bg-green-100 text-green-800 hover:bg-green-200";default:return"bg-gray-100 text-gray-800 hover:bg-gray-200"}};return i(ue,{className:"w-full max-w-3xl mx-auto",children:[i(ye,{children:[t(de,{className:"text-2xl",children:"Organization Setup"}),t(ne,{children:"Invite team members to your organization"}),t(ne,{children:"Members can always be invited when Organization is created"})]}),t(ie,{className:"space-y-6",children:t("div",{className:"space-y-4",children:i("div",{className:"grid gap-2",children:[t(te,{htmlFor:"email",children:"Email Address"}),i("div",{className:"flex gap-2",children:[i("div",{className:"flex-1",children:[t(ee,{id:"email",type:"email",placeholder:"colleague@example.com",value:o,onChange:u=>c(u.target.value.toLowerCase()),className:m?"border-red-500":""}),m&&t("p",{className:"text-sm text-red-500 mt-1",children:m})]}),i(Kr,{value:l,onValueChange:u=>p(u),children:[t(sa,{className:"w-[180px] hover:cursor-pointer",children:t(Xr,{placeholder:"Select role"})}),i(ca,{children:[t(_e,{className:"hover:cursor-pointer",value:"owner",children:"Owner"}),t(_e,{className:"hover:cursor-pointer",value:"admin",children:"Admin"}),t(_e,{className:"hover:cursor-pointer",value:"member",children:"Member"})]})]}),i(O,{className:"hover:cursor-pointer",type:"button",onClick:h,children:[t(Sn,{className:"h-4 w-4 mr-2"}),"Add"]})]})]})})}),i(ke,{className:"flex justify-center border-t p-6",children:[e.length>0&&i("div",{className:"space-y-3",children:[t("h3",{className:"text-sm font-medium",children:"Pending Invitations"}),t("div",{className:"border rounded-md divide-y",children:e.map(u=>i("div",{className:"flex items-center justify-between p-3",children:[i("div",{className:"flex items-center gap-3",children:[t(et,{className:"h-4 w-4 text-muted-foreground"}),t("span",{children:u.email}),t(mt,{className:k(u.role),children:u.role})]}),i(O,{variant:"ghost",size:"sm",onClick:()=>r(u.id),className:"h-8 w-8 p-0 hover:cursor-pointer",children:[t(Wt,{className:"h-4 w-4"}),t("span",{className:"sr-only",children:"Remove"})]})]},u.id))})]}),e.length===0&&t("p",{children:"No members selected for the organization"})]})]})}const ts=({invitees:e,setInvitees:n})=>{const[r,a]=x(!1);return t("div",{children:t(es,{invitees:e,onAddInvitee:(c,l)=>{n([...e,{email:c,role:l,id:crypto.randomUUID()}])},onRemoveInvitee:c=>{n(e.filter(l=>l.id!==c))},isSubmitting:r})})};function la({delayDuration:e=0,...n}){return t(pe.Provider,{"data-slot":"tooltip-provider",delayDuration:e,...n})}function Oe({...e}){return t(la,{children:t(pe.Root,{"data-slot":"tooltip",...e})})}function je({...e}){return t(pe.Trigger,{"data-slot":"tooltip-trigger",...e})}function Me({className:e,sideOffset:n=4,children:r,...a}){return t(pe.Portal,{children:i(pe.Content,{"data-slot":"tooltip-content",sideOffset:n,className:v("bg-primary text-primary-foreground animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 max-w-sm rounded-md px-3 py-1.5 text-xs",e),...a,children:[r,t(pe.Arrow,{className:"bg-primary fill-primary z-50 size-2.5 translate-y-[calc(-50%_-_2px)] rotate-45 rounded-[2px]"})]})})}const da=F.forwardRef(({className:e,...n},r)=>t(xe.Root,{className:v("grid gap-2",e),...n,ref:r}));da.displayName=xe.Root.displayName;const ua=F.forwardRef(({className:e,...n},r)=>t(xe.Item,{ref:r,className:v("aspect-square h-4 w-4 rounded-full border border-primary text-primary shadow focus:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50",e),...n,children:t(xe.Indicator,{className:"flex items-center justify-center",children:t(kn,{className:"h-3.5 w-3.5 fill-primary"})})}));ua.displayName=xe.Item.displayName;const as=({invitees:e,paymentPlan:n,setPaymentPlan:r,setCurrentStep:a})=>i("div",{className:"max-w-6xl mx-auto px-4",children:[i("div",{className:"mb-8 text-center",children:[t("h1",{className:"text-3xl font-bold mb-2",children:"Choose your plan"}),t("p",{className:"text-muted-foreground max-w-2xl mx-auto",children:"Final step! Select a payment plan for your organization. You can invite team members to collaborate on your projects."})]}),t("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-8",children:[{id:"starter",name:"Starter",description:"Perfect for individuals and small projects",price:"$9",billingPeriod:"per month",features:[{name:"Up to 3 team members",included:!0},{name:"5 projects",included:!0},{name:"Basic analytics",included:!0},{name:"24-hour support",included:!1},{name:"Advanced security",included:!1}]},{id:"pro",name:"Professional",description:"Ideal for growing teams and businesses",price:"$29",billingPeriod:"per month",features:[{name:"Up to 10 team members",included:!0},{name:"Unlimited projects",included:!0},{name:"Advanced analytics",included:!0},{name:"24-hour support",included:!0},{name:"Advanced security",included:!1}],popular:!0},{id:"enterprise",name:"Enterprise",description:"For large organizations with advanced needs",price:"$99",billingPeriod:"per month",features:[{name:"Unlimited team members",included:!0},{name:"Unlimited projects",included:!0},{name:"Advanced analytics",included:!0},{name:"24-hour priority support",included:!0},{name:"Advanced security",included:!0}]}].map(o=>i(ue,{onClick:()=>r(o.id),className:`relative hover:cursor-pointer ${n===o.id?"border-primary":""}`,children:[o.popular&&t(mt,{className:"absolute -top-2 right-4 bg-primary",children:"Most Popular"}),i(ye,{children:[t(de,{children:o.name}),t(ne,{children:o.description}),i("div",{className:"mt-2",children:[t("span",{className:"text-3xl font-bold",children:o.price}),t("span",{className:"text-muted-foreground ml-1",children:o.billingPeriod})]}),t(mt,{variant:"outline",className:"mt-2 bg-green-50 text-green-700 border-green-200",children:"14-day free trial included"})]}),t(ie,{children:t("ul",{className:"space-y-2",children:o.features.map((c,l)=>i("li",{className:"flex items-start",children:[c.included?t(Ue,{className:"h-5 w-5 text-green-500 mr-2 shrink-0"}):t("div",{className:"h-5 w-5 mr-2"}),t("span",{className:c.included?"":"text-muted-foreground",children:c.name})]},l))})}),t(ke,{children:t(da,{value:n||"",onValueChange:r,className:"w-full",children:i("div",{className:"flex items-center space-x-2",children:[t(ua,{value:o.id,id:o.id}),t(te,{htmlFor:o.id,className:"cursor-pointer w-full",children:t(O,{onClick:()=>r(o.id),variant:n===o.id?"default":"outline",className:"w-full hover:cursor-pointer",children:n===o.id?"Selected":"Select Plan"})})]})})})]},o.id))}),n!=="enterprise"&&i("div",{children:[t("div",{className:"bg-muted p-4 rounded-lg mb-8",children:i("div",{className:"flex items-start gap-3",children:[t(Pn,{className:"h-5 w-5 text-blue-500 shrink-0 mt-0.5"}),i("div",{children:[t("h3",{className:"font-medium mb-1",children:"Organization members"}),t("p",{className:"text-sm text-muted-foreground",children:"You can invite team members to your organization now or later. Team members will have access based on their assigned roles."}),t(la,{children:i(Oe,{children:[t(je,{asChild:!0,children:t(O,{variant:"link",className:"p-0 h-auto text-sm",children:"Learn more about roles and permissions"})}),t(Me,{className:"max-w-sm",children:t("p",{children:"Organization members can have different roles like Admin, Member, or Collaborator with varying levels of access to projects and settings. [^1][^2]"})})]})})]})]})}),i("div",{className:"flex flex-col md:flex-row gap-4 justify-between items-center",children:[i("div",{className:"flex items-center gap-2",children:[t(An,{className:"h-5 w-5 text-muted-foreground"}),i("span",{className:"text-sm text-muted-foreground",children:[e?e?.length:0," members invited"]})]}),i("div",{className:"flex gap-4",children:[t(O,{onClick:()=>a(3),className:"hover:cursor-pointer",variant:"outline",children:"Invite Team Members"}),t(O,{className:"hover:cursor-pointer",children:"Continue to Payment"})]})]})]})]}),fe=e=>{const n=Zt("staging");return new Sr(n,{auth:{cookie:e},requestInit:{credentials:"include"}})},ns=X([]),ma=()=>{const{data:e}=ta(),[n,r]=wt(ns);return D(()=>{n.length>0||(async()=>{const{data:s}=await fe().auth.getOrganizationInvitationsByEmail();s&&r(s)})()},[e?.user.id]),{organizationInvitations:n,refetchInvitations:async()=>{const{data:s}=await fe().auth.getOrganizationInvitationsByEmail();s&&r(s)}}},Ct=F.forwardRef(({className:e,children:n,...r},a)=>i(le.Root,{ref:a,className:v("relative overflow-hidden",e),...r,children:[t(le.Viewport,{className:"h-full w-full rounded-[inherit]",children:n}),t(ha,{}),t(le.Corner,{})]}));Ct.displayName=le.Root.displayName;const ha=F.forwardRef(({className:e,orientation:n="vertical",...r},a)=>t(le.ScrollAreaScrollbar,{ref:a,orientation:n,className:v("flex touch-none select-none transition-colors",n==="vertical"&&"h-full w-2.5 border-l border-l-transparent p-[1px]",n==="horizontal"&&"h-2.5 flex-col border-t border-t-transparent p-[1px]",e),...r,children:t(le.ScrollAreaThumb,{className:"relative flex-1 rounded-full bg-border"})}));ha.displayName=le.ScrollAreaScrollbar.displayName;const rs=({className:e})=>{const[n,r]=x(!1),{organizationInvitations:a}=ma(),s=L(null);D(()=>{const c=l=>{s.current&&!s.current.contains(l.target)&&r(!1)};return document.addEventListener("mousedown",c),()=>{document.removeEventListener("mousedown",c)}},[]);const o=()=>{r(!n)};return i("div",{className:`relative ${e}`,ref:s,children:[i("button",{onClick:o,className:"relative p-1 rounded-full hover:bg-gray-100 transition-colors cursor-pointer","aria-label":"Notifications",children:[t(Rn,{className:"h-6 w-6 text-gray-700 hover:text-gray-900"}),a.length>0&&t("div",{className:"absolute -top-2 -right-1 h-4 w-4 flex items-center justify-center bg-blue-500 rounded-full",children:t("span",{className:"text-white text-sm",children:a.length})})]}),n&&t(ue,{className:"absolute top-full right-0 mt-2 w-80 shadow-md z-50",children:i(ie,{className:"p-0",children:[t("div",{className:"p-3 border-b",children:t("h3",{className:"font-medium",children:"Notifications"})}),a.length>0?t(Ct,{className:"max-h-[300px]",children:t("div",{className:"divide-y",children:a.map((c,l)=>t("div",{className:"p-3 hover:bg-muted/40",children:i("div",{className:"flex items-start gap-2",children:[t("div",{className:"h-9 w-9 rounded-full bg-primary/10 flex items-center justify-center text-primary",children:c.organization.name.charAt(0).toUpperCase()}),i("div",{className:"flex-1",children:[i("p",{className:"text-sm font-medium",children:["Invitation from ",c.organization.name]}),t("p",{className:"text-xs text-muted-foreground",children:"You've been invited to join this organization"}),t("div",{className:"mt-2 flex space-x-2",children:t(O,{asChild:!0,size:"sm",variant:"outline",className:"h-7 px-2 text-xs",children:i(J,{to:"/accept-invitation/$invitationId/$invitationEmail",params:{invitationId:c.id,invitationEmail:c.email},children:[t(En,{className:"h-3 w-3 mr-1"})," Accept invitation"]})})})]})]})},l))})}):t("div",{className:"p-6 text-center",children:t("p",{className:"text-muted-foreground text-sm",children:"No new notifications"})})]})})]})};function pa(){const{data:e,error:n}=Dr(),r=e,{data:a}=Lr(),s=Ce();D(()=>{n&&c()},[n]);const o=async(l,p)=>{await ut.setActive({organizationId:l}),await $r({query:{disableCookieCache:!0}}),s(p?{to:p}:{reloadDocument:!0})},c=async()=>{a&&r?.id&&a.filter(l=>l.id!==r.id).length>0?await o(a.filter(l=>l.id!==r.id)[0].id):a&&a.length>0?await o(a[0].id):await o("")};return{changeActiveOrganization:o,activeOrganization:r,changeActiveOrganizationIfAny:c}}function ss(e){const{changeActiveOrganization:n,changeActiveOrganizationIfAny:r}=pa(),{refetchInvitations:a}=ma(),[s,o]=x(!1),c=L(void 0);D(()=>{if(!(s||!e||c.current))return(async()=>await l())(),()=>{c.current&&(console.log("CLOSING DOWN"),c.current.close())}},[e]);const l=async()=>{if(!s){c.current&&c.current.close(),o(!0);try{c.current=await fe().eventStreamer.eventsStream(),c.current.socket.on("close",()=>{console.log("Socket closed, will attempt to reconnect if needed")}),c.current.socket.on("open",async()=>{console.log("EVENTSSTREAM ON OPEN HAPPENED!")}),c.current.socket.on("message",async d=>{if(d.data){const h=JSON.parse(d.data);h.notification&&p(h)}})}catch(d){console.error("Error connecting to chat:",d),o(!1)}}},p=async d=>{switch(d.notification.notificationType){case"ORGANIZATION_INVITATION":{await m(d);return}case"ORGANIZATION":{await f(d);return}default:throw new Error(`Unknown notification type: ${d.notification.notificationType}`)}},m=async d=>{const h=d.notification;switch(h.notificationHandling){case"ACCEPTED":await n(d.organizationId),G.info(`${h.memberName} accepted your invitation to join ${h.organizationName}.`);return;case"CANCELED":await a(),G.info(`Your invitation to join ${h.organizationName} has been canceled.`);return;case"RECEIVED":await a(),G.info(`You have been invited to join ${h.organizationName} by ${h.memberName}.`);return;case"REJECTED":await a(),G.info(`${h.memberName} rejected to join ${h.organizationName}.`);return;default:throw new Error(`Unknown notification type: ${d.notification.notificationType}`)}},f=async d=>{switch(d.notification.notificationHandling){case"KICKED":const h=d.notification;e===h.kickedMemberUserId&&(G.info(`You have been kicked from ${h.organizationName}.`),setTimeout(()=>r(),1e3));return;default:throw new Error(`Unknown notification type: ${d.notification.notificationType}`)}}}const fa=B("/create-organization")({head:()=>({meta:[{charSet:"utf-8"},{name:"viewport",content:"width=device-width, initial-scale=1"},{title:"IntelliOptima | Create Organization"},{about:""}]}),beforeLoad({context:e}){if(!e.user)throw we({to:"/sign-in"})},component:os}),Ft=[{id:1,label:"Organisation Info"},{id:2,label:"Details"},{id:3,label:"Invite"}];function os(){const e=ra(),{userId:n}=fa.useRouteContext(),[r,a]=x(1),[s,o]=x([!0,!1,!1]),[c,l]=x(""),[p,m]=x(""),[f,d]=x(""),[h,k]=x([]),[u,b]=x(),[w,y]=x(!1),I=s.filter(P=>P).length,j=(u==="enterprise"&&I===2||I>=2)&&c.length>1&&c.length<=50&&p.length>2&&p.length<=100&&u;ss(n);const{changeActiveOrganization:C}=pa(),E=async()=>{y(!0);try{const{data:P}=await ut.create({name:c,slug:c.toLowerCase().replace(/\s+/g,"-"),metadata:{description:p},userId:n});P?.id?(await Promise.all(h.map(async H=>{await ut.inviteMember({email:H.email,role:H.role,organizationId:P.id})})),G.success("Organization created successfully!"),setTimeout(async()=>await C(P.id,"/chat"),1500)):G.error("Failed to create organization. Please try again")}catch(P){G.error("Failed to create organization. Please try again."),console.error("Organization creation error:",P)}finally{y(!1)}};D(()=>{o(P=>(P[r-1]=!0,[...P]))},[r]);const g=()=>{u==="enterprise"&&r===2||r<Ft.length&&a(r+1)},T=()=>{r>1&&a(r-1)};return i("div",{className:"flex flex-col min-h-screen items-center bg-gradient-to-b from-background to-muted/30 p-4",children:[t("div",{className:"absolute top-4 right-4",children:t(rs,{})}),i(ge,{children:[t("div",{className:"w-2/3 mt-10",children:t(qr,{currentStep:r,paymentPlan:u,steps:Ft,onStepClick:P=>a(P),showLabels:!e})}),t("div",{className:"flex items-center justify-center w-full mt-10",children:(P=>{switch(P){case 1:return t(Ut,{name:c,setName:l,description:p,setDescription:m});case 2:return t(as,{invitees:h,paymentPlan:u,setPaymentPlan:b,setCurrentStep:a});case 3:return t(ts,{invitees:h,setInvitees:k});default:return t(Ut,{name:c,setName:l,description:p,setDescription:m})}})(r)}),i("div",{className:"w-1/5 flex justify-around gap-x-4 my-2",children:[t(O,{className:"w-full hover:cursor-pointer",disabled:r===1,onClick:T,children:" Go Back"}),t(O,{onClick:g,className:"w-full hover:cursor-pointer",disabled:w||u==="enterprise"&&r===2||r===3,children:w?"Loading...":"Next "})]}),t(O,{type:"button",disabled:!j,onClick:()=>E(),children:"Create your organization"})]})]})}const is=Se("app_routes_authed_tsx--checkExistingOrganization_createServerFn_handler","/_server"),cs=Ie().handler(is),ls=B("/_authed")({async beforeLoad({context:e,location:n}){if(!e.user?.id)throw we({to:"/sign-in"});if(await cs(),(n.href==="/organization-settings"||n.href==="/members")&&e?.session?.activeOrganizationMemberRole!=="owner"&&e?.session?.activeOrganizationMemberRole!=="admin")throw we({to:"/chat"})}}),ds=()=>import("./index-BOLL5CUm.js"),ga=B("/")({component:ae(ds,"component",()=>ga.ssr)}),us=()=>import("./_layout-CEOjo1CZ.js"),ms=Se("app_routes_authed_layout_tsx--getTeamspaces_createServerFn_handler","/_server"),ii=Ie().handler(ms),hs=Se("app_routes_authed_layout_tsx--getChatrooms_createServerFn_handler","/_server"),ci=Ie().handler(hs),ya=B("/_authed/_layout")({component:ae(us,"component",()=>ya.ssr)}),ps=()=>import("./_invitationId._invitationEmail-CPTbk5Ca.js"),va=B("/accept-invitation/$invitationId/$invitationEmail")({params:K.object({invitationId:K.string().min(10),invitationEmail:K.string().email()}),component:ae(ps,"component",()=>va.ssr)}),fs=()=>import("./index-B_4yKcTu.js"),ba=B("/_authed/_layout/team-chat/")({component:ae(fs,"component",()=>ba.ssr)}),gs=()=>import("./index-Dg-Zm9r1.js"),wa=B("/_authed/_layout/organizations/")({component:ae(gs,"component",()=>wa.ssr)}),ys=()=>import("./index-FnUY3CiM.js"),xa=B("/_authed/_layout/organization-settings/")({component:ae(ys,"component",()=>xa.ssr)}),vs=()=>import("./index-DbXztsa2.js"),Na=B("/_authed/_layout/members/")({component:ae(vs,"component",()=>Na.ssr)}),Ca=De(({blur:e=0,inactiveZone:n=.7,proximity:r=0,spread:a=20,variant:s="default",glow:o=!1,className:c,movementDuration:l=2,borderWidth:p=1,disabled:m=!0})=>{const f=L(null),d=L({x:0,y:0}),h=L(0),k=me(u=>{f.current&&(h.current&&cancelAnimationFrame(h.current),h.current=requestAnimationFrame(()=>{const b=f.current;if(!b)return;const{left:w,top:y,width:I,height:M}=b.getBoundingClientRect(),j=u?.x??d.current.x,C=u?.y??d.current.y;u&&(d.current={x:j,y:C});const E=[w+I*.5,y+M*.5],g=Math.hypot(j-E[0],C-E[1]),T=.5*Math.min(I,M)*n;if(g<T){b.style.setProperty("--active","0");return}const S=j>w-r&&j<w+I+r&&C>y-r&&C<y+M+r;if(b.style.setProperty("--active",S?"1":"0"),!S)return;const P=parseFloat(b.style.getPropertyValue("--start"))||0,_=(180*Math.atan2(C-E[1],j-E[0])/Math.PI+90-P+180)%360-180,$=P+_;Zn(P,$,{duration:l,ease:[.16,1,.3,1],onUpdate:W=>{b.style.setProperty("--start",String(W))}})}))},[n,r,l]);return D(()=>{if(m)return;const u=()=>k(),b=w=>k(w);return window.addEventListener("scroll",u,{passive:!0}),document.body.addEventListener("pointermove",b,{passive:!0}),()=>{h.current&&cancelAnimationFrame(h.current),window.removeEventListener("scroll",u),document.body.removeEventListener("pointermove",b)}},[k,m]),i(ge,{children:[t("div",{className:v("pointer-events-none absolute -inset-px hidden rounded-[inherit] border opacity-0 transition-opacity",o&&"opacity-100",s==="white"&&"border-white",m&&"!block")}),t("div",{ref:f,style:{"--blur":`${e}px`,"--spread":a,"--start":"0","--active":"0","--glowingeffect-border-width":`${p}px`,"--repeating-conic-gradient-times":"5","--gradient":s==="white"?`repeating-conic-gradient(
                  from 236.84deg at 50% 50%,
                  var(--black),
                  var(--black) calc(25% / var(--repeating-conic-gradient-times))
                )`:`radial-gradient(circle, #dd7bbb 10%, #dd7bbb00 20%),
                radial-gradient(circle at 40% 40%, #d79f1e 5%, #d79f1e00 15%),
                radial-gradient(circle at 60% 60%, #5a922c 10%, #5a922c00 20%), 
                radial-gradient(circle at 40% 60%, #4c7894 10%, #4c789400 20%),
                repeating-conic-gradient(
                  from 236.84deg at 50% 50%,
                  #dd7bbb 0%,
                  #d79f1e calc(25% / var(--repeating-conic-gradient-times)),
                  #5a922c calc(50% / var(--repeating-conic-gradient-times)), 
                  #4c7894 calc(75% / var(--repeating-conic-gradient-times)),
                  #dd7bbb calc(100% / var(--repeating-conic-gradient-times))
                )`},className:v("pointer-events-none absolute inset-0 rounded-[inherit] opacity-100 transition-opacity",o&&"opacity-100",e>0&&"blur-[var(--blur)] ",c,m&&"!hidden"),children:t("div",{className:v("glow","rounded-[inherit]",'after:content-[""] after:rounded-[inherit] after:absolute after:inset-[calc(-1*var(--glowingeffect-border-width))]',"after:[border:var(--glowingeffect-border-width)_solid_transparent]","after:[background:var(--gradient)] after:[background-attachment:fixed]","after:opacity-[var(--active)] after:transition-opacity after:duration-300","after:[mask-clip:padding-box,border-box]","after:[mask-composite:intersect]","after:[mask-image:linear-gradient(#0000,#0000),conic-gradient(from_calc((var(--start)-var(--spread))*1deg),#00000000_0deg,#fff,#00000000_calc(var(--spread)*2deg))]")})})]})});Ca.displayName="GlowingEffect";const Gt=[{id:"openai",name:"OpenAI",expanded:!0,agents:[{id:"gpt-4o",name:"GPT-4o",description:"Most capable agent"},{id:"gpt-4-turbo",name:"GPT-4 Turbo",description:"Fast and powerful"},{id:"gpt-3.5-turbo",name:"GPT-3.5 Turbo",description:"Balanced performance"}]},{id:"anthropic",name:"Anthropic",agents:[{id:"claude-3-opus",name:"Claude 3 Opus",description:"Most powerful Claude agent"},{id:"claude-3-sonnet",name:"Claude 3 Sonnet",description:"Balanced performance"},{id:"claude-3-haiku",name:"Claude 3 Haiku",description:"Fast responses"}]},{id:"meta",name:"Meta",agents:[{id:"llama-3-70b",name:"Llama 3 70B",description:"Largest Llama agent"},{id:"llama-3-8b",name:"Llama 3 8B",description:"Efficient performance"}]}];function bs({selectedAgents:e,onSelectAgents:n,isOpen:r,onClose:a,multiSelectMode:s=!1,maxSelections:o=4,searchTerm:c="",onAgentSelect:l,keyboardNavigation:p=!1}){const[m,f]=x(Gt),[d,h]=x("provider"),k=L(null),[u,b]=x(0),[w,y]=x([]);L(!1);const[I,M]=x(c);D(()=>{const g=T=>{k.current&&!k.current.contains(T.target)&&a()};return r&&document.addEventListener("mousedown",g),()=>{document.removeEventListener("mousedown",g)}},[r,a]),D(()=>{if(!r||!p)return;const g=T=>{if(T.key==="ArrowDown")T.preventDefault(),b(S=>S<w.length-1?S+1:S);else if(T.key==="ArrowUp")T.preventDefault(),b(S=>S>0?S-1:0);else if(T.key==="Enter"&&u>=0&&u<w.length){T.preventDefault(),T.stopPropagation();const S=w[u];l?l(S):C(S)}};return document.addEventListener("keydown",g,{capture:!0}),()=>{document.removeEventListener("keydown",g,{capture:!0})}},[r,p,u,w,l]),D(()=>{M(c)},[c]),D(()=>{if(!r)return;const g=c.toLowerCase(),T=Gt.map(P=>{const H=P.name.toLowerCase().includes(g),_=P.agents.filter(W=>W.name.toLowerCase().includes(g)),$=g?H||_.length>0:P.expanded;return{...P,expanded:$,agents:_}}).filter(P=>P.name.toLowerCase().includes(g)||P.agents.length>0);f(T);const S=[];T.forEach(P=>{P.expanded&&S.push(...P.agents)}),y(S),S.length>0&&b(0),g&&S.length===0&&a()},[c,r,a]);const j=g=>{f(m.map(T=>T.id===g?{...T,expanded:!T.expanded}:T))},C=g=>{const T=e.some(S=>S.id===g.id);s?T?n(e.filter(S=>S.id!==g.id)):e.length<o&&n([...e,g]):(n([g]),l||a())},E=g=>{const T=m.find(S=>S.id===g);return T?e.filter(S=>T.agents.some(P=>P.id===S.id)).length:0};return r?i("div",{ref:k,className:"w-72 bg-white rounded-lg shadow-lg border border-gray-200 z-50 h-[350px] flex flex-col",children:[i("div",{className:"flex border-b border-gray-200 flex-shrink-0",children:[t("button",{className:v("flex-1 py-2 text-sm font-medium",d==="provider"?"border-b-2 border-black":"text-gray-500"),onClick:()=>h("provider"),children:"AI Agents"}),t("button",{className:v("flex-1 py-2 text-sm font-medium",d==="agent"?"border-b-2 border-black":"text-gray-500"),onClick:()=>h("agent"),children:"Agents"})]}),c&&i("div",{className:"px-3 py-2 text-xs text-gray-500 border-b border-gray-200",children:['Searching for: "',c,'"']}),i("div",{className:"overflow-y-auto flex-1",children:[m.length===0&&t("div",{className:"p-3 text-sm text-gray-500",children:"No agents found"}),m.map(g=>{const T=E(g.id);return i("div",{className:"text-sm",children:[i("div",{className:"flex items-center px-3 py-2 hover:bg-gray-100 cursor-pointer",onClick:()=>j(g.id),children:[T>0&&t("div",{className:"flex items-center justify-center h-5 w-5 rounded-full bg-red-100 text-red-600 text-xs font-medium mr-1",children:T}),g.expanded?t(Fe,{className:"h-4 w-4 text-gray-500 mr-1"}):t(qt,{className:"h-4 w-4 text-gray-500 mr-1"}),t(_n,{className:"h-4 w-4 text-gray-500 mr-2"}),t("span",{children:g.name})]}),g.expanded&&g.agents.map(S=>{const P=e.some($=>$.id===S.id),_=w.findIndex($=>$.id===S.id)===u;return i("div",{className:v("flex items-center pl-10 pr-3 py-2 cursor-pointer",_?"bg-gray-200":"hover:bg-gray-100"),onClick:()=>{l?l(S):C(S)},children:[t(On,{className:"h-4 w-4 text-gray-500 mr-2"}),t("span",{className:"flex-1",children:S.name}),P&&t(Ue,{className:"h-4 w-4 text-red-500"})]},S.id)})]},g.id)})]})]}):null}function ws({...e}){return t(V.Root,{"data-slot":"dropdown-menu",...e})}function li({...e}){return t(V.Portal,{"data-slot":"dropdown-menu-portal",...e})}function xs({...e}){return t(V.Trigger,{"data-slot":"dropdown-menu-trigger",...e})}function Ns({className:e,sideOffset:n=4,...r}){return t(V.Portal,{children:t(V.Content,{"data-slot":"dropdown-menu-content",sideOffset:n,className:v("bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 min-w-[8rem] overflow-hidden rounded-md border p-1 shadow-md",e),...r})})}function di({...e}){return t(V.Group,{"data-slot":"dropdown-menu-group",...e})}function ui({className:e,inset:n,variant:r="default",...a}){return t(V.Item,{"data-slot":"dropdown-menu-item","data-inset":n,"data-variant":r,className:v("focus:bg-accent hover:cursor-pointer focus:text-accent-foreground data-[variant=destructive]:text-destructive data-[variant=destructive]:focus:bg-destructive/10 data-[variant=destructive]:focus:text-destructive data-[variant=destructive]:*:[svg]:!text-destructive [&_svg:not([class*='text-'])]:text-muted-foreground relative flex cursor-default items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-hidden select-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 data-[inset]:pl-8 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",e),...a})}function Cs({className:e,children:n,checked:r,...a}){return i(V.CheckboxItem,{"data-slot":"dropdown-menu-checkbox-item",className:v("focus:bg-accent focus:text-accent-foreground relative flex cursor-default items-center gap-2 rounded-sm py-1.5 pr-2 pl-8 text-sm outline-hidden select-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",e),checked:r,...a,children:[t("span",{className:"pointer-events-none absolute left-2 flex size-3.5 items-center justify-center",children:t(V.ItemIndicator,{children:t(Mn,{className:"size-4"})})}),n]})}function mi({className:e,inset:n,...r}){return t(V.Label,{"data-slot":"dropdown-menu-label","data-inset":n,className:v("px-2 py-1.5 text-sm font-semibold data-[inset]:pl-8",e),...r})}function hi({className:e,...n}){return t(V.Separator,{"data-slot":"dropdown-menu-separator",className:v("bg-border -mx-1 my-1 h-px",e),...n})}function pi({...e}){return t(V.Sub,{"data-slot":"dropdown-menu-sub",...e})}function fi({className:e,inset:n,children:r,...a}){return i(V.SubTrigger,{"data-slot":"dropdown-menu-sub-trigger","data-inset":n,className:v("focus:bg-accent hover:cursor-pointer focus:text-accent-foreground data-[state=open]:bg-accent data-[state=open]:text-accent-foreground flex cursor-default items-center rounded-sm px-2 py-1.5 text-sm outline-hidden select-none data-[inset]:pl-8",e),...a,children:[r,t(jn,{className:"ml-auto size-4"})]})}function gi({className:e,...n}){return t(V.SubContent,{"data-slot":"dropdown-menu-sub-content",className:v("bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 min-w-[8rem] overflow-hidden rounded-md border p-1 shadow-lg",e),...n})}function Is(e,n=1){const r=L(null);return dn(()=>{const a=r.current;if(a){const s=window.getComputedStyle(a),o=Number.parseInt(s.lineHeight,10)||20,c=Number.parseInt(s.paddingTop,10)+Number.parseInt(s.paddingBottom,10),l=o*n+c;a.style.height="0px";const p=Math.max(a.scrollHeight,l);a.style.height=`${p+2}px`}},[r,e,n]),r}const{Children:Ts,isValidElement:Ss,cloneElement:ks}=Z,Ee=e=>e.includes("gpt")?t(tt,{className:"h-5 w-5"}):e.includes("claude")?t(Dn,{className:"h-5 w-5"}):e.includes("llama")?t(Un,{className:"h-5 w-5"}):t(tt,{className:"h-5 w-5"}),Bt={id:"gpt-4o",name:"GPT-4o",description:"Most capable model"},It=un({}),Ht=["What's the first rule of Fight Club?","Who is Tyler Durden?","Where is Andrew Laeddis Hiding?","Write a Javascript method to reverse a string","How to assemble your own PC?","Explain quantum computing in simple terms","Write a short story about a robot that falls in love","What are the ethical implications of AI?","Design a database schema for a social media app","Explain how blockchain works to a 5-year-old","Create a regex for validating email addresses","What's the difference between REST and GraphQL?","Suggest five names for my tech startup","How would you implement a binary search tree?","Explain the concept of recursion with an example","Write a haiku about coding at midnight","What's the significance of P vs NP problem?","How does natural language processing work?","Explain the CAP theorem in distributed systems","Design a simple chatbot algorithm","What are the pros and cons of microservices?","How would you optimize a slow-loading website?","Explain neural networks without technical jargon","What is technical debt and how do you manage it?","Write a function to detect a palindrome"],Ps=[{id:"openai",name:"OpenAI",expanded:!0,agents:[{id:"gpt-4o",name:"GPT-4o",description:"Most capable agent"},{id:"gpt-4-turbo",name:"GPT-4 Turbo",description:"Fast and powerful"},{id:"gpt-3.5-turbo",name:"GPT-3.5 Turbo",description:"Balanced performance"}]},{id:"anthropic",name:"Anthropic",agents:[{id:"claude-3-opus",name:"Claude 3 Opus",description:"Most powerful Claude agent"},{id:"claude-3-sonnet",name:"Claude 3 Sonnet",description:"Balanced performance"},{id:"claude-3-haiku",name:"Claude 3 Haiku",description:"Fast responses"}]},{id:"meta",name:"Meta",agents:[{id:"llama-3-70b",name:"Llama 3 70B",description:"Largest Llama agent"},{id:"llama-3-8b",name:"Llama 3 8B",description:"Efficient performance"}]}];function Ge({children:e,className:n,variant:r="default",value:a,onChange:s,onSubmit:o,loading:c,onStop:l,rows:p=1,hasMessages:m=!1,onAISelect:f,onMentionSelectionChange:d}){const[h,k]=x(0),u=L(null),b=ra(),w=L(null),y=L(null),[I,M]=x(new Set),[j,C]=x(!1),[E,g]=x([Bt]),[T,S]=x(!1),[P,H]=x(!1),[_,$]=x(null),W=L([]),q=L(-1),[ve,Ve]=x(a||""),[Po,Oa]=x(0),[St,kt]=x({top:0,left:10}),[Ao,ja]=x([]),Ma=N=>{if(_!==null&&T){if(N.key==="Enter"){N.preventDefault();return}else if(N.key==="Escape"){N.preventDefault(),S(!1),$(null),q.current=-1,d&&d(!1);return}}if(N.key==="Enter"&&!N.shiftKey&&o){if(typeof ve!="string"||ve.trim().length===0)return;if(_!==null){N.preventDefault();return}N.preventDefault(),o()}};D(()=>{if(T&&w.current){const N=w.current.getBoundingClientRect();kt({top:N.top-370,left:N.left+10});const A=()=>{if(w.current){const R=w.current.getBoundingClientRect();kt({top:R.top-370,left:R.left+10})}};return window.addEventListener("resize",A),()=>window.removeEventListener("resize",A)}},[T]);const We=()=>{u.current=setInterval(()=>{k(N=>(N+1)%Ht.length)},4e3)},Pt=()=>{document.visibilityState!=="visible"&&u.current?(clearInterval(u.current),u.current=null):document.visibilityState==="visible"&&!m&&We()};D(()=>(m||We(),document.addEventListener("visibilitychange",Pt),()=>{u.current&&clearInterval(u.current),document.removeEventListener("visibilitychange",Pt)}),[m]),D(()=>{m&&u.current?(clearInterval(u.current),u.current=null):!m&&!u.current&&We()},[m]),D(()=>{a!==void 0&&Ve(a)},[a]);const At=[{icon:t(Gn,{className:"h-4 w-4"}),label:"Web-Search",description:"Quick web look-up"},{icon:t(Bn,{className:"h-4 w-4"}),label:"Deep-Research",description:"Deep web research, on specific input"},{icon:t(tt,{className:"h-4 w-4"}),label:"Reasoning",description:"Think deeply, before answering"}],Rt=N=>{M(A=>{const R=new Set(A);return R.has(N)?R.delete(N):R.add(N),R})},$a=N=>{H(N),S(!0)},Et=()=>{P?(H(!1),g([Bt]),S(!1)):$a(!0)};D(()=>{if(T&&_!==null){const N=[];Ps.forEach(A=>{const R=A.agents.filter(z=>_?z.name.toLowerCase().includes(_.toLowerCase()):!0);N.push(...R.map(z=>({id:z.id,name:z.name,description:z.description})))}),ja(N),Oa(N.length>0?0:-1)}},[_,T]);const _t=N=>{const A=[];let R=0;for(;R<N.length;){const z=N.indexOf("@",R);if(z===-1)break;if(!(z===0||N[z-1]===" ")){R=z+1;continue}let Q=N.indexOf(" ",z+1);Q===-1&&(Q=N.length),A.push({start:z,end:Q,consumed:!1}),R=Q}return A},za=N=>{const A=N.target.value;Ve(A),s&&s(N);const R=_t(A);if(W.current=R,R.length===0){$(null),T&&!P&&S(!1),q.current=-1,d&&d(!1);return}const z=R[R.length-1];if(z.end===A.length){const Q=A.slice(z.start+1,z.end);$(Q),q.current=R.length-1,T||(S(!0),H(!1)),d&&d(!0)}else _!==null&&($(null),T&&!P&&S(!1),q.current=-1,d&&d(!1))},La=N=>{const A={id:N.id,name:N.name,description:N.description,icon:Ee(N.id)};if(_!==null&&q.current>=0){const R=W.current[q.current];if(R&&y.current){const z=ve.substring(0,R.start),Y=ve.substring(R.end),Q=z+`@${A.name}`+(Y.startsWith(" ")?"":" ")+Y;if(Ve(Q),s&&y.current){const be=Object.getOwnPropertyDescriptor(window.HTMLTextAreaElement.prototype,"value")?.set;if(be){be.call(y.current,Q);const Fa=new Event("input",{bubbles:!0});y.current.dispatchEvent(Fa)}}g([A]),S(!1),$(null),q.current=-1,d&&d(!1);const Ua=_t(Q);W.current=Ua,setTimeout(()=>{if(y.current){y.current.focus();const be=z.length+`@${A.name} `.length;y.current.selectionStart=be,y.current.selectionEnd=be}},0)}}},Ot={value:ve,onChange:za,onSubmit:o,loading:c,onStop:l,variant:r,rows:p,placeholder:m?"Type a message...":Ht[h],hasMessages:m,onAISelect:f,onMentionSelectionChange:d},Da=()=>{const N=I.size;return b?t("div",{className:"flex items-center justify-center py-3 px-2",children:i(ws,{open:j,onOpenChange:C,children:[t(xs,{asChild:!0,children:i(O,{variant:"ghost",className:"h-8 px-4 rounded-full flex items-center gap-2 bg-gray-100 text-gray-600 hover:bg-gray-200",children:[t(Fn,{className:"h-4 w-4"}),i("span",{className:"text-xs font-medium",children:["Tools ",N>0&&`(${N})`]})]})}),t(Ns,{align:"end",className:"w-56",onCloseAutoFocus:A=>A.preventDefault(),children:At.map((A,R)=>t(Cs,{checked:I.has(R),onCheckedChange:()=>Rt(R),onSelect:z=>z.preventDefault(),children:i("div",{className:"flex items-center gap-2",children:[A.icon,t("span",{children:A.label})]})},A.label))})]})}):t("div",{className:"flex flex-wrap items-center gap-2 py-3 px-2",children:At.map((A,R)=>i(O,{variant:"ghost",className:`h-8 px-4 rounded-full flex items-center gap-2 ${I.has(R)?"bg-gray-300 text-gray-800 hover:bg-gray-300":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,onClick:()=>Rt(R),children:[A.icon,t("span",{className:"text-xs font-medium",children:A.label})]},A.label))})};return t(It.Provider,{value:Ot,children:i("div",{className:"relative w-full",children:[T&&t("div",{className:"fixed z-[999] shadow-lg",style:{top:`${St.top}px`,left:`${St.left}px`},children:t(bs,{selectedAgents:E.map(N=>({id:N.id,name:N.name,description:N.description})),onSelectAgents:N=>{_||g(N.map(A=>({id:A.id,name:A.name,description:A.description,icon:Ee(A.id)})))},isOpen:T,onClose:()=>{S(!1),$(null),q.current=-1,d&&d(!1)},multiSelectMode:P,maxSelections:4,searchTerm:_||"",onAgentSelect:_!==null?La:void 0,keyboardNavigation:_!==null})}),i("div",{ref:w,className:v("relative",r==="default"&&"flex flex-col items-end w-full p-2 rounded-2xl border border-input bg-transparent focus-within:ring-1 focus-within:ring-slate-300 focus-within:outline-none",r==="unstyled"&&"flex items-start gap-2 w-full",n),children:[t(Ca,{blur:0,borderWidth:1.7,spread:25,glow:!0,disabled:!1,proximity:64,inactiveZone:.01}),i("div",{className:"relative flex flex-col items-end w-full z-10",children:[i("div",{className:"flex w-full items-end",children:[t(O,{type:"button",variant:"ghost",size:"icon",className:"h-10 w-10 rounded-full hover:bg-gray-100 mr-2",onClick:Et,children:Ee(E[0].id)}),Ts.map(e,N=>{if(Ss(N)){const A=N.type;if(A&&(A.displayName==="ChatInputTextArea"||A===Pe))return ks(N,{ref:z=>{y.current=z;const Y=N.ref;typeof Y=="function"?Y(z):Y&&"current"in Y&&(Y.current=z)},placeholder:_!==null?"Type model name...":Ot.placeholder,onKeyDown:Ma})}return N})]}),t("div",{className:"flex w-full items-center justify-between mt-2",children:i("div",{className:"flex items-center gap-2",children:[P&&E.length>1&&i("div",{className:"flex items-center gap-1",children:[t("div",{className:"flex -space-x-1",children:E.slice(0,2).map((N,A)=>t("div",{className:"h-5 w-5 rounded-full bg-gray-100 flex items-center justify-center border border-white",children:N.icon||Ee(N.id)},N.id))}),i("span",{className:"text-xs text-gray-500",children:[E.length," models"]})]}),i(O,{type:"button",variant:"ghost",className:v("h-8 rounded-full px-3 flex items-center gap-1.5 text-xs font-normal",P?"bg-red-50 text-red-600 hover:bg-red-100":"bg-gray-100 hover:bg-gray-100"),onClick:Et,children:[t($n,{className:"h-4 w-4"}),t("span",{children:"Multiprompt"})]}),Da()]})})]})]})]})})}Ge.displayName="ChatInput";function Pe({onSubmit:e,value:n,onChange:r,className:a,variant:s,...o}){const c=Vt(It),[l,p]=x(""),m=n??c.value??l,f=r??c.onChange,d=e??c.onSubmit,h=c.rows??1,k=c.placeholder||"",u=c.hasMessages||!1,b=L(null),w=s??(c.variant==="default"?"unstyled":"default"),y=Is(m,h),I=me(C=>{y&&(typeof y=="function"?y(C):"current"in y&&(y.current=C)),b.current=C},[y]);return i("div",{className:"relative w-full",children:[t(Nt,{ref:I,...o,value:m,onChange:C=>{f?f(C):p(C.target.value)},onKeyDown:C=>{if(d&&C.key==="Enter"&&!C.shiftKey){if(typeof m!="string"||m.trim().length===0)return;C.preventDefault(),d()}},className:v("max-h-[400px] min-h-0 resize-none overflow-x-hidden",w==="unstyled"&&"border-none focus-visible:ring-0 focus-visible:ring-offset-0 shadow-none",a),rows:h,placeholder:void 0}),!m&&t("div",{className:"absolute pointer-events-none top-0 left-0 right-0 bottom-0 flex items-center px-3 py-2",children:t(Yn,{mode:"wait",children:u?t("span",{className:"text-muted-foreground truncate",children:k}):t(Qn.span,{initial:{opacity:0,y:-5},animate:{opacity:.5,y:0},exit:{opacity:0,y:5},transition:{duration:.3},className:"text-muted-foreground truncate",children:k},k)})})]})}Pe.displayName="ChatInputTextArea";function Be({onSubmit:e,loading:n,onStop:r,className:a,...s}){const o=Vt(It),c=n??o.loading,l=r??o.onStop,p=e??o.onSubmit;if(c&&l)return t(O,{onClick:l,className:v("shrink-0 rounded-full p-1.5 h-fit border dark:border-zinc-600 hover:cursor-pointer",a),...s,children:i("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"currentColor",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round","aria-label":"Stop",children:[t("title",{children:"Stop"}),t("rect",{x:"6",y:"6",width:"12",height:"12"})]})});const m=typeof o.value!="string"||o.value.trim().length===0,f=o.audio;return i("div",{className:"flex gap-1",children:[t(O,{className:v("shrink-0 rounded-full p-1.5 h-fit border dark:border-zinc-600 hover:cursor-pointer",a),disabled:m,onClick:d=>{d.preventDefault(),m||p?.()},...s,children:t(zn,{})}),t(O,{className:v("shrink-0 rounded-full p-1.5 h-fit border bg-red-500 hover:bg-red-600/95! dark:border-zinc-600 hover:cursor-pointer",a),disabled:f,onClick:d=>{d.preventDefault(),m||p?.()},...s,children:t(Ln,{})})]})}Be.displayName="ChatInputSubmit";function Xe(e){switch(e){case"OWNER":return"ADMIN";case"ADMIN":return"MANAGER";case"CONTRIBUTOR":return"PROMPT_AIS";case"VIEWER":return"READ";default:return"READ"}}function As({currentUserId:e,project:n,teamspace:r}){const a=[{chatroomId:"",role:"ADMIN",userId:e}];if(n){if(n.members.length<1)return[];n.members.forEach(s=>{s.user.id!==e&&a.push({chatroomId:"",role:Xe(s.role),userId:s.user.id})}),!n.isPrivate&&r&&r.members.forEach(s=>{a.some(c=>c.userId===s.user.id)||a.push({chatroomId:"",role:Xe(s.role),userId:s.user.id})})}else if(r){if(r.members.length<1)return[];r.members.forEach(s=>{s.user.id!==e&&a.push({chatroomId:"",role:Xe(s.role),userId:s.user.id})})}return a}function yi(e,n=!1){return[...e].sort((r,a)=>{const s=r.messages?.length?r.messages.reduce((p,m)=>{const f=new Date(p.createdAt).getTime();return new Date(m.createdAt).getTime()>f?m:p},r.messages[0]):null,o=a.messages?.length?a.messages.reduce((p,m)=>{const f=new Date(p.createdAt).getTime();return new Date(m.createdAt).getTime()>f?m:p},a.messages[0]):null,c=s?new Date(s.createdAt).getTime():new Date(r.updatedAt||r.createdAt).getTime(),l=o?new Date(o.createdAt).getTime():new Date(a.updatedAt||a.createdAt).getTime();return n?c-l:l-c})}function vi(e){return e.messages?.length?new Date(e.messages.reduce((n,r)=>new Date(r.createdAt)>new Date(n.createdAt)?r:n,e.messages[0]).createdAt):new Date(e.updatedAt)}function Rs(e,n){return e.members.find(r=>r.user.id===n)}const Es=X([]),_s=X(),Os=X(),js=X([]),He=X(),bi=X({});X(null);X("projects");const wi=X({});X({});const Ia=B("/_authed/_layout/chat/")({component:Ms});function Ms({className:e,...n}){const r=Ce(),a=qe(Es),s=Qe(js),o=Ia.useRouteContext(),[c]=x(o.userId),[l,p]=x(""),m=qe(_s),f=qe(Os),d=a?.find(w=>w.id===m),h=d?.projects?.find(w=>w.id===f),k=Qe(He),u=async()=>{if(l.trim())try{const w=As({currentUserId:c,project:h,teamspace:d}),{data:y}=await fe().chatrooms.createChatroom({chatroomCreatorId:c,chatroomMembers:w,isPrivate:h?.isPrivate||!1,projectId:h?.id,name:"New Chat Conversation",teamIds:[],type:"CHATROOM"});h?h.chatrooms?.push(y):s(I=>[...I,y]),console.log("New chatroom created:",y),k(y),localStorage.setItem("pendingMessage",l),r({to:"/chat/$chatroomId",params:{chatroomId:y.id}})}catch(w){console.error("Error creating chatroom:",w);return}},b=i(Ge,{value:l,onChange:w=>p(w.target.value),onSubmit:u,hasMessages:!1,children:[t(Pe,{placeholder:"Type a message...",autoFocus:!0,disabled:!1,onKeyDown:w=>{w.key==="Enter"&&!w.shiftKey&&(w.preventDefault(),u())}}),t(Be,{disabled:!l.trim()})]});return t("div",{className:"flex-1 flex flex-col h-full",...n,children:i("div",{className:"flex-1 flex flex-col justify-center items-center",children:[t("div",{children:t("h3",{className:"text-2xl font-bold mb-6 font-mono",children:"What are we solving today?"})}),t("div",{className:"px-2 py-4 max-w-4xl mx-auto w-full",children:b})]})})}const $s=()=>import("./_teamspaceId-DSVOHVhG.js"),Ta=B("/_authed/_layout/teamspace/$teamspaceId")({params:K.object({teamspaceId:K.string()}),component:ae($s,"component",()=>Ta.ssr)}),zs=()=>import("./_projectId-DFGTUSU4.js"),Sa=B("/_authed/_layout/project/$projectId")({params:K.object({projectId:K.string()}),component:ae(zs,"component",()=>Sa.ssr)});function Ls(){const e=L(null),[n,r]=x(!1),[a,s]=x(!0),o=L(!1),c=L(!1),l=L(!1),p=L(!1),m=me(u=>u?.closest("[data-radix-scroll-area-viewport]"),[]),f=me(u=>{const{scrollTop:b,scrollHeight:w,clientHeight:y}=u;return Math.abs(w-b-y)<10},[]),d=me(u=>{u&&u.scrollTo({top:u.scrollHeight,behavior:"instant"})},[]),h=me(u=>{const{scrollHeight:b,clientHeight:w}=u,y=b>w,I=f(u);r(y&&!I),c.current||s(I)},[f]);return D(()=>{const u=e.current,b=m(u);if(!u||!b)return;d(b);const w=setTimeout(()=>{o.current||(d(b),p.current=!0)},200),y=new ResizeObserver(()=>{!p.current&&!o.current&&d(b)});return y.observe(u),()=>{clearTimeout(w),y.disconnect()}},[m,d]),D(()=>{const u=e.current,b=m(u);if(!u||!b)return;h(b);const w=()=>{p.current||(p.current=!0),l.current||(o.current=!0),c.current||h(b)},y=()=>{c.current=!0,o.current=!0},I=()=>{c.current=!1,h(b)},M=()=>{c.current=!0,o.current=!0,setTimeout(()=>{c.current=!1,h(b)},200)};let j;const C=new MutationObserver(()=>{l.current=!0,window.clearTimeout(j),(a&&!o.current||a&&p.current&&!c.current)&&b.scrollTo({top:b.scrollHeight,behavior:"instant"}),h(b),j=window.setTimeout(()=>{l.current=!1},100)});return b.addEventListener("scroll",w,{passive:!0}),b.addEventListener("touchstart",y),b.addEventListener("touchend",I),b.addEventListener("wheel",M,{passive:!0}),C.observe(u,{childList:!0,subtree:!0,attributes:!0,characterData:!0}),()=>{window.clearTimeout(j),C.disconnect(),b.removeEventListener("scroll",w),b.removeEventListener("touchstart",y),b.removeEventListener("touchend",I),b.removeEventListener("wheel",M)}},[m,h,a]),[e,n,()=>{const u=m(e.current);u&&(s(!0),o.current=!1,u.scrollTo({top:u.scrollHeight,behavior:l.current?"instant":"smooth"}))}]}function Ds({onClick:e,alignment:n="right",className:r}){return t(O,{variant:"secondary",size:"icon",className:v("absolute bottom-4 rounded-full shadow-lg hover:bg-secondary",{left:"left-4",center:"left-1/2 -translate-x-1/2",right:"right-4"}[n],r),onClick:e,children:t(Fe,{className:"h-4 w-4"})})}const Tt=mn(({children:e,className:n,scrollButtonAlignment:r="right"},a)=>{const[s,o,c]=Ls();return i(Ct,{className:"flex-1 relative",ref:a,children:[t("div",{ref:s,children:t("div",{className:v(n,"min-h-0 z-10"),children:e})}),o&&t(Ds,{onClick:c,alignment:r,className:"absolute bottom-4 rounded-full shadow-lg hover:bg-secondary"})]})});Tt.displayName="ChatMessageArea";const ht="my-4 overflow-x-auto w-fit rounded-xl text-zinc-50 bg-zinc-900 dark:bg-zinc-900 border border-border p-4",pt=e=>typeof e=="string"?e:Array.isArray(e)?e.map(pt).join(""):pn(e)?pt(e.props.children):"",ka=De(async({children:e,className:n,language:r,...a})=>{const{codeToTokens:s,bundledLanguages:o}=await import("shiki"),c=pt(e);if(!(r in o))return t("pre",{...a,className:v(ht,n),children:t("code",{className:"whitespace-pre-wrap",children:e})});const{tokens:l}=await s(c,{lang:r,themes:{light:"github-dark",dark:"github-light"}});return t("pre",{...a,className:v(ht,n),children:t("code",{className:"whitespace-pre-wrap",children:l.map((p,m)=>i("span",{children:[p.map((f,d)=>{const h=typeof f.htmlStyle=="string"?void 0:f.htmlStyle;return t("span",{style:h,children:f.content},`token-${d}`)}),m!==l.length-1&&`
`]},`line-${m}`))})})});ka.displayName="HighlightedPre";const Pa=({children:e,language:n,className:r,...a})=>t(hn,{fallback:t("pre",{...a,className:v(ht,r),children:t("code",{className:"whitespace-pre-wrap",children:e})}),children:t(ka,{language:n,...a,children:e})});Pa.displayName="CodeBlock";const Us={h1:({children:e,...n})=>t("h1",{className:"mt-2 scroll-m-20 text-4xl font-bold",...n,children:e}),h2:({children:e,...n})=>t("h2",{className:"mt-8 scroll-m-20 border-b pb-2 text-2xl font-semibold tracking-tight first:mt-0",...n,children:e}),h3:({children:e,...n})=>t("h3",{className:"mt-4 scroll-m-20 text-xl font-semibold tracking-tight",...n,children:e}),h4:({children:e,...n})=>t("h4",{className:"mt-4 scroll-m-20 text-lg font-semibold tracking-tight",...n,children:e}),h5:({children:e,...n})=>t("h5",{className:"mt-4 scroll-m-20 text-lg font-semibold tracking-tight",...n,children:e}),h6:({children:e,...n})=>t("h6",{className:"mt-4 scroll-m-20 text-base font-semibold tracking-tight",...n,children:e}),p:({children:e,...n})=>t("p",{className:"leading-6 [&:not(:first-child)]:mt-4",...n,children:e}),strong:({children:e,...n})=>t("span",{className:"font-semibold",...n,children:e}),a:({children:e,...n})=>t("a",{className:"font-medium underline underline-offset-4",target:"_blank",rel:"noreferrer",...n,children:e}),ol:({children:e,...n})=>t("ol",{className:"my-4 ml-6 list-decimal",...n,children:e}),ul:({children:e,...n})=>t("ul",{className:"my-4 ml-6 list-disc",...n,children:e}),li:({children:e,...n})=>t("li",{className:"mt-2",...n,children:e}),blockquote:({children:e,...n})=>t("blockquote",{className:"mt-4 border-l-2 pl-6 italic",...n,children:e}),hr:e=>t("hr",{className:"my-4 md:my-8",...e}),table:({children:e,...n})=>t("div",{className:"my-6 w-full overflow-y-auto",children:t("table",{className:"relative w-full overflow-hidden border-none text-sm",...n,children:e})}),tr:({children:e,...n})=>t("tr",{className:"last:border-b-none m-0 border-b",...n,children:e}),th:({children:e,...n})=>t("th",{className:"px-4 py-2 text-left font-bold [&[align=center]]:text-center [&[align=right]]:text-right",...n,children:e}),td:({children:e,...n})=>t("td",{className:"px-4 py-2 text-left [&[align=center]]:text-center [&[align=right]]:text-right",...n,children:e}),img:({alt:e,...n})=>t("img",{className:"rounded-md",alt:e,...n}),code:({children:e,node:n,className:r,...a})=>{const s=/language-(\w+)/.exec(r||"");return s?t(Pa,{language:s[1],className:r,...a,children:e}):t("code",{className:v("rounded bg-muted px-[0.3rem] py-[0.2rem] font-mono text-sm",r),...a,children:e})},pre:({children:e})=>t(ge,{children:e})};function Fs(e){return e?rr.lexer(e).map(r=>r.raw):[]}const Aa=De(({content:e,className:n})=>t(sr,{remarkPlugins:[or],components:Us,className:n,children:e}),(e,n)=>e.content===n.content);Aa.displayName="MemoizedMarkdownBlock";const ft=De(({content:e,id:n,className:r})=>Ze(()=>Fs(e||""),[e]).map((s,o)=>t(Aa,{content:s,className:r},`${n}-block_${o}`)));ft.displayName="MarkdownContent";const Gs=({children:e,url:n,className:r,width:a=200,height:s=125,isStatic:o=!1,imageSrc:c=""})=>{let l;o?l=c:l=`https://api.microlink.io/?${ir({url:n,screenshot:!0,meta:!1,embed:"screenshot.url",colorScheme:"dark","viewport.isMobile":!0,"viewport.deviceScaleFactor":1,"viewport.width":a*3,"viewport.height":s*3})}`;const[p,m]=Z.useState(!1),[f,d]=Z.useState(!1);Z.useEffect(()=>{d(!0)},[]);const h={stiffness:100,damping:15},k=er(0),u=tr(k,h),b=w=>{const y=w.target.getBoundingClientRect(),M=(w.clientX-y.left-y.width/2)/2;k.set(M)};return i(ge,{children:[f?t("div",{className:"hidden",children:t("img",{src:l,width:a,height:s,alt:"hidden image"})}):null,i(Je.Root,{openDelay:50,closeDelay:100,onOpenChange:w=>{m(w)},children:[t(Je.Trigger,{onMouseMove:b,className:v("text-black dark:text-white",r),href:n,target:"_blank",rel:"noopener noreferrer",children:e}),t(Je.Content,{className:"[transform-origin:var(--radix-hover-card-content-transform-origin)]",side:"top",align:"center",sideOffset:10,children:t(ar,{children:p&&t(nr.div,{initial:{opacity:0,y:20,scale:.6},animate:{opacity:1,y:0,scale:1,transition:{type:"spring",stiffness:260,damping:20}},exit:{opacity:0,y:20,scale:.6},className:"shadow-xl rounded-xl",style:{x:u},children:t(J,{to:n,className:"block p-1 bg-white border-2 border-transparent shadow rounded-xl hover:border-neutral-200 dark:hover:border-neutral-800",style:{fontSize:0},target:"_blank",rel:"noopener noreferrer",children:t("img",{src:o?c:l,width:a,height:s,className:"rounded-lg",alt:"preview image"})})})})})]})]})},Bs=Te("flex gap-4 w-full",{variants:{variant:{default:"",bubble:"",full:"p-5"},type:{incoming:"justify-start mr-auto",outgoing:"justify-end ml-auto"}},compoundVariants:[{variant:"full",type:"outgoing",className:"bg-muted"},{variant:"full",type:"incoming",className:"bg-background"}],defaultVariants:{variant:"default",type:"incoming"}}),Ra=Z.createContext(null),Ea=()=>Z.useContext(Ra),gt=Z.forwardRef(({className:e,variant:n="default",type:r="incoming",id:a,children:s,...o},c)=>t(Ra.Provider,{value:{variant:n,type:r,id:a},children:t("div",{ref:c,className:v(Bs({variant:n,type:r,className:e})),...o,children:s})}));gt.displayName="ChatMessage";const Hs=Te("w-8 h-8 flex items-center rounded-full justify-center ring-1 shrink-0 bg-transparent overflow-hidden",{variants:{type:{incoming:"ring-border",outgoing:"ring-muted-foreground/30"}},defaultVariants:{type:"incoming"}}),yt=Z.forwardRef(({className:e,icon:n,imageSrc:r,...a},s)=>{const c=Ea()?.type??"incoming",l=n??(c==="incoming"?t($e,{}):t(ze,{}));return t("div",{ref:s,className:v(Hs({type:c,className:e})),...a,children:r?t("img",{src:r,alt:"Avatar",className:"h-full w-full object-cover"}):t("div",{className:"translate-y-px [&_svg]:size-4 [&_svg]:shrink-0",children:l})})});yt.displayName="ChatMessageAvatar";const Vs=Te("flex flex-col gap-2",{variants:{variant:{default:"",bubble:"rounded-xl px-3 py-2",full:""},type:{incoming:"",outgoing:""}},compoundVariants:[{variant:"bubble",type:"incoming",className:"bg-secondary text-secondary-foreground"},{variant:"bubble",type:"outgoing",className:"bg-primary text-primary-foreground"}],defaultVariants:{variant:"default",type:"incoming"}}),Ws=()=>i("div",{className:"relative overflow-hidden",children:[t("span",{className:"text-sm text-muted-foreground",children:"View thinking process"}),t("div",{className:"absolute inset-0 bg-gradient-to-r from-transparent via-white/50 to-transparent animate-[shimmer_2s_infinite]"})]}),vt=Z.forwardRef(({className:e,content:n,id:r,showCursor:a=!1,reasoning:s="",isReasoning:o=!1,sources:c=[],children:l,...p},m)=>{const f=Ea(),[d,h]=Z.useState(!1),k=f?.variant??"default",u=f?.type??"incoming",b=r??f?.id??"";return i("div",{ref:m,className:v(Vs({variant:k,type:u,className:e})),...p,children:[s&&s.length>0&&i("div",{className:"w-full mt-2 border rounded-md overflow-hidden",children:[i("button",{type:"button",onClick:()=>h(!d),className:"w-full flex items-center justify-between px-3 py-4 text-sm text-muted-foreground bg-[#F8FAFC] hover:cursor-pointer transition-colors",children:[t("span",{children:n===""?t(Ws,{}):"View thinking process"}),t("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:`h-4 w-4 shrink-0 transition-transform duration-200 ${d?"rotate-180":""}`,children:t("path",{d:"m6 9 6 6 6-6"})})]}),d&&t("div",{className:"bg-[#F8FAFC] px-3 py-4 text-sm whitespace-pre-wrap",children:t(ft,{id:`${b}-reasoning`,content:s})})]}),n.length>0&&i(ge,{children:[t(ft,{id:b,content:n}),a&&t("span",{className:"ml-1 inline-block h-4 w-2 animate-pulse bg-current"})]}),c&&c.length>0&&i("div",{className:"mt-3 border-t pt-2 text-sm",children:[t("p",{className:"font-medium text-muted-foreground mb-2",children:"Sources:"}),t("div",{className:"space-y-2",children:c.map((w,y)=>i("div",{className:"flex items-start gap-2",children:[i("span",{className:"text-xs text-muted-foreground mt-1",children:["[",y+1,"]"]}),t(Gs,{url:w.url,className:"text-primary hover:underline flex-1",children:w.title||w.url})]},w.id))})]}),l]})});vt.displayName="ChatMessageContent";function qs({...e}){return t(oe.Root,{"data-slot":"sheet",...e})}function Js({...e}){return t(oe.Close,{"data-slot":"sheet-close",...e})}function Ks({...e}){return t(oe.Portal,{"data-slot":"sheet-portal",...e})}function Xs({className:e,...n}){return t(oe.Overlay,{"data-slot":"sheet-overlay",className:v("data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 bg-black/10",e),...n})}function Ys({className:e,children:n,side:r="right",...a}){return i(Ks,{children:[t(Xs,{}),i(oe.Content,{"data-slot":"sheet-content",className:v("bg-background data-[state=open]:animate-in data-[state=closed]:animate-out fixed z-50 flex flex-col gap-4 shadow-lg transition ease-in-out data-[state=closed]:duration-300 data-[state=open]:duration-500",r==="right"&&"data-[state=closed]:slide-out-to-right data-[state=open]:slide-in-from-right inset-y-0 right-0 h-full w-3/4 border-l sm:max-w-sm",r==="left"&&"data-[state=closed]:slide-out-to-left data-[state=open]:slide-in-from-left inset-y-0 left-0 h-full w-3/4 border-r sm:max-w-sm",r==="top"&&"data-[state=closed]:slide-out-to-top data-[state=open]:slide-in-from-top inset-x-0 top-0 h-auto border-b",r==="bottom"&&"data-[state=closed]:slide-out-to-bottom data-[state=open]:slide-in-from-bottom inset-x-0 bottom-0 h-auto border-t",e),...a,children:[n,i(oe.Close,{className:"ring-offset-background focus:ring-ring data-[state=open]:bg-secondary absolute top-4 right-4 rounded-xs opacity-70 transition-opacity hover:opacity-100 focus:ring-2 focus:ring-offset-2 focus:outline-hidden disabled:pointer-events-none",children:[t(Hn,{className:"size-4"}),t("span",{className:"sr-only",children:"Close"})]})]})]})}function Qs({className:e,...n}){return t("div",{"data-slot":"sheet-header",className:v("flex flex-col gap-1.5 p-4",e),...n})}function Zs({className:e,...n}){return t(oe.Title,{"data-slot":"sheet-title",className:v("text-foreground font-semibold tracking-tight",e),...n})}function xi({className:e,...n}){return t(oe.Description,{"data-slot":"sheet-description",className:v("text-muted-foreground text-sm",e),...n})}function eo({onReact:e,onReply:n,onEdit:r,className:a,messageData:s}){const[o,c]=x(!1),l=L(null),p=L(null),m=["","","","","",""],f=d=>{e&&e(d),c(!1)};return D(()=>{const d=h=>{l.current&&!l.current.contains(h.target)&&p.current&&!p.current.contains(h.target)&&c(!1)};return document.addEventListener("mousedown",d),()=>{document.removeEventListener("mousedown",d)}},[]),i("div",{className:`relative w-[7.5rem] ${a}`,children:[i("div",{className:"bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-full shadow-sm flex items-center px-1 relative",children:[i(Oe,{children:[t(je,{asChild:!0,children:t("button",{ref:p,className:"p-2 rounded-full hover:bg-gray-100 dark:hover:bg-gray-700 text-gray-500 dark:text-gray-400",onClick:()=>c(!o),"aria-label":"Add reaction",children:t(Vn,{className:"h-5 w-5"})})}),t(Me,{sideOffset:8,children:"Add reaction"})]}),i(Oe,{children:[t(je,{asChild:!0,children:t("button",{className:"p-2 rounded-full hover:bg-gray-100 dark:hover:bg-gray-700 text-gray-500 dark:text-gray-400",onClick:n,"aria-label":"Reply",children:t(Wn,{className:"h-5 w-5"})})}),t(Me,{sideOffset:8,children:"Reply"})]}),i(Oe,{children:[t(je,{asChild:!0,children:t("button",{className:"p-2 rounded-full hover:bg-gray-100 dark:hover:bg-gray-700 text-gray-500 dark:text-gray-400",onClick:r,"aria-label":"Edit",children:t(qn,{className:"h-5 w-5"})})}),t(Me,{sideOffset:8,children:"Edit"})]})]}),o&&t("div",{ref:l,className:"absolute right-0 top-full mt-1 bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-lg shadow-md p-2 z-10",children:t("div",{className:"flex gap-1",children:m.map((d,h)=>t("button",{onClick:()=>f(d),className:"hover:bg-gray-100 dark:hover:bg-gray-700 p-2 rounded-full text-lg",children:d},h))})})]})}const Ye=({messageData:e,isLastChunk:n=!0,userID:r,userImage:a,onReply:s,chatroom:o})=>{const[c,l]=x(!1),p=e.data.senderId===r,[m]=wt(He),f=m?.members.length!==1;if(!p){const d=o?.members?.find(h=>h.user.id===e.data.senderId)?.user.image;return i("div",{className:`relative group py-3 ${f?"hover:bg-gray-100 px-2 rounded-lg":""} `,onMouseEnter:()=>l(!0),onMouseLeave:()=>l(!1),children:[i(gt,{id:e.data.id||e.identifier,className:"w-full overflow-hidden",children:[t(yt,{icon:e.data.isAiGenerated?t($e,{}):t(ze,{}),imageSrc:e.data.isAiGenerated?void 0:d,className:"flex-shrink-0"}),t(vt,{content:e.data.content,showCursor:!n&&e.data.isAiGenerated,reasoning:e.data.reasoning,isReasoning:!!e.data.reasoning&&e.data.reasoning.length>0,sources:e.data.sources,className:"break-words overflow-hidden"})]},e.data.id||e.identifier),f&&t("div",{className:`absolute -top-7 -right-2 transition-opacity duration-200 ${c?"opacity-100":"opacity-0"}`,children:t(eo,{messageData:e,onReply:s})})]})}return t("div",{className:"relative group py-2",onMouseEnter:()=>l(!0),onMouseLeave:()=>l(!1),children:i(gt,{id:e.data.id||e.identifier,variant:"bubble",type:"outgoing",className:"w-full overflow-hidden",children:[t(vt,{content:e.data.content,sources:e.data.sources,className:"break-words overflow-hidden"}),a&&t(yt,{imageSrc:a,className:"flex-shrink-0"})]},e.data.id||e.identifier)})},to=({message:e,userID:n,userImage:r,stream:a,allMessages:s=[]})=>{const[o,c]=x(!1),[l,p]=x(""),[m,f]=x(!1),[d]=wt(He),h=e.data.id||e.identifier,k=Ze(()=>s.filter(C=>C.data.parentMessageId===h).map(C=>C.data),[s,h]),u=k.length>0,w=!!!e.data.parentMessageId&&(u||e.data.isThreadStarter),y=async()=>{if(!(!l.trim()||!d||m)){f(!0);try{const C=h,E=Jt();if(a)await a.send({data:{chatroomId:d.id,parentMessageId:C,isAiGenerated:!1,senderId:n,content:l.trim(),attachments:[],isReasoning:!1,reasoning:"",sources:[]},identifier:E,isLastChunk:!0,startIndex:0,totalChunks:1});else{const T=await fe().chats.chat({userId:n,chatroomId:d.id});await T.send({data:{chatroomId:d.id,parentMessageId:C,isAiGenerated:!1,senderId:n,content:l.trim(),attachments:[],isReasoning:!1,reasoning:"",sources:[]},identifier:E,isLastChunk:!0,startIndex:0,totalChunks:1}),T.close()}p("")}catch(C){console.error("Error sending reply:",C),G.error("Failed to send reply. Please try again.")}finally{f(!1)}}},I=()=>{const C=k[k.length-1],E=k.length,[g,T]=x(!1),[S,P]=x(!1),H=Ze(()=>{const _=new Set(k.map($=>$.senderId));return Array.from(_).map($=>{const W=d?.members?.find(q=>q.user.id===$);return{id:$,isAi:k.find(q=>q.senderId===$)?.isAiGenerated||!1,name:W?.user.name||"User",image:W?.user.image}})},[k,d]);return i(O,{variant:"ghost",size:"sm",className:"w-full sm:w-[90%] md:w-[80%] flex items-center justify-start gap-1 py-1 text-xs text-muted-foreground bg-white relative",onClick:()=>c(!0),onMouseEnter:()=>{T(!0),P(!0)},onMouseLeave:()=>{T(!1),P(!1)},children:[i("div",{className:"flex items-center min-w-[80px] z-10",children:[t(Jn,{size:12,className:"mr-1"}),i("span",{children:[E," ",E===1?"reply":"replies"]})]}),i("div",{className:"relative h-6 flex-1 overflow-hidden",children:[i("div",{className:`absolute left-0 flex transition-all duration-500 ease-in-out ${S?"opacity-0 transform -translate-y-full":"opacity-100 transform translate-y-0"}`,children:[H.slice(0,3).map((_,$)=>t("div",{className:"w-6 h-6 rounded-md flex items-center justify-center ml-2 bg-gray-100",children:_.isAi?t($e,{size:12}):_.image?t("img",{src:_.image,className:"w-6 h-6 rounded-md",alt:"user"}):t(ze,{size:12})},$)),H.length>3&&t("div",{className:"w-5 h-5 rounded-md flex items-center justify-center ml-2 bg-gray-100",children:i("span",{className:"text-xs",children:["+",H.length-3]})})]}),t("div",{className:`absolute left-0 h-6 flex items-center transition-all duration-500 ease-in-out ${S?"opacity-100 transform translate-y-0":"opacity-0 transform translate-y-full"}`,children:i("div",{className:"ml-2 flex items-center w-full overflow-hidden",children:[C?.isAiGenerated?t($e,{size:12,className:"flex-shrink-0"}):(()=>{const _=d?.members?.find(W=>W.user.id===C?.senderId),$=_?.user.image;return $?t("img",{src:$,className:"w-6 h-6 rounded-md flex-shrink-0",alt:_?.user.name||"User"}):t(ze,{size:12,className:"flex-shrink-0"})})(),C&&i("span",{className:"ml-2 truncate text-muted-foreground/70 w-full max-w-[calc(100%-24px)]",children:[C.content?.substring(0,70)||"",C.content?.length>70?"...":""]})]})})]}),t(qt,{className:`ml-auto transition-all duration-300 ease-in-out z-10 ${g?"opacity-100 text-black":"opacity-0"}`})]})},M=L(e.data.content);D(()=>{M.current=e.data.content},[e.data.content]);const j=()=>{c(!0)};return i("div",{className:`relative w-full ${u?"hover:bg-gray-100 px-2 rounded-lg":""}`,children:[t(Ye,{messageData:{...e,data:{...e.data,content:M.current}},isLastChunk:e.isLastChunk,userID:n,userImage:r,onReply:j,chatroom:d}),w&&t("div",{className:"pl-4 sm:pl-8 pb-1",children:t(I,{})}),t(qs,{open:o,onOpenChange:c,children:i(Ys,{side:"right",className:"p-0 flex flex-col w-full sm:min-w-[600px] md:min-w-[750px] lg:min-w-[800px] xl:min-w-[900px] max-w-[95vw]",children:[t(Qs,{className:"px-3 sm:px-4 py-3 border-b sticky top-0 bg-white z-10",children:i("div",{className:"flex justify-between items-center",children:[t(Zs,{className:"text-base sm:text-lg",children:u?`Thread (${k.length} ${k.length===1?"reply":"replies"})`:"Reply to message"}),t(Js,{className:"hover:cursor-pointer"})]})}),i("div",{className:"flex-1 flex flex-col h-[calc(100vh-140px)] overflow-hidden",children:[t(Tt,{scrollButtonAlignment:"right",className:"flex-1 px-1 sm:px-2 py-4",children:i("div",{className:"space-y-4",children:[t("div",{className:"w-full border-b border-gray-200 mb-6 p-2 sm:p-3 hover:bg-gray-100",style:{maxWidth:"95%"},children:t(Ye,{messageData:{...e,data:{...e.data,content:M.current}},isLastChunk:e.isLastChunk,userID:n,userImage:r,onReply:j,chatroom:d})}),k.map(C=>t("div",{className:"w-full border-b border-gray-200 mb-4 hover:bg-gray-100 p-2 sm:p-3",style:{maxWidth:"95%"},children:t(Ye,{messageData:{identifier:C.id,data:C,startIndex:0,totalChunks:1,isLastChunk:!0},isLastChunk:!0,userID:n,userImage:r,onReply:j,chatroom:d})},C.id))]})}),t("div",{className:"p-2 sm:p-3 border-t mt-auto bg-white",children:i(Ge,{value:l,onChange:C=>p(C.target.value),onSubmit:y,hasMessages:!0,children:[t(Pe,{placeholder:m?"Sending...":"Reply in thread...",autoFocus:!0,disabled:m,onKeyDown:C=>{C.key==="Enter"&&!C.shiftKey&&(C.preventDefault(),y())}}),t(Be,{disabled:!l.trim()||m})]})})]})]})})]})},ao=Se("app_routes_authed_layout_chat_chatroomId_tsx--fetchChatroomWithMessages_createServerFn_handler","/_server"),no=Ie().validator(e=>e).handler(ao),bt=B("/_authed/_layout/chat/$chatroomId")({params:K.object({chatroomId:K.string()}),beforeLoad:async e=>{const{chatroomId:n}=e.params;return{chatroom:(await no({data:{chatroomId:n}})).chatroom}},component:ro});function ro({className:e,...n}){const{userId:r,chatroom:a}=bt.useRouteContext(),{chatroomId:s}=bt.useParams(),o=L(void 0),[c,l]=x(!1),[p,m]=x([]),[f,d]=x(""),h=Qe(He),k=L(null),u=async y=>{if(!(c||!f.trim()&&!y))try{if(!o.current&&(await b(a.id),!o.current)){console.error("Couldn't establish chat connection");return}await o.current.send({data:{chatroomId:a.id||"",parentMessageId:null,isThreadStarter:!1,senderId:r,content:y||f,attachments:[],isReasoning:!1,reasoning:"",sources:[]},identifier:Jt(),isLastChunk:!0,startIndex:0,totalChunks:1}),d("")}catch(I){console.error("Error sending message:",I)}};D(()=>{if(h(a),a.messages?.length>0){const y=a.messages.map(I=>({identifier:I.id,data:I,startIndex:0,totalChunks:1,isLastChunk:!0}));m(y)}else m([]);return b(a.id),()=>{o.current&&o.current.close()}},[s]);const b=async y=>{o.current&&o.current.close(),l(!0);try{o.current=await fe().chats.chat({userId:r,chatroomId:y||y||""}),o.current.socket.on("close",()=>{console.log("Socket closed, will attempt to reconnect if needed")}),o.current.socket.on("open",async()=>{l(!1);const I=localStorage.getItem("pendingMessage");I&&(await u(I),localStorage.removeItem("pendingMessage"))});for await(const I of o.current)m(M=>{const j=M.findIndex(E=>E.identifier===I.identifier);if(I.identifier.startsWith("parent-"))return M;if(j>=0){const E=[...M],g=E[j];if(I.isLastChunk)E[j]=I;else{const T=I.startIndex<=1,S={...g,data:{...g.data,content:T?I.data.content:g.data.content+I.data.content,reasoning:T?I.data.reasoning||"":(g.data.reasoning||"")+(I.data.reasoning||""),sources:I.data.sources?[...g.data.sources||[],...I.data.sources.filter(P=>!(g.data.sources||[]).some(H=>H.id===P.id))]:g.data.sources},isLastChunk:I.isLastChunk,totalChunks:I.totalChunks,startIndex:I.startIndex};E[j]=S}return E}else return[...M,I]})}catch(I){console.error("Error connecting to chat:",I),l(!1)}},w=i(Ge,{value:f,onChange:y=>d(y.target.value),onSubmit:u,hasMessages:p.length>0,children:[t(Pe,{placeholder:c?"Connecting...":"Type a message...",autoFocus:!0,disabled:c,onKeyDown:y=>{y.key==="Enter"&&!y.shiftKey&&(y.preventDefault(),u())}}),t(Be,{disabled:c||!f.trim()})]});return i("div",{className:"flex-1 flex flex-col h-full",...n,children:[t(Tt,{scrollButtonAlignment:"center",className:"flex-1 overflow-y-auto",children:i("div",{className:"max-w-4xl mx-auto w-full px-4 py-8 space-y-4",children:[p.filter(y=>!y.data.parentMessageId).map(y=>t(to,{message:y,userID:r,userImage:Rs(a,y.data.senderId)?.user.image,stream:o.current,allMessages:p},y.identifier||y.data.id)),t("div",{ref:k})]})}),t("div",{className:"px-2 py-4 max-w-4xl mx-auto w-full",children:w})]})}const so=Qt.update({id:"/verify-account",path:"/verify-account",getParentRoute:()=>re}),oo=Ur.update({id:"/sign-up",path:"/sign-up",getParentRoute:()=>re}),io=Gr.update({id:"/sign-in",path:"/sign-in",getParentRoute:()=>re}),co=Vr.update({id:"/forgot-password",path:"/forgot-password",getParentRoute:()=>re}),lo=fa.update({id:"/create-organization",path:"/create-organization",getParentRoute:()=>re}),_a=ls.update({id:"/_authed",getParentRoute:()=>re}),uo=ga.update({id:"/",path:"/",getParentRoute:()=>re}),se=ya.update({id:"/_layout",getParentRoute:()=>_a}),mo=va.update({id:"/accept-invitation/$invitationId/$invitationEmail",path:"/accept-invitation/$invitationId/$invitationEmail",getParentRoute:()=>re}),ho=ba.update({id:"/team-chat/",path:"/team-chat/",getParentRoute:()=>se}),po=wa.update({id:"/organizations/",path:"/organizations/",getParentRoute:()=>se}),fo=xa.update({id:"/organization-settings/",path:"/organization-settings/",getParentRoute:()=>se}),go=Na.update({id:"/members/",path:"/members/",getParentRoute:()=>se}),yo=Ia.update({id:"/chat/",path:"/chat/",getParentRoute:()=>se}),vo=Ta.update({id:"/teamspace/$teamspaceId",path:"/teamspace/$teamspaceId",getParentRoute:()=>se}),bo=Sa.update({id:"/project/$projectId",path:"/project/$projectId",getParentRoute:()=>se}),wo=bt.update({id:"/chat/$chatroomId",path:"/chat/$chatroomId",getParentRoute:()=>se}),xo={AuthedLayoutChatChatroomIdRoute:wo,AuthedLayoutProjectProjectIdRoute:bo,AuthedLayoutTeamspaceTeamspaceIdRoute:vo,AuthedLayoutChatIndexRoute:yo,AuthedLayoutMembersIndexRoute:go,AuthedLayoutOrganizationSettingsIndexRoute:fo,AuthedLayoutOrganizationsIndexRoute:po,AuthedLayoutTeamChatIndexRoute:ho},No=se._addFileChildren(xo),Co={AuthedLayoutRoute:No},Io=_a._addFileChildren(Co),To={IndexRoute:uo,AuthedRoute:Io,CreateOrganizationRoute:lo,ForgotPasswordRoute:co,SignInRoute:io,SignUpRoute:oo,VerifyAccountRoute:so,AcceptInvitationInvitationIdInvitationEmailRoute:mo},So=re._addFileChildren(To)._addFileTypes();function ko(){return Ka({routeTree:So,defaultPreload:"intent",defaultErrorComponent:Kt,defaultNotFoundComponent:()=>Xt,scrollRestoration:!0})}const Ni=ln({createRouter:ko,getRouterManifest:pr})(dr);export{li as $,Dr as A,O as B,ue as C,fe as D,Ct as E,mt as F,Nt as G,ta as H,aa as I,ws as J,xs as K,te as L,Ns as M,mi as N,hi as O,di as P,ui as Q,Qt as R,qs as S,la as T,js as U,yi as V,vi as W,pa as X,Lr as Y,pi as Z,fi as _,ye as a,gi as a0,ya as a1,ss as a2,ii as a3,ci as a4,va as a5,ut as a6,$r as a7,si as a8,ba as a9,Ge as aa,Pe as ab,Be as ac,Tt as ad,to as ae,ts as af,Ta as ag,Sa as ah,As as ai,Ni as aj,de as b,ne as c,ie as d,na as e,ce as f,ee as g,ke as h,dt as i,ga as j,v as k,Qs as l,Zs as m,xi as n,Ys as o,Oe as p,je as q,Me as r,lt as s,bi as t,ra as u,wi as v,_s as w,Os as x,He as y,Es as z};
