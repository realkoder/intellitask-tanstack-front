import{jsx as e,jsxs as t,Fragment as G}from"react/jsx-runtime";import{useNavigate as ve,Link as B}from"@tanstack/react-router";import{useSetAtom as be,useAtom as Pe}from"jotai";import{k as q,z as we,B as u,L as $,g as ee,G as ke,D as R,ah as te,y as Me,C as z,a as O,b as A,c as H,d as E,aa as De,ab as Te,ac as Fe,T as J,p as K,q as X,r as Q,h as Ue,ai as re,F as ae}from"./ssr-D494T9bW.js";import{Settings as ye,Lock as V,AlertCircle as Se,Trash2 as se,Upload as _,X as le,FileIcon as W,CheckCircle as ze,Home as Oe,ChevronRight as ie,Briefcase as ne,FolderOpen as ce,MessageSquarePlus as oe,MessageCircle as Ae,Users as de,ChevronDown as me,ChevronUp as he}from"lucide-react";import*as Z from"react";import{useState as p,useEffect as Ce}from"react";import{S as F,M as Re,C as Ee,a as Le,b as Be}from"./collapsible-g0t8x5gf.js";import{toast as U}from"sonner";import{D as $e,a as He,b as Ve,c as ue,d as pe,e as ge,f as We,g as qe}from"./dialog-BARnul6K.js";import{C as _e}from"./checkbox-C_SO_KyM.js";import{cva as Ge}from"class-variance-authority";import{A as fe}from"./avatar-pWQn_6aq.js";import{useFileUpload as Je,FileUpload as N}from"@ark-ui/react";import"@vercel/analytics";import"@tanstack/router-core";import"@tanstack/start-client-core";import"@tanstack/start-server-core";import"zod";import"@radix-ui/react-slot";import"clsx";import"tailwind-merge";import"@radix-ui/react-label";import"better-auth/react";import"better-auth/client/plugins";import"input-otp";import"@radix-ui/react-select";import"@radix-ui/react-tooltip";import"@radix-ui/react-radio-group";import"@radix-ui/react-scroll-area";import"framer-motion";import"motion/react";import"@radix-ui/react-dropdown-menu";import"uuid";import"marked";import"react-markdown";import"remark-gfm";import"@radix-ui/react-hover-card";import"qss";import"@radix-ui/react-dialog";import"tiny-invariant";import"node:stream";import"isbot";import"react-dom/server";import"@radix-ui/react-tabs";import"@radix-ui/react-collapsible";import"@radix-ui/react-checkbox";import"@radix-ui/react-avatar";const Ke=Ge("relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive",warning:"border-amber-500/50 text-amber-700 [&>svg]:text-amber-700"}},defaultVariants:{variant:"default"}}),Ie=Z.forwardRef(({className:l,variant:x,...m},v)=>e("div",{ref:v,role:"alert",className:q(Ke({variant:x}),l),...m}));Ie.displayName="Alert";const Xe=Z.forwardRef(({className:l,...x},m)=>e("h5",{ref:m,className:q("mb-1 font-medium leading-none tracking-tight",l),...x}));Xe.displayName="AlertTitle";const je=Z.forwardRef(({className:l,...x},m)=>e("div",{ref:m,className:q("text-sm [&_p]:leading-relaxed",l),...x}));je.displayName="AlertDescription";function Qe({project:l,onProjectUpdated:x,trigger:m,userId:v}){const M=ve(),C=be(we),[b,c]=p(!1),[h,w]=p(!1),[j,P]=p(!1),[D,y]=p(!1),[a,k]=p(""),[o,n]=p({name:"",description:"",isPrivate:!1}),[i,r]=p(!0);Ce(()=>{if(b){n({name:l.name||"",description:l.description||"",isPrivate:l.isPrivate||!1});const g=l.members?.length||0;r(g<=1),y(!1),k("")}},[b,l]);const d=g=>{n({...o,[g.target.name]:g.target.value})},T=g=>{n({...o,isPrivate:g})},S=async g=>{if(g.preventDefault(),!l.id){U.error("Project not found");return}if(!o.name.trim()){U.error("Project name is required");return}if(o.isPrivate&&!i&&!l.isPrivate){U.error("Cannot make a project private when it has multiple members");return}w(!0);try{const{data:s}=await R().chatrooms.updateProject(l.id,{teamspaceId:l.teamspaceId,context:l.context,creatorId:v,name:o.name,description:o.description,isPrivate:o.isPrivate,members:o.isPrivate?[]:l.members?.map(f=>({projectId:l.id,userId:f.user.id,role:f.role,invitedByUserId:v}))});x(s),U.success("Project settings updated successfully"),c(!1)}catch(s){console.error("Error updating project:",s),U.error("Failed to update project")}finally{w(!1)}},L=async()=>{if(a!==l.name){U.error("Project name does not match");return}P(!0);try{await R().chatrooms.deleteProject(l.id),U.success("Project deleted successfully"),c(!1),l.teamspaceId?(C(g=>g.map(f=>({...f,projects:f.projects.filter(I=>I.id!==l.id)}))),M({to:"/teamspace/$teamspaceId",params:{teamspaceId:l.teamspaceId}})):M({to:"/chat"})}catch(g){console.error("Error deleting project:",g),U.error("Failed to delete project")}finally{P(!1)}};return t($e,{open:b,onOpenChange:c,children:[e(He,{asChild:!0,children:m||t(u,{size:"sm",variant:"outline",className:"hover:cursor-pointer",children:[e(ye,{className:"h-4 w-4 mr-2"})," Project Settings"]})}),e(Ve,{className:"sm:max-w-[500px]",children:D?t("div",{children:[t(ue,{children:[e("div",{className:"h-1.5 bg-red-500 w-full absolute top-0 left-0 rounded-t-lg"}),t(pe,{className:"text-xl mt-2 text-red-600 flex items-center",children:[e(se,{className:"h-5 w-5 mr-2"})," Delete Project"]}),e(ge,{children:"This action cannot be undone. This will permanently delete the project and remove all associated chats and data."})]}),t("div",{className:"py-4",children:[e("div",{className:"bg-red-50 border border-red-200 rounded-md p-4 mb-4",children:t("div",{className:"flex items-center",children:[e("span",{className:"text-xl mr-2",children:"ðŸ’©"}),t("p",{className:"text-sm text-red-800",children:["Are you absolutely sure you want to delete ",e("strong",{children:l.name}),"? This action is irreversible!"]})]})}),t("div",{className:"grid gap-2",children:[t($,{htmlFor:"confirmName",className:"text-sm font-medium",children:["To confirm, type ",e("span",{className:"font-bold",children:l.name})," below:"]}),e(ee,{id:"confirmName",value:a,onChange:g=>k(g.target.value),placeholder:`Type "${l.name}" to confirm`})]}),t("div",{className:"flex justify-between mt-6",children:[e(u,{type:"button",variant:"outline",onClick:()=>y(!1),disabled:j,children:"Cancel"}),e(u,{type:"button",variant:"destructive",className:"bg-red-600 hover:bg-red-700",onClick:L,disabled:a!==l.name||j,children:j?"Deleting...":"Permanently Delete Project"})]})]})]}):t("form",{onSubmit:S,children:[t(ue,{children:[e("div",{className:"h-1.5 bg-emerald-500 w-full absolute top-0 left-0 rounded-t-lg"}),e(pe,{className:"text-xl mt-2",children:"Project Settings"}),e(ge,{children:"Update the details and settings of your project"})]}),t("div",{className:"grid gap-4 py-4",children:[t("div",{className:"grid gap-2",children:[t($,{htmlFor:"name",children:["Project Name ",e("span",{className:"text-red-500",children:"*"})]}),e(ee,{id:"name",name:"name",value:o.name,onChange:d,placeholder:"e.g. Marketing Campaign",required:!0})]}),t("div",{className:"grid gap-2",children:[e($,{htmlFor:"description",children:"Description"}),e(ke,{id:"description",name:"description",value:o.description,onChange:d,placeholder:"What is this project about?",rows:3})]}),t("div",{className:"flex items-center space-x-2",children:[e(_e,{id:"isPrivate",checked:o.isPrivate,onCheckedChange:T,disabled:!i&&!l.isPrivate}),t("div",{className:"grid gap-1.5 leading-none",children:[t($,{htmlFor:"isPrivate",className:`text-sm font-medium leading-none flex items-center ${!i&&!l.isPrivate?"text-muted-foreground":""}`,children:[e(V,{className:"h-3.5 w-3.5 mr-1.5 text-muted-foreground"}),"Make project private"]}),e("p",{className:"text-xs text-muted-foreground",children:"Private projects are only visible to invited members"})]})]}),!i&&!l.isPrivate&&t(Ie,{variant:"warning",className:"bg-amber-50 text-amber-800 border-amber-200",children:[e(Se,{className:"h-4 w-4"}),e(je,{children:"Projects with multiple members cannot be made private"})]}),e("div",{className:"border-t pt-4 mt-2",children:t("div",{className:"flex flex-col space-y-2",children:[e("h3",{className:"text-sm font-medium text-red-600",children:"Danger Zone"}),e("p",{className:"text-xs text-muted-foreground",children:"Once you delete a project, there is no going back. This action cannot be undone."}),t(u,{type:"button",variant:"destructive",className:"mt-2 bg-red-600 hover:bg-red-700",onClick:()=>y(!0),children:[e(se,{className:"h-4 w-4 mr-2"})," Delete Project"]})]})})]}),t(We,{children:[e(qe,{asChild:!0,children:e(u,{variant:"outline",type:"button",disabled:h,children:"Cancel"})}),e(u,{type:"submit",className:"bg-emerald-600 hover:bg-emerald-700",disabled:h,children:h?"Saving...":"Save Changes"})]})]})})]})}const xe=({teamspaceId:l=null,projectId:x=null,chatroomId:m=null,organizationId:v,uploadType:M="DOCUMENT",receiverIds:C=[],onUploadComplete:b,compact:c=!1,files:h=[],className:w=""})=>{const j=Je({maxFiles:10,maxFileSize:52428800}),[P,D]=p(!1),[y,a]=p(!1),k=async n=>{if(n.length){D(!0);try{const i=new FormData,r={teamspaceId:l||null,projectId:x||null,chatroomId:m||null,organizationId:v,uploadType:M};i.append("metadata",JSON.stringify(r)),C.length>0&&i.append("receiverIds",JSON.stringify(C)),n.forEach(S=>{i.append("file",S)});const d=await R().file_management.uploadFilesWithMetadata("POST",i);if(!d.ok)throw new Error(`Upload failed: ${d.statusText}`);const T=await d.json();console.log("Upload successful:",T),b&&b(T),c&&a(!1)}catch(i){console.error("Error uploading files:",i instanceof Error?i.message:String(i))}finally{D(!1)}}},o=n=>{if(n===0)return"0 Bytes";const i=1024,r=["Bytes","KB","MB","GB"],d=Math.floor(Math.log(n)/Math.log(i));return parseFloat((n/Math.pow(i,d)).toFixed(1))+" "+r[d]};return c&&!y?t("div",{className:`flex items-center gap-2 ${w}`,children:[t("button",{onClick:()=>a(!0),className:"inline-flex items-center gap-1 text-xs px-2 py-1 rounded-md bg-emerald-50 text-emerald-700 hover:bg-emerald-100 transition-colors",children:[e(_,{size:12}),e("span",{children:"Upload"})]}),h&&h.length>0&&t("div",{className:"text-xs text-muted-foreground",children:[h.length," file",h.length!==1?"s":""]})]}):e(N.RootProvider,{value:j,children:t("div",{className:`relative ${w}`,children:[c&&e("button",{onClick:()=>a(!1),className:"absolute right-0 top-0 p-1 text-gray-400 hover:text-gray-600 z-10",children:e(le,{size:16})}),t("div",{className:"space-y-2",children:[!c&&e(N.Label,{className:"block text-sm font-medium text-gray-700",children:"Upload Files"}),e(N.Dropzone,{className:`border-2 border-dashed border-gray-300 rounded-lg text-center
            ${c?"p-3":"p-6"} bg-gray-50 hover:bg-gray-100 transition-colors`,children:c?t("div",{className:"flex flex-col items-center",children:[e(_,{className:"h-5 w-5 text-gray-500 mb-1"}),e(N.Trigger,{className:"text-xs text-emerald-600 font-medium hover:underline",children:"Choose Files"})]}):t(G,{children:[e("p",{className:"text-gray-600 mb-2",children:"Drag your files here"}),e(N.Trigger,{className:"py-2 px-4 bg-emerald-600 text-white rounded hover:bg-emerald-700 transition-colors",children:"Choose Files"})]})}),e(N.ItemGroup,{children:e(N.Context,{children:n=>t(G,{children:[n.acceptedFiles.length>0&&e("div",{className:`space-y-2 mt-2 ${c?"max-h-32 overflow-y-auto":""}`,children:n.acceptedFiles.map(i=>t(N.Item,{file:i,className:"flex items-center p-2 border rounded bg-white",children:[e(N.ItemPreview,{type:"image/*",className:"w-8 h-8 mr-2 bg-gray-100 flex items-center justify-center rounded overflow-hidden",children:e(N.ItemPreviewImage,{className:"max-w-full max-h-full object-cover"})}),e(N.ItemPreview,{type:".*",className:"w-8 h-8 mr-2 bg-gray-100 flex items-center justify-center rounded",children:e(W,{className:"h-4 w-4 text-gray-500"})}),t("div",{className:"flex-1 truncate",children:[e(N.ItemName,{className:"font-medium text-sm truncate"}),e(N.ItemSizeText,{className:"text-xs text-gray-500"})]}),P?e("div",{className:"animate-pulse text-emerald-500",children:t("svg",{className:"animate-spin h-4 w-4",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[e("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]})}):e(N.ItemDeleteTrigger,{className:"text-red-500 hover:text-red-700 p-1",children:e(le,{className:"h-4 w-4"})})]},i.name))}),n.acceptedFiles.length>0&&!P&&t("button",{onClick:()=>k(n.acceptedFiles),className:`mt-2 py-1.5 px-3 bg-emerald-600 text-white rounded hover:bg-emerald-700 transition-colors
                        flex items-center justify-center gap-1.5 ${c?"text-xs w-full":"w-full"}`,children:[e(_,{className:`${c?"h-3 w-3":"h-4 w-4"}`}),t("span",{children:["Upload ",n.acceptedFiles.length," File",n.acceptedFiles.length!==1?"s":""]})]})]})})})]}),h&&h.length>0&&!c&&t("div",{className:"mt-4",children:[e("h4",{className:"text-sm font-medium mb-2 text-gray-700",children:"Uploaded Files"}),e("div",{className:"space-y-2 max-h-40 overflow-y-auto pr-1",children:h.map((n,i)=>t("div",{className:"flex items-center p-2 border rounded bg-white",children:[e("div",{className:"w-8 h-8 mr-2 bg-gray-100 flex items-center justify-center rounded",children:e(W,{className:"h-4 w-4 text-gray-500"})}),t("div",{className:"flex-1 truncate",children:[e("p",{className:"font-medium text-sm truncate",children:n.name||`File ${i+1}`}),e("p",{className:"text-xs text-gray-500",children:n.size?o(n.size):"Unknown size"})]}),e(ze,{className:"h-4 w-4 text-emerald-500"})]},i))})]}),e(N.HiddenInput,{})]})})},Ne=l=>{switch(l){case"OWNER":return"bg-green-100 text-green-800 border-green-200";case"ADMIN":return"bg-red-100 text-red-800 border-red-200";case"CONTRIBUTOR":return"bg-blue-100 text-blue-800 border-blue-200";case"VIEWER":return"bg-gray-100 text-gray-800 border-gray-200";default:return"bg-gray-100 text-gray-800 border-gray-200"}};function Ze({members:l}){const[x,m]=p(!1),[v,M]=p(!1),C=5,b=l.filter((a,k,o)=>k===o.findIndex(n=>n.user?.id===a.user?.id)),c=b.filter(a=>!a.hasLeft),h=b.filter(a=>a.hasLeft),w=(a,k)=>{const o={OWNER:0,ADMIN:1,CONTRIBUTOR:2,VIEWER:3};return(o[a.role]||4)-(o[k.role]||4)},j=[...c].sort(w),P=[...h].sort(w),D=x?j:j.slice(0,c.length>=C?C:c.length),y=c.length>C&&!x;return t("div",{className:"space-y-3",children:[e("div",{children:D.map(a=>e("div",{className:"py-1.5",children:t("div",{className:"relative flex items-center justify-between group",children:[t("div",{className:"flex items-center gap-2",children:[e(fe,{className:"h-7 w-7",children:a.user?.image?e("img",{src:a.user.image,alt:a.user?.name||"User"}):e("div",{className:"bg-gray-200 h-full w-full flex items-center justify-center text-gray-700 text-xs",children:(a.user?.name||"U").charAt(0)})}),e(J,{children:t(K,{children:[e(X,{asChild:!0,children:e("span",{className:"text-sm font-medium truncate max-w-[120px]",children:a.user?.name||"Unknown User"})}),t(Q,{children:[e("p",{children:a.user?.name||"Unknown User"}),e("p",{className:"text-xs text-muted-foreground",children:a.user?.email})]})]})})]}),e(ae,{className:Ne(a.role),children:a.role})]})},a.id))}),y&&e(u,{variant:"ghost",size:"sm",className:"w-full text-xs h-7",onClick:()=>m(!0),children:t("span",{className:"flex items-center",children:["Show ",c.length-C," More ",e(me,{className:"ml-1 h-3 w-3"})]})}),x&&c.length>C&&e(u,{variant:"ghost",size:"sm",className:"w-full text-xs h-7",onClick:()=>m(!1),children:t("span",{className:"flex items-center",children:["Show Less ",e(he,{className:"ml-1 h-3 w-3"})]})}),h.length>0&&t(Ee,{open:v,onOpenChange:M,className:"mt-3",children:[t("div",{className:"flex items-center text-xs text-muted-foreground",children:[e("div",{className:"h-px bg-border flex-grow mr-2"}),e(Le,{asChild:!0,children:t("button",{className:"flex items-center gap-1 px-2 py-1 rounded-sm hover:bg-muted/50 transition-colors",children:[t("span",{children:["Former Members (",h.length,")"]}),v?e(he,{className:"h-3 w-3"}):e(me,{className:"h-3 w-3"})]})}),e("div",{className:"h-px bg-border flex-grow ml-2"})]}),e(Be,{className:"pt-2",children:e("div",{className:"space-y-1.5",children:P.map(a=>e("div",{children:t("div",{className:"relative flex items-center justify-between group py-1.5",children:[e("div",{className:"absolute inset-0 rounded-md bg-muted/30 pointer-events-none"}),t("div",{className:"flex items-center gap-2 z-10",children:[t("div",{className:"relative",children:[e(fe,{className:"h-7 w-7",children:a.user?.image?e("img",{src:a.user.image,alt:a.user?.name||"User",className:"filter grayscale"}):e("div",{className:"bg-gray-200 h-full w-full flex items-center justify-center text-gray-700 text-xs",children:(a.user?.name||"U").charAt(0)})}),e("div",{className:"absolute -bottom-1 -right-1 rounded-full w-3 h-3 bg-muted border border-background flex items-center justify-center",children:e("span",{className:"text-[8px]",children:"Ã—"})})]}),e(J,{children:t(K,{children:[e(X,{asChild:!0,children:e("span",{className:"text-sm font-medium truncate max-w-[120px] text-muted-foreground",children:a.user?.name||"Unknown User"})}),t(Q,{children:[e("p",{children:a.user?.name||"Unknown User"}),e("p",{className:"text-xs text-muted-foreground",children:a.user?.email}),e("p",{className:"text-xs text-red-500 mt-1",children:"No longer a member"})]})]})})]}),e(ae,{className:`${Ne(a.role)} opacity-70`,children:a.role})]})},a.id))})})]})]})}const _t=function(){const{projectId:x}=te.useParams(),[m,v]=p(!1),[M,C]=p(!0),[b,c]=p(""),[h,w]=p(""),[j,P]=p(!1),[D,y]=p(!1),[a,k]=Pe(we),o=be(Me),n=te.useRouteContext(),[i]=p(n.userId),r=a.flatMap(s=>s.projects||[]).find(s=>s.id===x),d=a.find(s=>s.id===r?.teamspaceId);Ce(()=>{r&&C(!1)},[r]);const T=ve();if(M)return t("div",{className:"flex-1 flex flex-col h-full",children:[e("div",{className:"h-1.5 bg-gray-200 w-full"}),t("div",{className:"p-6 max-w-5xl mx-auto w-full flex-1",children:[t("div",{className:"mb-8 relative",children:[e(F,{className:"h-10 w-60 mb-2"}),e(F,{className:"h-4 w-full max-w-md mb-4"})]}),t("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[t("div",{className:"md:col-span-2 space-y-6",children:[e("div",{children:e(F,{className:"h-32 w-full mb-6"})}),t("div",{children:[e("div",{className:"flex justify-between items-center mb-4",children:e(F,{className:"h-8 w-40"})}),t("div",{className:"space-y-3",children:[e(F,{className:"h-16 w-full"}),e(F,{className:"h-16 w-full"})]})]})]}),t("div",{className:"space-y-6",children:[e(F,{className:"h-60 w-full"}),e(F,{className:"h-60 w-full"})]})]})]})]});if(!r)return t("div",{className:"flex-1 flex flex-col items-center justify-center p-8 text-center",children:[e("h2",{className:"text-2xl font-bold mb-4",children:"Project not found"}),e("p",{className:"text-muted-foreground mb-6",children:"The project you're looking for doesn't exist or you don't have access to it."}),d?e(u,{variant:"outline",asChild:!0,children:e(B,{to:"/teamspace/$teamspaceId",params:{teamspaceId:d.id},children:"Back to Teamspace"})}):e(u,{variant:"outline",asChild:!0,children:e(B,{to:"/chat",children:"Go to Chat"})})]});const S=async(s="")=>{if(m)return;v(!0);const f=re({currentUserId:i,project:r,teamspace:d});try{const{data:I}=await R().chatrooms.createChatroom({chatroomCreatorId:i,chatroomMembers:f,isPrivate:!1,projectId:r.id,name:s.trim()||"New Chat Conversation",teamIds:[],type:"PROJECT_CHATROOM"});r.chatrooms?.push(I),o(I),T({to:"/chat/$chatroomId",params:{chatroomId:I.id}})}catch(I){console.error("Error creating chatroom:",I)}finally{v(!1),y(!1),w("")}},L=async()=>{if(!(!b.trim()||m))try{v(!0);const s=re({currentUserId:i,project:r,teamspace:d}),{data:f}=await R().chatrooms.createChatroom({chatroomCreatorId:i,chatroomMembers:s,isPrivate:!1,projectId:r.id,name:"New Chat Conversation",teamIds:[],type:"PROJECT_CHATROOM"});r.chatrooms?.push(f),localStorage.setItem("pendingMessage",b),o(f),T({to:"/chat/$chatroomId",params:{chatroomId:f.id}})}catch(s){console.error("Error starting quick chat:",s),v(!1)}},g=s=>{const f=a.map(I=>I.id===d?.id?{...I,projects:I.projects?.map(Y=>Y.id===r?.id?s:Y)}:I);k(f)};return t("div",{className:"flex-1 flex flex-col h-full",children:[e("div",{className:"h-1.5 bg-emerald-500 w-full flex-shrink-0"}),t("div",{className:"p-6 max-w-5xl mx-auto w-full flex-1 overflow-y-auto",children:[t("div",{className:"flex items-center text-sm text-muted-foreground mb-4",children:[t(B,{to:"/chat",className:"flex items-center hover:text-foreground transition-colors",children:[e(Oe,{className:"h-3.5 w-3.5 mr-1"}),"Home"]}),d&&t(G,{children:[e(ie,{className:"h-3.5 w-3.5 mx-1.5"}),t(B,{to:"/teamspace/$teamspaceId",params:{teamspaceId:d.id},className:"flex items-center hover:text-foreground transition-colors",children:[e(ne,{className:"h-3.5 w-3.5 mr-1.5"}),d.name]})]}),e(ie,{className:"h-3.5 w-3.5 mx-1.5"}),t("span",{className:"font-medium text-foreground flex items-center",children:[e(ce,{className:"h-3.5 w-3.5 mr-1.5"}),"Project"]})]}),t("div",{className:"mb-8 relative",children:[t("div",{className:"flex items-center gap-3 mb-2",children:[e("div",{className:"flex h-10 w-10 items-center justify-center rounded-lg bg-emerald-100 text-emerald-700",children:e(ce,{className:"h-5 w-5"})}),t("div",{children:[e("h1",{className:"text-3xl font-bold",children:r.name}),t("div",{className:"flex items-center mt-1",children:[e("span",{className:"inline-flex items-center rounded-md bg-emerald-50 px-2 py-1 text-xs font-medium text-emerald-700 ring-1 ring-inset ring-emerald-600/20",children:"Project"}),r.isPrivate&&t("span",{className:"ml-2 inline-flex items-center rounded-md bg-gray-50 px-2 py-1 text-xs font-medium text-gray-700 ring-1 ring-inset ring-gray-600/20",children:[e(V,{className:"h-3 w-3 mr-1"}),"Private"]}),d&&t("span",{className:"ml-2 text-sm text-muted-foreground flex items-center",children:[e(ne,{className:"h-3 w-3 mr-1"}),d.name]})]})]})]}),e("div",{className:"mt-2",children:e("p",{className:"text-muted-foreground",children:r.description||"No description provided"})}),e("div",{className:"absolute top-0 right-0",children:e(Qe,{project:r,userId:i,onProjectUpdated:g})})]}),t("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[t("div",{className:"md:col-span-2 space-y-6",children:[t(z,{className:"border-b-4 border-b-emerald-500",children:[t(O,{className:"pb-3",children:[e(A,{children:"New chat in this project"}),e(H,{children:"Start a new conversation in the context of this project"})]}),e(E,{children:t(De,{value:b,onChange:s=>c(s.target.value),onSubmit:L,hasMessages:!1,children:[e(Te,{placeholder:m?"Creating chat...":"Type a message to start a new chat...",disabled:m,onKeyDown:s=>{s.key==="Enter"&&!s.shiftKey&&(s.preventDefault(),L())}}),e(Fe,{disabled:m||!b.trim()})]})})]}),t("div",{children:[t("div",{className:"flex justify-between items-center mb-4",children:[e("h2",{className:"text-xl font-semibold",children:"Chats in this project"}),D?t("div",{className:"flex items-center gap-2",children:[e("input",{type:"text",className:"px-3 py-1 border rounded-md text-sm",placeholder:"Chatroom name...",value:h,onChange:s=>w(s.target.value),onKeyDown:s=>{s.key==="Enter"?S(h):s.key==="Escape"&&(y(!1),w(""))},autoFocus:!0}),e(u,{size:"sm",onClick:()=>S(h),disabled:m,className:"bg-emerald-600 hover:bg-emerald-700 text-white hover:cursor-pointer",children:"Create"}),e(u,{size:"sm",variant:"ghost",onClick:()=>{y(!1),w("")},className:"hover:cursor-pointer",children:"Cancel"})]}):t(u,{size:"sm",onClick:()=>y(!0),disabled:m,className:"bg-emerald-600 hover:bg-emerald-700 text-white hover:cursor-pointer",children:[e(oe,{className:"h-4 w-4 mr-2"})," New Chat"]})]}),r.chatrooms&&r.chatrooms.length>0?e("div",{className:"space-y-3",children:r.chatrooms.map(s=>e(z,{className:q("cursor-pointer transition-all border-l-4 border-l-transparent","hover:shadow-md hover:border-l-emerald-500 hover:bg-muted/30"),onClick:()=>{o(s),T({to:"/chat"})},children:e(O,{className:"py-3",children:t("div",{className:"flex items-center justify-between",children:[t(A,{className:"text-base flex items-center",children:[e(Ae,{className:"h-4 w-4 mr-2"}),s.name,s.isPrivate&&e(J,{children:t(K,{children:[e(X,{asChild:!0,children:e("span",{children:e(V,{className:"h-3 w-3 ml-2 text-red-500"})})}),e(Q,{children:e("p",{children:"Private"})})]})})]}),e("div",{className:"flex items-center gap-3 text-muted-foreground text-xs",children:t("div",{className:"flex items-center",children:[e(de,{className:"h-3 w-3 mr-1"}),s.members?.length||1]})})]})})},s.id))}):t("div",{className:"border rounded-lg p-8 text-center bg-muted/20",children:[e("h3",{className:"font-medium mb-2",children:"No chats yet"}),e("p",{className:"text-muted-foreground mb-4",children:"Start by creating your first chat in this project"}),t(u,{variant:"outline",onClick:()=>y(!0),className:"border-emerald-600/20 text-emerald-700 hover:bg-emerald-50",children:[e(oe,{className:"h-4 w-4 mr-2"})," Create Chat"]})]})]})]}),t("div",{className:"space-y-6",children:[t(z,{className:"border-t-4 border-t-emerald-500",children:[t(O,{children:[t(A,{className:"flex items-center justify-between",children:[e("span",{children:"Project Context"}),e(u,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0 hover:cursor-pointer",onClick:()=>P(!j),children:e(ye,{className:"h-4 w-4"})})]}),e(H,{children:"Information about this project's purpose"})]}),e(E,{children:j?t("div",{className:"space-y-4",children:[e("textarea",{className:"w-full min-h-[150px] p-3 border rounded-md",placeholder:"Describe what this teamspace is used for...",value:r.context}),t("div",{className:"flex justify-end space-x-2",children:[e(u,{variant:"outline",size:"sm",onClick:()=>P(!1),children:"Cancel"}),e(u,{size:"sm",onClick:()=>P(!1),children:"Save"})]})]}):e("div",{className:"text-sm",children:e("p",{children:r.context})})})]}),t(z,{className:"border-t-4 border-t-emerald-500",children:[t(O,{children:[e(A,{children:"Members"}),e(H,{children:"People with access to this project"})]}),e(E,{children:r.members&&r.members.length>0?e(Ze,{members:r.members}):e("div",{className:"text-sm text-muted-foreground",children:"Only you have access to this project"})}),e(Ue,{children:e(Re,{type:"project",projectId:r.id,teamspaceId:r.teamspaceId,members:r.members||[],userId:i,onMembersChanged:()=>{R().chatrooms.getTeamspaces().then(({data:s})=>{s&&k(s)})},children:t(u,{size:"sm",variant:"outline",className:"w-full border-emerald-600/20 text-emerald-700 hover:bg-emerald-50 hover:cursor-pointer",children:[e(de,{className:"h-4 w-4 mr-2"})," Manage Members"]})})})]}),t(z,{className:"border-t-4 border-t-emerald-500",children:[e(O,{children:e(A,{children:"Project Stats"})}),e(E,{children:t("div",{className:"space-y-2",children:[t("div",{className:"flex justify-between",children:[e("span",{className:"text-muted-foreground",children:"Chats"}),e("span",{className:"font-medium",children:r.chatrooms?.length||0})]}),t("div",{className:"flex justify-between",children:[e("span",{className:"text-muted-foreground",children:"Members"}),e("span",{className:"font-medium",children:r.members?.length||1})]}),t("div",{className:"flex justify-between",children:[e("span",{className:"text-muted-foreground",children:"Files"}),e("span",{className:"font-medium",children:r.files?.length||0})]}),t("div",{className:"flex justify-between",children:[e("span",{className:"text-muted-foreground",children:"Created"}),e("span",{className:"font-medium",children:new Date(r.createdAt).toLocaleDateString()})]}),r.isPrivate&&t("div",{className:"flex justify-between items-center pt-2 mt-2 border-t",children:[t("span",{className:"text-muted-foreground flex items-center",children:[e(V,{className:"h-3.5 w-3.5 mr-1.5 text-red-500"}),"Visibility"]}),e("span",{className:"font-medium text-sm bg-gray-100 px-2 py-0.5 rounded",children:"Private"})]})]})})]}),t(z,{className:"border-t-4 border-t-emerald-500",children:[t(O,{className:"pb-2",children:[t(A,{className:"flex items-center justify-between",children:[e("span",{children:"Project Files"}),e(xe,{teamspaceId:d?.id,projectId:r.id,organizationId:n.session?.activeOrganizationId||void 0,compact:!0,files:r.files||[],className:"ml-auto"})]}),e(H,{children:"Upload and manage files for this project"})]}),e(E,{children:r.files&&r.files.length>0?e("div",{className:"space-y-2 max-h-64 overflow-y-auto pr-1",children:r.files.map((s,f)=>t("div",{className:"flex items-center p-2 border rounded bg-white hover:bg-gray-50 transition-colors",children:[e("div",{className:"w-8 h-8 mr-2 bg-gray-100 flex items-center justify-center rounded",children:e(W,{className:"h-4 w-4 text-gray-500"})}),t("div",{className:"flex-1 truncate",children:[e("p",{className:"font-medium text-sm truncate",children:s.fileName||`File ${f+1}`}),e("p",{className:"text-xs text-muted-foreground",children:new Date(s.createdAt).toLocaleDateString()})]})]},f))}):t("div",{className:"text-center py-6 bg-muted/20 rounded-lg border border-dashed",children:[e(W,{className:"h-8 w-8 mx-auto text-muted-foreground mb-2"}),e("p",{className:"text-sm text-muted-foreground mb-3",children:"No files uploaded yet"}),e(xe,{projectId:r.id,organizationId:n.session?.activeOrganizationId||void 0,compact:!0})]})})]})]})]})]})]})};export{_t as component};
