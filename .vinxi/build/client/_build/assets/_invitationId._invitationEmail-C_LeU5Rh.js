import{ak as j,aK as f,r as d,u as v,j as e,C as p,a as N,b as w,c as y,d as C,w as b,X as u,h as k,B as a,k as r,aL as m,aM as z}from"./client-CMvCw2jp.js";import{u as S}from"./useSignOut-o9qTHLdH.js";const T=function(){const{data:o}=j(),{invitationId:c,invitationEmail:i}=f.useParams(),[t,s]=d.useState("initial"),n=v(),x=S(),h=t==="loading"?"Processing your invitation...":t==="success"?"Your invitation has been accepted!":t==="error"?"There was a problem with your invitation":"";d.useEffect(()=>{if(!i||!c){n({to:"/sign-in",reloadDocument:!0});return}},[]);const g=async()=>{if(s("loading"),!o?.user.id){localStorage.setItem("invitationEmail",i),r.error("You have to sign in before we can make you join an organization"),s("must-signin");return}if(o.user.email!==i){r.error(`You must sign in using the email: ${i}`),localStorage.setItem("invitationEmail",i),s("must-change-account");return}const{data:l}=await m.acceptInvitation({invitationId:c});l?.invitation?(r.info("You have joined the organization"),s("success"),await m.setActive({organizationId:l?.member.organizationId}),await z({query:{disableCookieCache:!0}}),setTimeout(()=>n({to:"/chat"}),1e3)):s("error")};return e.jsx("div",{className:"flex min-h-screen items-center justify-center bg-muted/40 p-4",children:e.jsxs(p,{className:"mx-auto max-w-md w-full",children:[e.jsxs(N,{className:"text-center",children:[e.jsx(w,{className:"text-xl",children:"Organization Invitation"}),e.jsx(y,{className:`${t==="error"?" text-destructive":""}`,children:h})]}),e.jsx(C,{className:"flex justify-center",children:t==="initial"?e.jsx("div",{children:e.jsx("p",{className:"font-medium",children:"You have been invited to join an organization"})}):t==="loading"?e.jsxs("div",{className:"flex flex-col items-center gap-4",children:[e.jsx("div",{className:"h-12 w-12 rounded-full border-4 border-primary/30 border-t-primary animate-spin"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Please wait while we process your invitation"})]}):t==="success"?e.jsxs("div",{className:"flex flex-col items-center gap-4 text-center",children:[e.jsx("div",{className:"h-12 w-12 rounded-full bg-green-100 flex items-center justify-center",children:e.jsx(b,{className:"h-6 w-6 text-green-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:"You have successfully joined the organization"}),e.jsx("p",{className:"mt-1 text-sm text-muted-foreground",children:"You now have access to all resources shared with you"})]})]}):t==="error"?e.jsxs("div",{className:"flex flex-col items-center gap-4 text-center",children:[e.jsx("div",{className:"h-12 w-12 rounded-full bg-red-100 flex items-center justify-center",children:e.jsx(u,{className:"h-6 w-6 text-red-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:"This invitation is invalid or has expired"}),e.jsx("p",{className:"mt-1 text-sm text-muted-foreground",children:"Please contact your organization admin for a new invitation"})]})]}):e.jsxs("div",{className:"flex flex-col items-center gap-4 text-center",children:[e.jsx("div",{className:"h-12 w-12 rounded-full bg-red-100 flex items-center justify-center",children:e.jsx(u,{className:"h-6 w-6 text-red-600"})}),e.jsx("div",{children:e.jsx("p",{className:"font-medium",children:"This invitation could not be accepted you have to sign in or switch your account"})})]})}),e.jsx(k,{className:"flex justify-center",children:t==="initial"?e.jsx(a,{onClick:()=>g(),children:"Accept invitation"}):t==="error"?e.jsx(a,{onClick:()=>n({to:"/sign-up"}),children:"Return to Home"}):t==="must-signin"?e.jsx(a,{onClick:()=>n({to:"/sign-in"}),children:"sign me in"}):t==="must-change-account"?e.jsx(a,{onClick:()=>x(),children:"switch account"}):e.jsx(e.Fragment,{})})]})})};export{T as component};
